<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NLP on DDubi's World</title><link>https://juijeong8324.github.io/categories/nlp/</link><description>Recent content in NLP on DDubi's World</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 06 Jul 2025 19:14:00 +0900</lastBuildDate><atom:link href="https://juijeong8324.github.io/categories/nlp/index.xml" rel="self" type="application/rss+xml"/><item><title>Pretraining</title><link>https://juijeong8324.github.io/p/nlp/pretraining/</link><pubDate>Sun, 06 Jul 2025 19:14:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/pretraining/</guid><description>&lt;h3 id="1-subword-modeling-ê°„ë‹¨í•˜ê²Œ-ì•Œì•„ë³´ê¸°"&gt;1. Subword modeling ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ê¸°Â 
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@bO6314/btsO5L1bTW2/AAAAAAAAAAAAAAAAAAAAAGRPfPUE5tQq1W_Qa92a8ZA-rJdGPLmE4vFSLj_KMfxw/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=xr0cD%2FJl2O0ronELf5POn%2FTFJqs%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:1046,&amp;ldquo;originHeight&amp;rdquo;:319,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ë¨¼ì €, ìš°ë¦¬ì˜ languageì˜ vocabularyë¥¼ ë§Œë“¤ ë•Œ ë‹¤ìŒê³¼ ê°€ì •ì„ í•œë‹¤ê³  í•˜ì.Â &lt;/p&gt;
&lt;p&gt;training setìœ¼ë¡œ ë¶€í„° ë§Œë“¤ì–´ì§„, ìˆ˜ ì²œê°œì˜ wordsë¡œ ì´ë£¨ì–´ì§„ fixed vocabê°€ ìˆê³ ,&lt;/p&gt;
&lt;p&gt;test timeì— ì²˜ìŒ ë³¸ ëª¨ë“  wordë“¤ì— ëŒ€í•´ì„œ single UNKë¡œ mapping í•œë‹¤ê³  ê°€ì •í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;ì´ ìƒí™©ì—ì„œ, subwordì˜ modelingì€ word levelë³´ë‹¤ ë” ì‘ì€ structure (Parts of words, characters, bytes) ë¥¼ ê³ ë ¤í•˜ëŠ” ë‹¤ì–‘í•œ method ë°©ë²•ë“¤ì„ í¬í•¨í•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;í˜„ëŒ€ NLPì—ì„œëŠ” subword tokensìœ¼ë¡œ êµ¬ì„±ëœ vocabularyë¥¼ í•™ìŠµí•˜ëŠ” ë°©ì‹ì´ ì§€ë°°ì ì´ë‹¤.Â &lt;/p&gt;
&lt;p&gt;trainingê³¼ testing ì‹œ ê° wordëŠ” vocabularyì— ì•Œë ¤ì§„ subwordë“¤ì˜ sequenceë¡œ ë¶„í• ëœë‹¤.Â &lt;/p&gt;
&lt;h4 id="the-byte-pair-encodingbpe-algorithm"&gt;The byte-pair encoding(BPE) algorithmÂ 
&lt;/h4&gt;&lt;p&gt;ì´ë•Œ, BPEëŠ” subword vocabularyë¥¼ ì •ì˜í•˜ê¸° ìœ„í•œ effective strategy ë¼ê³  í•  ìˆ˜ ìˆë‹¤!!Â &lt;/p&gt;
&lt;p&gt;1. init vocabulary : ëª¨ë“  ë¬¸ìë¥¼ ê° characterë“¤ê³¼ ë‹¨ì–´ ë(end-of-word) symoblë§Œ í¬í•¨&lt;/p&gt;
&lt;p&gt;2. textì˜ corpusë¥¼ ë³´ë©´ì„œ ê°€ì¥ ìì£¼ í•¨ê»˜ ë“±ì¥í•˜ëŠ” character ìŒ &amp;ldquo;a, b&amp;quot;ë¥¼ ì°¾ì•„ì„œ &amp;ldquo;ab&amp;quot;ë¥¼ subwordë¡œ ì¶”ê°€Â &lt;/p&gt;
&lt;p&gt;3. í•´ë‹¹ charcter pairë¥¼ new subwordë¡œ replace, ì´ë•Œ vocab sizeë¡œ ë„ë‹¬í•  ë•Œê¹Œì§€ ë°˜ë³µ!!!Â &lt;/p&gt;
&lt;p&gt;ê·¼ë° ì´ ë°©ì‹ì€.. ì´ˆê¸° machine translationê³¼ ê°™ì€ NLPì—ë§Œ ì‚¬ìš©ë˜ì—ˆìŒ!!Â &lt;/p&gt;
&lt;p&gt;í˜„ì¬ëŠ” WordPiece(í™•ë¥  based) ì™€ ê°™ì€ methodê°€ pretrained modelì—ì„œ ì‚¬ìš©ë˜ê³  ìˆìŒ!!1Â &lt;/p&gt;
&lt;p&gt;- WordPiece?? byte coding ìì„¸í•œ ê±´&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bgcmpl/btsO6rA7437/AAAAAAAAAAAAAAAAAAAAAN1b4Om0TbnQVPR2anMt7BwNRYiZ1lLCWBr69jOQT1YB/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=zlcbvOh1sPsfw%2FXHI3cJtTFwdCU%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:738,&amp;ldquo;originHeight&amp;rdquo;:223,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ëŒ€ë¶€ë¶„ì˜ wordë“¤ì€ subword vocabularyì˜ ì¼ë¶€ì— í¬í•¨ë˜ê² ì§€ë§Œ,, ë“œë¬¸ wordë“¤ì€ componentë¡œ ë¶„ë¦¬ëœë‹¤&amp;hellip;&lt;/p&gt;
&lt;p&gt;ì•„ì£¼ ì•ˆ ì¢‹ì€ ê²½ìš°ì—ëŠ” wordê°€ ì•„ì£¼ ë§ì€ subwordsë¡œ ë¶„ë¦¬ë  ìˆ˜ë„ ìˆë‹¤ëŠ” ì‚¬ì‹¤&amp;hellip;Â &lt;/p&gt;
&lt;h3 id="2-motivating-model-pretraining-from-word-embeddings"&gt;2. Motivating model pretraining from word embeddings
&lt;/h3&gt;&lt;p&gt;ê·¸ë˜ì„œ..!Â &lt;/p&gt;
&lt;h3 id="4-model-pretraining-three-ways"&gt;4. Model pretraining three ways
&lt;/h3&gt;&lt;p&gt;4-1. Decoders&lt;/p&gt;
&lt;p&gt;4-2. Encoders&lt;/p&gt;
&lt;p&gt;4-3. Encoder-Decoders&lt;/p&gt;
&lt;h3 id="5-interlude-what-do-we-think-pretraining-is-teaching"&gt;5. Interlude: what do we think pretraining is teaching?
&lt;/h3&gt;&lt;h3 id="6-very-large-models-and-in-context-learning"&gt;6. Very Large models and in-context learning
&lt;/h3&gt;</description></item><item><title>Transformer - Encoder</title><link>https://juijeong8324.github.io/p/nlp/transformer-encoder/</link><pubDate>Sun, 22 Jun 2025 15:45:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/transformer-encoder/</guid><description>&lt;p&gt;[##&lt;em&gt;Image|kage@ts3IR/btsOMTqkBt1/AAAAAAAAAAAAAAAAAAAAAO5eCa8c7NYTnezb7sEzqKBacKSPresrBDlEMbGfNoLD/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=W679xjbXXwiqbkktqAK99VZUDmE%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:602,&amp;ldquo;originHeight&amp;rdquo;:667,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:425,&amp;ldquo;height&amp;rdquo;:471}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;Transformer DecoderëŠ” **language modelì²˜ëŸ¼ ë‹¨ë°©í–¥(unidirectional) contextë§Œì„ ì‚¬ìš©í•˜ë„ë¡ contraint(ì œí•œ)**í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;-&amp;gt; ì¦‰ ê³¼ê±°(ì™¼ìª½) ì •ë³´ë§Œ ë³´ê³  ë¯¸ë˜(ì˜¤ë¥¸ìª½)ëŠ” ë³´ì§€ ì•ŠëŠ”ë‹¤.Â &lt;/p&gt;
&lt;p&gt;-&amp;gt; ì´ëŠ” Langue modelì²˜ëŸ¼ ë‹¤ìŒì— ì˜¬ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” task&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë©´ ìš°ë¦¬ëŠ” &lt;strong&gt;bidirectional contextë¥¼ ì›í•˜ë©´ ì–‘ë°©í–¥ RNNì²˜ëŸ¼ í•˜ë©´ ë ê¹Œ?&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;ê·¸ëŸ´ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´!!!!! &lt;strong&gt;Transformer Encoder&lt;/strong&gt;ì´ë‹¤!&lt;/p&gt;
&lt;p&gt;-&amp;gt; ì´ëŠ” ë¬¸ì¥ ì´í•´, ë¶„ë¥˜ì— ì í•©í•œ taskÂ &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Decoderì™€ì˜ ìœ ì¼í•œ ì°¨ì´ì ì€ self-attentionì—ì„œ maskingì„ ì œê±°í•œë‹¤ëŠ” ê²ƒ..! (ì¦‰, ëª¨ë“  ë‹¨ì–´ë¥¼ ë™ì‹œì— ë³¸ë‹¤!)&lt;/strong&gt;Â &lt;/p&gt;
&lt;h3 id="the-transformer-encoder-decoder"&gt;&lt;strong&gt;The transformer Encoder-Decoder&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@EsUBF/btsOMe2P77d/AAAAAAAAAAAAAAAAAAAAAMMZMPLAgERAICX1MeRLDaUvqrufJ3FCTwJ4Acj8HCpg/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=lSVxZmTQSeho1FJ6UDsGGzTTBM0%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:648,&amp;ldquo;originHeight&amp;rdquo;:694,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:381,&amp;ldquo;height&amp;rdquo;:408}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;Machine translationì„ íšŒê¸°í•˜ë©´,,Â &lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ëŠ” bidirectional modelì—ì„œ source sentenceë¥¼ ì²˜ë¦¬í–ˆê³ , unidirectional modelì—ì„œ targetì„ ìƒì„±í–ˆë‹¤!Â Â &lt;/p&gt;
&lt;p&gt;seq2seq formatì˜ ì‘ì—…ì—ì„œëŠ”&amp;hellip; ì´ë ‡ê²Œ Transformer Encoder-Decoder êµ¬ì¡°ë¥¼ ì‚¬ìš©í•œë‹¤!!!!!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Encoder&lt;/strong&gt;&lt;br&gt;
ì¼ë°˜ì ì¸ Transformer Encoderë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Decoder&lt;/strong&gt;&lt;br&gt;
Encoderì˜ ì¶œë ¥ì— ëŒ€í•´ &lt;strong&gt;cross-attention&lt;/strong&gt;ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ì •ëœë‹¤. DecoderëŠ” &lt;strong&gt;self-attention&lt;/strong&gt;ìœ¼ë¡œ ìê¸° ìì‹ ë§Œ ë³´ëŠ”ê²Œ ì•„ë‹ˆë¼, Encoderê°€ ë§Œë“  input ë¬¸ì¥ì˜ contextë¥¼ ì°¸ê³ í•´ì„œ ë²ˆì—­ì„ ìƒì„±Â &lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="cross-attention-details"&gt;&lt;strong&gt;Cross-attention (details)&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@c0gxt1/btsOMku0Kfk/AAAAAAAAAAAAAAAAAAAAABG7eNvJgk9_dlDwwjsrY0PNbkeQG-hXvdGsIMMsGfdq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=Wz7T1TPA5m%2BSrkRUCGrk21%2FpPg4%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:597,&amp;ldquo;originHeight&amp;rdquo;:482,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:382,&amp;ldquo;height&amp;rdquo;:308}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;self-attentionì€ ê°™ì€ sourceì—ì„œ keys, queries, valuesê°€ ë§Œë“¤ì–´ì§ˆ ë•Œë¥¼ ë§í•œë‹¤.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ì¦‰, Encoder ë‚´ë¶€, Decoder ë‚´ë¶€&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;Decoderì—ì„œëŠ” self-attentionë„ ìˆì§€ë§Œ, ë‹¤ë¥¸ sourceë¥¼ ë°”ë¼ë³´ëŠ” attentionë„ ìˆë‹¤!(ì €ë²ˆ ì‹œê°„ì— ë°°ì›€) ê·¸ê²Œ ë°”ë¡œ &lt;strong&gt;cross-attention&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;h1, &amp;hellip; , hn&lt;/strong&gt;: Transformer &lt;strong&gt;encoder&lt;/strong&gt; ë¡œ ë¶€í„° ì–»ì€ &lt;strong&gt;output vector(hidden state)&lt;/strong&gt;Â ğ‘¥ğ‘–âˆˆâ„ğ‘‘&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;z1, &amp;hellip; , zn&lt;/strong&gt;: Transformer &lt;strong&gt;decoder&lt;/strong&gt;ë¡œ ë¶€í„° ì–»ì€ &lt;strong&gt;input vector(ì¦‰, ì´ë¯¸ ìƒì„±ëœ ë‹¨ì–´ë“¤ì˜ hidden state)&lt;/strong&gt;Â ğ‘§ğ‘–âˆˆâ„ğ‘‘&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì—¬ê¸°ì„œ keysì™€ valuesëŠ” encoderì˜ ì¶œë ¥ hiì—ì„œ ê³„ì‚°&lt;/p&gt;
&lt;p&gt;ì¦‰ EncoderëŠ” ì¼ì¢…ì˜ memory ê°™ì€ ëŠë‚ŒÂ &lt;/p&gt;
&lt;p&gt;ğ‘˜ğ‘–=ğ¾â„ğ‘–,Â ğ‘£ğ‘–=ğ‘‰â„ğ‘–&lt;/p&gt;
&lt;p&gt;queriesëŠ” decoderë¡œ í˜„ì¬ ì…ë ¥ ziì—ì„œ ê°€ì ¸ì˜¨ ê²ƒÂ &lt;/p&gt;
&lt;p&gt;ğ‘ğ‘–=ğ‘„ğ‘§ğ‘–.&lt;/p&gt;
&lt;p&gt;ê·¸ë‹ˆê¹Œ ì •ë¦¬í•˜ìë©´&amp;hellip; queryëŠ” decoderì˜ input ìš°ë¦¬ê°€ ì§‘ì¤‘í•´ì„œ ë³´ê³  ì‹¶ì€ ê²ƒë“¤ì€ encoderì˜ inputì´ê³ , keyì™€ valueì— í•´ë‹¹Â &lt;/p&gt;
&lt;p&gt;ì¦‰ Decoderê°€ Encoderì˜ ì¶œë ¥ì— ëŒ€í•´ attention ì„ ë‚ ë¦¬ëŠ” ê²ƒ! &lt;strong&gt;ì°¸ì¡°í•˜ë©° ë¬¸ì¥ì„ ìƒì„±í•  ìˆ˜ ìˆê²Œ!!&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id="cross-attentionì´-ê³„ì‚°ë˜ëŠ”-ê³¼ì •"&gt;Cross-attentionì´ ê³„ì‚°ë˜ëŠ” ê³¼ì •Â 
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@leV61/btsOLl2zPW4/AAAAAAAAAAAAAAAAAAAAAIA7cXyO2OQFSby4v8-pcRp2XmxzWFnaRyUMSH9ihgPv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=V2xFp9KXOuxlWZ8yLjJQZxeZ4EI%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:309,&amp;ldquo;originHeight&amp;rdquo;:88,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;HëŠ” encoder vectorì˜ concatenaton!Â &lt;/p&gt;
&lt;p&gt;ZëŠ” dcoder vectorì˜ concatenation!&lt;/p&gt;
&lt;p&gt;ì—¬ê¸°ì„œ TëŠ” encoderì˜ ê¸¸ì´ ë˜ëŠ” decoderì˜ ê¸¸ì´ ì¤‘ í•˜ë‚˜ì¼ ìˆ˜ ìˆëŠ”ë°, &lt;strong&gt;ë¬¸ë§¥ìƒ ë‘˜ ë‹¤ Të¡œ í‘œê¸°í•œ ê±°ì§€ ì‹¤ì œë¡œëŠ” ë‹¤ë¥¼ ìˆ˜ ìˆì–´.&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ì˜ˆë¥¼ ë“¤ì–´: ì˜ì–´ ì…ë ¥(5ë‹¨ì–´) â†’ í”„ë‘ìŠ¤ì–´ ì¶œë ¥(7ë‹¨ì–´)ì´ë¼ë©´
&lt;ul&gt;
&lt;li&gt;Encoder: Tâ‚ = 5, Decoder: Tâ‚‚ = 7&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@cgCHrb/btsOMFyVJLj/AAAAAAAAAAAAAAAAAAAAAAfCTekS-Os5iVz3UuE7abPQNnIuvyBsZc7hVMY0M0_8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=YXRMdc7KiYsDXz9NJeiVHIeoqbY%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:470,&amp;ldquo;originHeight&amp;rdquo;:43,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;decoder vectorì— Queryë¥¼ ê³±í•˜ê³ Â &lt;/p&gt;
&lt;p&gt;encoder vectorì— Keyë¥¼ ê³±í•œ í›„Â &lt;/p&gt;
&lt;p&gt;ê·¸ ë‘˜ì„ ê³„ì‚°í•˜ì—¬ Attention scoreë¥¼ ê³„ì‚° ì´ë¥¼ softmaxë¡œ í†µê³¼í•˜ì—¬ attention distribution ì¦‰, ê°€ì¤‘ì¹˜ë¥¼ ë§Œë“¤ì–´ ë‚´ê³ Â &lt;/p&gt;
&lt;p&gt;ì´ë¥¼ encoder vectorì˜ valueë“¤ì— ê³±í•œë‹¤!!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bWv0Qu/btsOMcjF5EO/AAAAAAAAAAAAAAAAAAAAAAhMLglNh1dZVXt4HF_o3G49dac-4pEB-YMPtuY9VRzM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=zYlrTVAYTUG9f8kFM%2FnQL5qPDZw%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:717,&amp;ldquo;originHeight&amp;rdquo;:373,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:655,&amp;ldquo;height&amp;rdquo;:341}&lt;/em&gt;##]&lt;/p&gt;
&lt;h3 id="ì„±ëŠ¥ì„-ë´…ì‹œë‹¤"&gt;ì„±ëŠ¥ì„ ë´…ì‹œë‹¤.Â 
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Machine Translation&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@dppGcu/btsOM4d8Xmw/AAAAAAAAAAAAAAAAAAAAACowHO3mblz7Wo1-iI1Hmsj7koe4pZuJDAQPs4JihY85/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=q2ltKQI0%2BhF8IirfD2IfJfixqIg%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:904,&amp;ldquo;originHeight&amp;rdquo;:324,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;document generation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@cH560F/btsOLFmjPYx/AAAAAAAAAAAAAAAAAAAAAOP0FZ61m9K6cZ_N3KXJbor5XqMzgrXt2snrP6Ye7Nwv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=j8JxrmMrQuHJFhW3LlvSN80Bt5U%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:1068,&amp;ldquo;originHeight&amp;rdquo;:399,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;TransformerëŠ” ë³‘ë ¬ì²˜ë¦¬ê°€ ì˜ ë˜ê¸° ë•Œë¬¸ì— pre-trainingìœ¼ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê³ , ì‚¬ì‹¤ìƒ NLPì˜ í‘œì¤€ì´ ë˜ì—ˆë‹¤.Â &lt;/p&gt;
&lt;h3 id="transformerì˜-í•œê³„"&gt;Transformerì˜ í•œê³„Â 
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;1. Training instabilities (Pre vs Post norm)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;trainingì´ ë¶ˆì•ˆì •í•¨! íŠ¹íˆ LayerNormì„ ì–´ë””ì— ë„£ëŠëƒì— ë”°ë¼ í•™ìŠµ ì•ˆì •ì„±ì´ ë‹¬ë¼ì§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Pre-norm&lt;/strong&gt;: LayerNormì„ &lt;strong&gt;Residual ì „ì—&lt;/strong&gt; ì ìš© (ìš”ì¦˜ ì´ ë°©ì‹ì´ ë” ì•ˆì •ì ì„)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Post-norm&lt;/strong&gt;: Residual &lt;strong&gt;í›„ì—&lt;/strong&gt; ì ìš© (ì´ˆê¸° Transformer ë…¼ë¬¸ ë°©ì‹)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@wZUBY/btsOMjJFANk/AAAAAAAAAAAAAAAAAAAAACaRrxSwZ-2TCwVSz2LENOjyyg5tRODrIAzZ62b7-54O/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=rZUnNPBpCdLtNZdbLYrXb%2BJjxOY%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:986,&amp;ldquo;originHeight&amp;rdquo;:543,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:566,&amp;ldquo;height&amp;rdquo;:312}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. Quadratic comput in self-attention&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;self-attention ì€ ê³„ì‚°ëŸ‰ì´ sequence ê¸¸ì´ì˜ ì œê³±ì— ë¹„ë¡€í•¨Â &lt;/p&gt;
&lt;p&gt;ì™œëƒí•˜ë©´&lt;/p&gt;
&lt;p&gt;ëª¨ë“  tokenìŒë§ˆë‹¤ attentionì„ ê¼ì‚°í•˜ê¸° ë•Œë¬¸ì— O(n^2) ì„&lt;/p&gt;
&lt;p&gt;ê·¼ë° ì™œ ì¨??? Transformerê°€ ì»¤ì§ˆ ìˆ˜ë¡ ì „ì²´ ê³„ì‚°ì—ì„œ self-attentionì´ ì°¨ì§€í•˜ëŠ” ë¹„ì¤‘ì´ ì ì  ì¤„ì–´ë“ ë‹¤. ì¦‰ self-attention ê³„ì‚°ì€ ì—¬ì „íˆ ëŠë¦¬ì§€ë§Œ, ì „ì²´ ëª¨ë¸ ê³„ì‚° ì¤‘ ì¼ë¶€ì¼ ë¿Â &lt;/p&gt;
&lt;p&gt;- ê²Œì‚°ì„ ì¤„ì´ë ¤ê³  ë§Œë“  &lt;strong&gt;ì €ë ´í•œ(íš¨ìœ¨ì ì¸) Self-Attention ë°©ë²•ë“¤&lt;/strong&gt;ì€&lt;/p&gt;
&lt;p&gt;â†’ &lt;strong&gt;ëª¨ë¸ì´ ì»¤ì§ˆìˆ˜ë¡ ì„±ëŠ¥ì´ ë³„ë¡œ ì•ˆ ì¢‹ìŒ.&lt;/strong&gt;&lt;br&gt;
â†’ ê·¸ë˜ì„œ ì‹¤ì œ ëŒ€í˜• ëª¨ë¸ì—ëŠ” ì˜ ì•ˆ ì“°ì¸ë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;- Systems optimizations work well (FlashAttention â€“ Jun 2022)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;â†’ ê·¸ë˜ì„œ &lt;strong&gt;ì•Œê³ ë¦¬ì¦˜ì„ ë°”ê¾¸ëŠ” ëŒ€ì‹ &lt;/strong&gt;,&lt;br&gt;
â†’ &lt;strong&gt;ê¸°ì¡´ Attentionì„ ë” ë¹ ë¥´ê²Œ êµ¬í˜„í•œ ìµœì í™” ê¸°ìˆ &lt;/strong&gt;ì´ ë§ì´ ì“°ì„.&lt;/p&gt;
&lt;h3 id="ì ì‹œë§Œ-encoder-decoder-êµ¬ì¡°ì—ì„œ-decoderì˜-ì…ë ¥ì´-encoderì˜-outputì´-ì•„ë‹ˆì—ˆì–´"&gt;ì .ì‹œ.ë§Œ Encoder-Decoder êµ¬ì¡°ì—ì„œ Decoderì˜ ì…ë ¥ì´ Encoderì˜ outputì´ ì•„ë‹ˆì—ˆì–´???
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;Transformerì˜ DecoderëŠ” Encoderì˜ ì¶œë ¥ì„ &amp;ldquo;ì§ì ‘ ì…ë ¥ìœ¼ë¡œ ë°›ëŠ” ê²Œ ì•„ë‹ˆë¼&amp;rdquo;, Cross-Attentionì„ í†µí•´ &amp;ldquo;ì°¸ì¡°&amp;quot;ë§Œ í•´.&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ì¦‰:&lt;br&gt;
&lt;strong&gt;Decoderì˜ ì…ë ¥ì€ &amp;ldquo;ìƒì„± ì¤‘ì¸ ë¬¸ì¥&amp;quot;ì´ê³ &lt;/strong&gt;,&lt;br&gt;
&lt;strong&gt;Encoderì˜ ì¶œë ¥ì€ &amp;ldquo;ì°¸ì¡° ëŒ€ìƒ&amp;quot;ì¼ ë¿ì´ì•¼.&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="-ì •ë¦¬í•´ë³´ì"&gt;ğŸ” ì •ë¦¬í•´ë³´ì:
&lt;/h2&gt;&lt;h3 id="transformer-encoder-decoder-êµ¬ì¡°ì—ì„œì˜-ì—­í• "&gt;Transformer Encoder-Decoder êµ¬ì¡°ì—ì„œì˜ ì—­í• 
&lt;/h3&gt;&lt;p&gt;ì»´í¬ë„ŒíŠ¸ì…ë ¥ì²˜ë¦¬ì¶œë ¥&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Encoder&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ì „ì²´ source ë¬¸ì¥ (ex: ì˜ì–´)&lt;/th&gt;
&lt;th&gt;Full self-attention&lt;/th&gt;
&lt;th&gt;ë¬¸ì¥ ì „ì²´ì˜ ì˜ë¯¸ ë²¡í„°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Decoder&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ì§€ê¸ˆê¹Œì§€ ìƒì„±ëœ target ë¬¸ì¥ (ex: ë¶ˆì–´ ì¼ë¶€)&lt;/td&gt;
&lt;td&gt;Masked self-attention + Cross-attention&lt;/td&gt;
&lt;td&gt;ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id="-ì¤‘ìš”í•œ-êµ¬ë¶„"&gt;ğŸ“Œ ì¤‘ìš”í•œ êµ¬ë¶„
&lt;/h2&gt;&lt;h3 id="-decoderì˜-ì…ë ¥ì´-encoder-ì¶œë ¥ì´ë¼ëŠ”-ì˜¤í•´"&gt;âŒ Decoderì˜ ì…ë ¥ì´ &amp;ldquo;Encoder ì¶œë ¥&amp;quot;ì´ë¼ëŠ” ì˜¤í•´
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;âŒ DecoderëŠ” Encoderì˜ ì¶œë ¥ ë²¡í„°ë“¤ì„ inputìœ¼ë¡œ &amp;ldquo;ë„£ëŠ”&amp;rdquo; ê²Œ ì•„ë‹˜&lt;/li&gt;
&lt;li&gt;âŒ DecoderëŠ” Encoderì˜ ì¶œë ¥ì„ ë¬¸ì¥ì²˜ëŸ¼ &amp;ldquo;feeding&amp;quot;í•˜ì§€ ì•ŠìŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="-ì‹¤ì œ-êµ¬ì¡°ëŠ”-ì´ë ‡ê²Œ-ìƒê²¼ì–´"&gt;âœ… ì‹¤ì œ êµ¬ì¡°ëŠ” ì´ë ‡ê²Œ ìƒê²¼ì–´:
&lt;/h3&gt;&lt;h4 id="decoder-ë‚´ë¶€ì—ëŠ”-ë‘-ê°œì˜-attention-layerê°€-ìˆìŒ"&gt;Decoder ë‚´ë¶€ì—ëŠ” &lt;strong&gt;ë‘ ê°œì˜ Attention Layer&lt;/strong&gt;ê°€ ìˆìŒ:
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Masked Self-Attention&lt;/strong&gt;&lt;br&gt;
â†’ ì§€ê¸ˆê¹Œì§€ ìƒì„±í•œ ë‹¨ì–´ë“¤ë¼ë¦¬ë§Œ ì°¸ê³ &lt;br&gt;
â†’ ë¯¸ë˜ ë‹¨ì–´ëŠ” ê°€ë ¤ì ¸ ìˆìŒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cross-Attention&lt;/strong&gt;&lt;br&gt;
â†’ Encoderì˜ ì¶œë ¥ ì „ì²´ë¥¼ ì³ë‹¤ë³´ë©´ì„œ í•„ìš”í•œ ì •ë³´ ì°¸ì¡°&lt;br&gt;
â†’ ì¦‰, &lt;strong&gt;Decoderì˜ Queryê°€ Encoderì˜ Key/Valueë¥¼ &amp;ldquo;attend&amp;quot;í•˜ëŠ” êµ¬ì¡°&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id="-ë‹¤ì‹œ-ë§í•´-ìš”ì•½í•˜ë©´"&gt;ğŸ¯ ë‹¤ì‹œ ë§í•´ ìš”ì•½í•˜ë©´
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;DecoderëŠ” Encoderì˜ ì¶œë ¥ì„ inputì²˜ëŸ¼ ë°›ëŠ” ê²Œ ì•„ë‹ˆë¼, cross-attentionì˜ ëŒ€ìƒ(memory bank)ìœ¼ë¡œ í™œìš©í•œë‹¤.&lt;/strong&gt;&lt;br&gt;
Decoderì˜ &lt;strong&gt;ì‹¤ì œ ì…ë ¥ì€ ì§€ê¸ˆê¹Œì§€ ìƒì„±í•œ target tokenë“¤&lt;/strong&gt;ì´ì•¼.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id="-ì‹œê°ì ìœ¼ë¡œ-ê·¸ë ¤ë³´ë©´"&gt;ğŸ’¡ ì‹œê°ì ìœ¼ë¡œ ê·¸ë ¤ë³´ë©´:
&lt;/h2&gt;&lt;p&gt;css&lt;/p&gt;
&lt;p&gt;ë³µì‚¬í¸ì§‘&lt;/p&gt;
\[ì…ë ¥ ë¬¸ì¥ (source)\]&lt;p&gt; â†’ &lt;/p&gt;
\[Encoder\]&lt;p&gt; â†’ context representations â†‘ &lt;/p&gt;
\[Decoder â† ì´ì „ ë‹¨ì–´ë“¤\]&lt;p&gt; â†’ Masked self-attention â†“ Cross-attention to Encoder output â†“ ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡ (one token at a time)&lt;/p&gt;</description></item><item><title>Transformer - Decoder</title><link>https://juijeong8324.github.io/p/nlp/transformer-decoder/</link><pubDate>Sun, 22 Jun 2025 00:34:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/transformer-decoder/</guid><description>&lt;p&gt;TransformerëŠ” Decoderì™€ EncoderÂ  êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤..! ì•ì—ì„œ ë°°ìš´ í•µì‹¬ ê°œë…ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ê° êµ¬ì¡°ë¥¼ ìì„¸íˆ ì•Œì•„ë³´ë„ë¡ í•˜ì.Â &lt;/p&gt;
&lt;h3 id="transformer-decoder"&gt;Transformer Decoder
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@bU8qFf/btsOKCcUETl/AAAAAAAAAAAAAAAAAAAAANxHlKSJS4OWqoujltyGRQZCjz-0SeP4dPPdkvWSJj4Q/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=eYzKHUr9ewovgtCNHcXFdQL0lSQ%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:426,&amp;ldquo;originHeight&amp;rdquo;:594,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:255,&amp;ldquo;height&amp;rdquo;:356}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì‰½ê²Œ ìƒê°í•´ì„œ Language modelsì²˜ëŸ¼ ì–´ë–»ê²Œ ìš°ë¦¬ê°€ systemsì„ buildí• ê¹Œë¥¼ ìƒê°í•˜ë©´ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;minimal self-attention architectureë¡œ ë³´ì´ì§€ë§Œ, ì‚¬ì‹¤ ì¢€ ë” ë§ì€ componentê°€ ìˆë‹¤!Â &lt;/p&gt;
&lt;p&gt;- Embeddingsì™€ Position EmbeddingsëŠ” ë™ì¼í•˜ë‹¤.Â &lt;/p&gt;
&lt;h4 id="1-multi-head-attention"&gt;&lt;strong&gt;1. Multi-head Attention&lt;/strong&gt;Â 
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ë¨¼ì € &lt;strong&gt;self-attentionì´ ì•„ë‹Œ multi-head self-attetionì´ë„¤..?&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@JZfkN/btsOLeP8Om5/AAAAAAAAAAAAAAAAAAAAAG8vKO-oE3BZoqxfdNLP0Uk8-Drz3pCbja42a7Rje257/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=FxRnVrMw6ZV7WPJmfY2nPPglNQg%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:1048,&amp;ldquo;originHeight&amp;rdquo;:528,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:775,&amp;ldquo;height&amp;rdquo;:390}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì—¬ê¸°ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì‚¬ì‹¤.. HeadëŠ” ë¬´ì—‡ì„ attention í•  ê²ƒì¸ì§€ë¥¼ ê²°ì •í•´ì£¼ëŠ” ê²ƒì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.Â &lt;/p&gt;
&lt;p&gt;ìš°ì„ &amp;hellip; Attentionì´ ê³„ì‚°ë˜ëŠ” ê³¼ì •ì„ ì•Œì•„ë³´ì!Â &lt;/p&gt;
&lt;p&gt;Matricesì—ì„œ key-query-value attentionì´ ì–´ë–»ê²Œ ê³„ì‚°ë˜ëŠ” ì§€ ë´…ì‹œë‹¤&amp;hellip;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Input&lt;/strong&gt;Input vectorsì˜ concatenationë¼ê³  í•  ìˆ˜ ìˆë‹¤.Â X = \[x1; ... ; xn\] âˆˆ â„ğ‘›Ã— ğ‘‘ (í–‰ì´ nê°œ, ì—´ì´ dê°œ; ì¦‰, nì€ ë‹¨ì–´ì˜ ê°œìˆ˜ dëŠ” ì°¨ì›)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Output&lt;/strong&gt;&lt;br&gt;
softmax(XQ(XK)T)XV âˆˆâˆˆâ„ğ‘›Ã—ğ‘‘&lt;br&gt;
ì´ë•Œ, ğ‘‹ğ¾ âˆˆ â„ğ‘›Ã—ğ‘‘, ğ‘‹ğ‘„ âˆˆ â„ğ‘›Ã—ğ‘‘, ğ‘‹ğ‘‰ âˆˆ â„ğ‘›Ã—ğ‘‘&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;1. &lt;strong&gt;Query-Key dot products : Â ğ‘‹ğ‘„Â ğ‘‹ğ¾Â âŠ¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bHygVe/btsOMHpR4u6/AAAAAAAAAAAAAAAAAAAAAJQHdXe472r-kBNk9-TJICHeLE0lO-blGYRs7X__jwwM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=27m1ZJXKwrOLB5luicgVpt2yEcU%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:668,&amp;ldquo;originHeight&amp;rdquo;:172,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì¦‰ ê²°ê³¼ëŠ” ì‰½ê²Œ ìƒê°í•´ì„œ ê° Query ë²¡í„°ì™€ ê° Key ë²¡í„° ê°„ì˜ dot productì˜ ê°’ì„ ëª¨ë‘ êµ¬í•œ matrixë¼ê³  ë³´ë©´ ëœë‹¤..!Â &lt;/p&gt;
&lt;p&gt;ê²°ê³¼ matrixì˜ (i,j)ì˜ ê°’ì€ Qì˜ ië²ˆì§¸ í–‰(ië²ˆì§¸ wordì˜ Query) Kì˜ jë²ˆì§¸ ì—´(jë²ˆì§¸ wordì˜ Key)ì˜ dot product (í˜„ì¬ Queryê°€ Keyë¥¼ ì–¼ë§ˆë‚˜ ì°¸ê³ í•˜ëŠ”ê°€?) ë¼ê³  ë³´ë©´ ëœë‹¤!! ê·¸ë¦¬ê³ í•œ í–‰ì´ Queryì— ëŒ€í•œ ë‹¤ë¥¸ keyì˜ attention scoreê°€ ëœë‹¤.Â Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@XI3Hz/btsOKK9wXI7/AAAAAAAAAAAAAAAAAAAAAMmmaeiAuZCsfruzcRqCSsGtNYOyLw-ytHZSWZgzwZ_u/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=nFFGzsI2B7YglWAhS%2FfDo59dIzw%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:684,&amp;ldquo;originHeight&amp;rdquo;:194,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê·¸ë¦¬ê³  softmaxë¥¼ ì ìš©í•˜ë¨„,&lt;/p&gt;
&lt;p&gt;ê° í–‰ì€ Query ìœ„ì¹˜ iê°€ ì „ì²´ Keyë“¤(j=1~n)ì— ëŒ€í•´ attentioní•˜ëŠ” &lt;strong&gt;ê°€ì¤‘ì¹˜&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ì´ë¥¼ V(ê° wordì˜ ì‹¤ì œ ì •ë³´)ì— ê³±í•˜ì—¬ weighted averageë¥¼ ê³„ì‚°í•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;softmax ê²°ê³¼ì˜Â &lt;strong&gt;í•œ í–‰&lt;/strong&gt; (ì¦‰, Queryê°€ ë³´ëŠ” attention weight)&lt;br&gt;
ì™€ Vì˜ &lt;strong&gt;í•œ ì—´&lt;/strong&gt; (íŠ¹ì • ì˜ë¯¸ ì°¨ì›ë§Œ ë‹´ê³  ìˆìŒ)ì„ ê³±í•˜ë©´&lt;br&gt;
ê³¼ì—° ì´ê²Œ ë¬´ìŠ¨ ì˜ë¯¸ì§€?â€&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Softmaxí•œ í•œ í–‰ Ã— Vì˜ í•œ ì—´ =&lt;br&gt;
&lt;strong&gt;&amp;ldquo;ì´ Queryê°€ í•´ë‹¹ ì˜ë¯¸ ì°¨ì›ì— ëŒ€í•´ ì–¼ë§ˆë‚˜ ì •ë³´ë¥¼ ëŒì–´ì™”ëŠ”ê°€?&amp;rdquo;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ê·¸ë¦¬ê³  ê·¸ê±¸ &lt;strong&gt;d_v ê°œ ì°¨ì›ì— ëŒ€í•´ ëª¨ë‘&lt;/strong&gt; ê³„ì‚°í•˜ë‹ˆê¹Œ&lt;br&gt;
â†’ ië²ˆì§¸ Queryì˜ &lt;strong&gt;context vector&lt;/strong&gt;ê°€ ë‚˜ì˜¤ëŠ” ê±°ì˜ˆìš”!&lt;/p&gt;
&lt;p&gt;ì¦‰ ê²°ê³¼ matrixì˜ (i, j)ì˜ ê°’ì€ í•œ wordì˜ Attention ê°€ì¤‘ì¹˜ì— ëŒ€í•˜ì—¬ ë‹¤ë¥¸ wordë“¤ì— ëŒ€í•´ ê³±í•˜ì—¬ ë”í•œ ê°’(ì´ë•Œ ë‹¤ë¥¸ wordì˜ ì¼ë¶€ ì°¨ì›ë§Œ ê³±í•œ ê²ƒ)Â &lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ ië²ˆì§¸ í–‰ì€ ì „ì²´ contextì„!!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ë§Œì•½ ìš°ë¦¬ê°€ í•œ sentenceì—ì„œ ì—¬ëŸ¬ ìœ„ì¹˜ë¥¼ í•œë²ˆì— ë³´ê³ ì‹¶ë‹¤ë©´ ì–´ë–¨ê¹Œ??&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ë‹¨ì–´ iëŠ” ë³´í†µ, self-attentionì´ xiTQTKxj (ì¦‰ xiì˜ Query, xjì˜ Key)ê°€ ë†’ì€ ê³³ì„ &amp;ldquo;ë³´ê³ &amp;quot;ìˆëŠ”ë°, ì¦‰ ë‹¨ì–´ jë¥¼ ë°”ë¼ë³´ëŠ”ë°, ì–´ì©Œë©´ ë‹¤ë¥¸ ì´ìœ ë¡œ ë‹¤ë¥¸ j(ë‹¤ë¥¸ ë‹¨ì–´ë“¤)ë„ ì§‘ì¤‘í•´ì„œ ë³´ê³  ì‹¶ì„ ìˆ˜ë„ ìˆì§€ ì•Šì„ê¹Œ?&lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ëŠ” ì—¬ëŸ¬ ê°œì˜ Q, K, V metricesì„ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ ê°œì˜ attention &amp;ldquo;head&amp;quot;ë¥¼ ì •ì˜í•  ê²ƒì´ë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@Q6rwO/btsOKByllUD/AAAAAAAAAAAAAAAAAAAAAAWQ59oYeD3MYB6pbl_b33hwnPTT02HUEnPvMDQSSXSL/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=8mCDlJK7KD%2FYybjO0feQnPsIxrM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:217,&amp;ldquo;originHeight&amp;rdquo;:50,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;Ql, Kl, VlëŠ” ê°ê° lë²ˆì§¸ headì—ì„œ ì‚¬ìš©ë˜ëŠ” í–‰ë ¬ì´ê³ ,&lt;/p&gt;
&lt;p&gt;hëŠ” headì˜ ê°œìˆ˜, lì€ head ë²ˆí˜¸ (1ë¶€í„° hê¹Œì§€)ë¼ê³  í•˜ì.Â &lt;/p&gt;
&lt;p&gt;ì—¬ê¸°ì„œ ì „ì²´ ì°¨ì› dë¥¼ head ìˆ˜ hë¡œ ë‚˜ëˆ„ì–´ì„œ ê° headëŠ” ë” ì‘ê³  ë…ë¦½ì ì¸ ê³µê°„ì—ì„œ ì‘ë™í•¨.&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@dC2ypW/btsOLuSGwUr/AAAAAAAAAAAAAAAAAAAAAJHiJj9SOuemqas0W38uXz5iwcuUmErvBcFPS7gdwi_u/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=I8M1ZFDFf1HnsKa3x8l9Z7oHzSI%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:814,&amp;ldquo;originHeight&amp;rdquo;:57,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê° attention headëŠ” attentionì€ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;attention score : XQl(Kl)TXT&lt;/p&gt;
&lt;p&gt;value í•©ì‚° : ê·¸ ê²°ê³¼ì— XVlë¥¼ ê³±í•©Â &lt;/p&gt;
&lt;p&gt;ê° headëŠ” ì„œë¡œ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ attentionì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ê°’ì€ ì‘ì§€ë§Œ ë…ë¦½ì ì¸ feature representationì´ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@JEEE9/btsOMVuVg3F/AAAAAAAAAAAAAAAAAAAAANwwdgS3eIQEJWHparx&amp;ndash;n0sZBjcxZZN937ht1nKoYGE/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=k0QKofMYuIO4QAUiYNiAbzg9h%2BA%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:660,&amp;ldquo;originHeight&amp;rdquo;:42,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;output vectorë¥¼ í–‰ë ¬ë¡œ ë§Œë“  í›„ combineÂ &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ì¦‰, ê° headëŠ” ì„œë¡œ different thingsë¥¼ &amp;ldquo;ë³´ê³ &amp;rdquo;, value vectorsë„ ë‹¤ë¥´ê²Œ constrcutí•œë‹¤!!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ë°©ë²•&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ê°€ hê°œì˜ ë§ì€ attention headsë¥¼ ê³„ì‚°í• ì§€ë¼ë„ ê·¸ê²ƒì€ ë§¤ìš° ë¹„ì‹¸ì§€ ì•Šë‹¤.Â &lt;/p&gt;
&lt;p&gt;1. &lt;strong&gt;ğ‘‹ğ‘„âˆˆâ„ğ‘›Ã—ğ‘‘ ë¥¼ ê³„ì‚°í•˜ê³  â„ğ‘›Ã—â„Ã—ğ‘‘/â„ ë¡œ reshape&lt;/strong&gt; í•œë‹¤. (XK, XVë„ ë§ˆì°¬ê°€ì§€ë¡œ!!)Â &lt;/p&gt;
&lt;p&gt;ì´ë ‡ê²Œ ë˜ë©´ dì°¨ì›ì˜ nê°œì˜ wordì—ì„œ attention head hê°œë¥¼ ë§Œë“¤ê³  ì‹¶ê¸° ë•Œë¬¸ì—&lt;/p&gt;
&lt;p&gt;dimenstion dë¥¼ hê°œì˜ headë¡œ ë‚˜ëˆ„ê³  ê° headì— d/hë§Œí¼ í• ë‹¹í•´ì¤€ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ resahpe ì‹œ ê° ë‹¨ì–´(n)ê°œê°€ hê°œì˜ headë¥¼ ê°€ì§€ë©° ê° headëŠ” d/h ì°¨ì›ì˜ query vectorë¥¼ ê°€ì§„ë‹¤. (2ì°¨ì› í–‰ë ¬ì´ì—ˆëŠ”ë° ì´ì œ 3ì°¨ì› tensorê°€ ëœë‹¤)Â &lt;/p&gt;
&lt;p&gt;2. &lt;strong&gt;â„â„Ã—ğ‘›Ã—ğ‘‘/â„ ë¡œ transpose&lt;/strong&gt;í•œë‹¤. ê·¸ëŸ¬ë©´ head axisì´ batch axisì²˜ëŸ¼ ì‘ë™í•œë‹¤. (ë˜í•œ ë§¨ ì•ì´ ë³´í†µ depthì˜ ì˜ë¯¸..!)&lt;/p&gt;
&lt;p&gt;Transformer êµ¬í˜„ì—ì„œëŠ” ê° headì— ëŒ€í•´ ë…ë¦½ì ìœ¼ë¡œ attentionì„ ê³„ì‚°í•´ì•¼ í•˜ëŠ”ë°, &lt;strong&gt;ë³´í†µ batch aixsë¥¼ ì œì¼ ì•ì— ë‘ê³  batch ì°¨ì› ë‹¨ìœ„ë¡œ ë³‘ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤.&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ì¦‰, ê° headë¥¼ ë…ë¦½ì ì¸ sampleì²˜ëŸ¼ ë³‘ë ¬ ì²˜ë¦¬ í•˜ê¸° ìœ„í•´ì„œë‹¤!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;ê·¸ëƒ¥ ì‰½ê²Œ ìƒê°í•´ì„œ hê°œì˜ headê°€ nxd/hì˜ í¬ê¸°ì˜ matrixë¥¼ ê°–ê³  ìˆë‹¤ ìƒê°í•˜ì!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ì›ë˜:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;[ ë‹¨ì–´1: head1, head2, ..., headh ]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;[ ë‹¨ì–´2: head1, head2, ..., headh ]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; â†“
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;transpose
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;[ head1: ë‹¨ì–´1, ë‹¨ì–´2, ... ]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;[ head2: ë‹¨ì–´1, ë‹¨ì–´2, ... ]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ê±°ì˜ ë‹¤ë¥¸ ëª¨ë“  ê²ƒì€ ë™ì¼í•˜ê³  í–‰ë ¬ë“¤ì˜ í¬ê¸°ë“¤ë„ ë™ì¼í•˜ë‹¤!!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bqj8M3/btsOMWHmfti/AAAAAAAAAAAAAAAAAAAAAF57waTz0TN_gIlpr1n2S9W0yFIumLkPrqiVmgsA3rWk/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=paBWHF47CiK5BkOGc1zDSSZ6G68%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:712,&amp;ldquo;originHeight&amp;rdquo;:205,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´ headê°€ 3ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. (ê°€ë¡œ ì„¸ë¡œê°€ ì°¨ì›ê³¼ ëŒ€ì‘ë˜ëŠ”ê²Œ ì•„ë‹˜ ì£¼ì˜!!!)Â &lt;/p&gt;
&lt;p&gt;XQ, XK: nxd/hê°€ 3ê°œ ìˆë‹¤! ë¼ê³  ì´í•´í•˜ë©´ ì‰¬ìš¸ë“¯!Â &lt;/p&gt;
&lt;p&gt;XQKX: 3ê°œì˜ headê°€ ê°ê° nxn í¬ê¸°ì˜ attention score matrixë¥¼ ê°–ê³  ìˆë‹¤.Â &lt;/p&gt;
&lt;p&gt;dot productí•´ì„œ ê° headì˜ attention scoreë¥¼ ê³„ì‚°í•˜ê²Œ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@Rthvu/btsONayBQbW/AAAAAAAAAAAAAAAAAAAAAAnSO07E_Wm7qCPAZthbcpzc44sdrbX8s1TVz2gLUm1n/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=Ndh%2FrOW7XNRiZ3xjeSy3rRphUp4%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:808,&amp;ldquo;originHeight&amp;rdquo;:193,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;softmaxë¥¼ ìˆ˜í–‰í•œ í›„ ê° headë³„ë¡œ weighted average ìˆ˜í–‰í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê° headì˜ attention scores matrixì™€ ê° headì˜ XVë¥¼ ê°ê° ê³±í•œ ê²°ê³¼ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Scaled dot Product&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;Qì™€ Kì˜ ì°¨ì›ì´ ì»¤ì§€ë©´ ë‚´ì  ê°’ì´ ë„ˆë¬´ ì»¤ì ¸ì„œ softmaxê°€ í„°ì§€ë‹ˆê¹Œ, ê·¸ê±¸ ë°©ì§€í•˜ë ¤ê³  âˆš(d/h)ë¡œ ë‚˜ëˆ ì£¼ëŠ” ê²Œ â€œScaled Dot Product Attentionâ€ì´ë‹¤.&lt;/p&gt;
&lt;p&gt;ë§Œì•½ dimensionality d (embedding ì°¨ì›ì˜ ìˆ˜)ê°€ ë„ˆë¬´ ì»¤ì§€ë©´, vector ê°„ì˜ dot products ê°’ë„ ë” ì»¤ì§€ëŠ” ê²½í–¥ì´ ìˆë‹¤. ì´ëŸ¬ë©´ softmax í•¨ìˆ˜ì˜ inputì´ ë” ì»¤ì§ˆ ìˆ˜ ìˆëŠ”ë°,,, ê·¸ëŸ¬ë©´ softmaxì˜ ì¶œë ¥ì´ ë„ˆë¬´ ë¾°ì£¡í•´ì ¸ì„œ, backpropagation ë•Œ gradientsê°€ ë§¤ìš° ì‘ì•„ì§€ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.&lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ê°€ ë³¸ ì´ self-attention function ëŒ€ì‹ ì—&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@dFKBY5/btsONaSUJ9p/AAAAAAAAAAAAAAAAAAAAAInbOgy7vn8xxuJxnVytPDmpeOGYo4fkla18Rq2j3CDd/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=gkmQXl51aS%2BHeswq2915ngwBC5Q%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:483,&amp;ldquo;originHeight&amp;rdquo;:58,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;attention scoreë“¤ì„ ë£¨íŠ¸ d/hë¡œ ë‚˜ëˆ„ì–´ì„œ scoresë“¤ì´ ë” ì»¤ì§€ì§€ ì•Šê²Œ ë§‰ì•„ì¤€ë‹¤!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@3OYaJ/btsOMPnVrZE/AAAAAAAAAAAAAAAAAAAAAB1UXP4AA7e0w5fsq_VPe6CoDIZ5mmgqYX1BeOgiruWF/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=el2wnpDwXb2wRhpEpczmk68PBXY%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:471,&amp;ldquo;originHeight&amp;rdquo;:69,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##][##&lt;em&gt;Image|kage@o4J0S/btsONd3buUS/AAAAAAAAAAAAAAAAAAAAADofAExHVj7_N97OY9Zs-8Lij24z1s5Pck0KkqGBpciL/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=eiqFHJqOS1ZNOlMLDswQfIlnhQM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:371,&amp;ldquo;originHeight&amp;rdquo;:567,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h4 id="2-residual-connections"&gt;&lt;strong&gt;2. Residual Connections&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ì´ì œ optimization trick ëª‡ ê°€ì§€ë¥¼ ì•Œì•„ë³´ì&amp;hellip;!!! ì´ì „ ê²°ê³¼ì™€ Layerë¥¼ í†µê³¼í•œ ê²°ê³¼ë¥¼ ë”í•¨ìœ¼ë¡œì¨ ê·¸ ë³€í™”ëŸ‰ë§Œ í•™ìŠµí•œë‹¤!!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;ë³´í†µ diagramì—ì„œëŠ” ì¢…ì¢… Add &amp;amp; Normì´ë¼ê³  í‘œí˜„ë˜ë¯€ë¡œ ì°¸ê³ í•˜ì‹œê¸¸..!Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Residual Connectionsì€ model ë” ì˜ traingë˜ë„ë¡ ë„ì™€ì£¼ëŠ” trickì´ë‹¤.&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bHgXRo/btsONbK3W44/AAAAAAAAAAAAAAAAAAAAAKOrF8OaH0_iKARp0hS_5yMMgOV7Pd2q4rsEMUzg0uMI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=QS9Id%2FLagGTDlT%2BMxSioY2%2FW4Xc%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:437,&amp;ldquo;originHeight&amp;rdquo;:88,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ëŠ” ë³´í†µ ië²ˆì§¸ layerì˜ representaionì€ ì´ì „ layerì˜ representationì„ layerë¥¼ ë„£ì€ ê²°ê³¼ë¼ê³  ìƒê°í•œë‹¤.&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@x53sD/btsOLdKt4Gt/AAAAAAAAAAAAAAAAAAAAAFF5A4DLuQQoRHBwsKR6Sfztkwdhx6gK70aJevsNkdmC/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=9R764qZ%2FKZsn6qp0WZAq%2Fg5jZjw%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:430,&amp;ldquo;originHeight&amp;rdquo;:96,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ°ë°, Residual Connectionì—ì„œëŠ” ìœ„ì™€ ê°™ì´ ë°”ê¿”ì§„ë‹¤. ì´ì „ layerì˜ representationì— Layerì˜ representationì„ ë”í•œë‹¤!&lt;/p&gt;
&lt;p&gt;ì¦‰, ìš°ë¦¬ëŠ” ì „ì²´ functionë¥¼ ìƒˆë¡œ ë°°ìš°ëŠ” ê²Œ ì•„ë‹ˆë¼ residual(ë³€í™”ëŸ‰)ë§Œ í•™ìŠµí•˜ë©´ ëœë‹¤!!Â &lt;/p&gt;
&lt;p&gt;ì¦‰ ê¸°ì¡´ ì…ë ¥ + ë³€í™”ëœ ë¶€ë¶„ì„ ë„£ìœ¼ë‹ˆ &lt;strong&gt;ê¸°ì¡´ ì…ë ¥ì„ ì–¼ë§ˆë‚˜ ë°”ê¿€ì§€ë¥¼ í•™ìŠµí•œë‹¤.&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;- ì¥ì &lt;/p&gt;
&lt;p&gt;ì´ êµ¬ì¡° ë•ë¶„ì— Gradientê°€ ë” ì¢‹ì•„ì§„ë‹¤. -&amp;gt; ì—­ì „íŒŒê°€ ì˜ ì „ë‹¬ëœë‹¤!Â &lt;/p&gt;
&lt;p&gt;Biasë„ ë” ì¢‹ì•„ì§„ë‹¤!! -&amp;gt; í•™ìŠµ ì´ˆê¸°ì— ì…ë ¥ ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜(identity)ì— ê°€ê¹Œìš´ í¸í–¥ì„ ê°€ì§€ê²Œ ëœë‹¤. ëª¨ë¸ì´ ì²˜ìŒì—” ë­”ê°€ë¥¼ ë°”ê¾¸ì§€ ì•Šê³  ê·¸ëƒ¥ í˜ë ¤ë³´ë‚´ëŠ” ê²ƒì— ìµìˆ™í•´ì§!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@ct3AVM/btsOMqhCltF/AAAAAAAAAAAAAAAAAAAAABDqhFU8a9GPRKkFriDpNB_hUlxvl6uchzwO2y-SB-ul/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=7B7VhBO4ErmPDWcu%2BWVCASiN2FA%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:413,&amp;ldquo;originHeight&amp;rdquo;:275,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h4 id="3-layernormalization"&gt;&lt;strong&gt;3. LayerÂ normalization&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Layer normalizaitonì´ modelì´ ë” ë¹ ë¥´ê²Œ trainë˜ë„ë¡ ë„ì™€ì£¼ëŠ” trickì´ë‹¤.&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;LayerNormì€ ë‹¨ì–´ ë²¡í„° ë‚´ë¶€ì˜ ê°’ ë¶„í¬ë¥¼ ì •ê·œí™”í•´ì„œ, í•™ìŠµì„ ì•ˆì •í™”í•˜ê³  ë¹ ë¥´ê²Œ ë§Œë“œëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Idea&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ê° layerì—ì„œ hidden vectorì˜ ë¶ˆí•„ìš”í•œ, ì˜ë¯¸ì—†ëŠ” variation(ì¡ìŒ)ì„ cut downí•˜ê¸° ìœ„í•´, standard deviation(í‘œì¤€ í¸ì°¨)ê³¼ unit meanì„ normalizingí•˜ëŠ” ê²ƒ! (í‰ê· ì´ 0ì´ê³  í‘œì¤€í¸ì°¨ê°€ 1ì´ ë˜ë„ë¡ ì •ê·œí™”í•˜ëŠ” ê²ƒ!)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ì´ê²Œ ì˜ ì‘ë™í•˜ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜ëŠ”, gradient(ê¸°ìš¸ê¸°)ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ì •ê·œí™”í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğ‘¥ âˆˆâ„ğ‘‘&lt;/strong&gt; : modelì—ì„œì˜ í•œ individual(word) vector , dì°¨ì›(embedding ëœ ì°¨ì›)ì„&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğœ‡ =Ïƒğ‘—=1 ğ‘‘ ğ‘¥ğ‘—&lt;/strong&gt; : ì´ê±´ meanì´ì—ì—¬ ğœ‡ âˆˆ â„, xì˜ ê° ì„±ë¶„ì„ í‰ê·  ë‚´ë©´ scala ê°’ì´ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğœ 2 = 1 ğ‘‘ ğ‘‘ Ïƒ ğ‘— = 1 ğ‘¥ ğ‘— âˆ’ ğœ‡&lt;/strong&gt; ; ì´ê±´ standard deviationì´ì—ì—¬ , Â ğœ âˆˆ â„. í‰ê· ì—ì„œ ì–¼ë§ˆë‚˜ í¼ì ¸ ìˆëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ë©´ ë¶„ì‚° í˜¹ì€ í‘œì¤€í¸ì°¨ê°€ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğ›¾ âˆˆâ„ğ‘‘&lt;/strong&gt; : gain parameters í•™ìŠµ ê°€ëŠ¥í•œ parameter&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğ›½ âˆˆâ„ğ‘‘&lt;/strong&gt;Â  :bias parameters í•™ìŠµ ê°€ëŠ¥í•œ parameter&lt;/p&gt;
&lt;p&gt;ìœ„ì˜ ë‘ parameterëŠ” ìµœì¢… ì¶œë ¥ scaleì„ ì¡°ì •í•˜ëŠ”ë° ì‚¬ìš©, í•„ìš”ì—†ìœ¼ë©´ ìƒëµ ê°€ëŠ¥í•¨.&lt;/p&gt;
&lt;p&gt;ë˜í•œ ì •ê·œí™” í•´ì£¼ë‹¤ê°€ ì •ë³´ ì†ì‹¤ì˜ ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ë³µì› ê°€ëŠ¥ì„±ì„ ì£¼ê¸° ìœ„í•´ í•™ìŠµ ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°ë¥¼ ë¶™ì¸ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¼ë…€ layer normalizationì€ ë‹¤ìŒê³¼ ê°™ì´ compute ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bzundi/btsOLdwZG81/AAAAAAAAAAAAAAAAAAAAAPIoF1Mu9BEVX6I6BDGP-DfyqObOIQZkGKQMH-QLG_B&lt;/em&gt;/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=hDiFjO8Rby2Z758WU2LPXSb7Fo4%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:860,&amp;ldquo;originHeight&amp;rdquo;:128,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}_##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ì…ë ¥ vecotrì—ì„œ í‰ê· ì„ ë¹¼ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ì›Œì„œ ì •ê·œí™” í•œ í›„ ê°ë§ˆì™€ ë² íƒ€ë¡œ scale ì¡°ì •&lt;/strong&gt;Â &lt;/p&gt;
&lt;h3 id="ì§œì”"&gt;&lt;strong&gt;ì§œì”!&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Transforemer DecoderëŠ” ë‹¤ìŒê³¼ ê°™ì€ Blockìœ¼ë¡œ ì´ë£¨ì–´ì¡Œë‹µë‹ˆë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@7J3Ex/btsOK9nKDyq/AAAAAAAAAAAAAAAAAAAAAGIfAhhGOKFkXFLsXkKguFv5zwYiFQ-E7AOOotqaA9aT/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=jKPRgP%2FzTDkKagUu3Iu2FyXG0CE%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:386,&amp;ldquo;originHeight&amp;rdquo;:662,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Self-attentionÂ &lt;/li&gt;
&lt;li&gt;Add &amp;amp; Norm (ì´ê±´ ê° ë‹¨ê³„ë§ˆë‹¤ ë¶™ì—¬ì£¼ëŠ” ê²ƒì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤)Â &lt;/li&gt;
&lt;li&gt;Feed-Forward&lt;/li&gt;
&lt;li&gt;Add &amp;amp; Norm&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ê¶ê¸ˆí•œ-ê²ƒ"&gt;&lt;strong&gt;ê¶ê¸ˆí•œ ê²ƒ!!&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;&amp;ldquo;n Ã— dì—ì„œ nì€ heightê³  dëŠ” widthì²˜ëŸ¼ ë´¤ëŠ”ë°,&lt;br&gt;
reshapeí•´ì„œ n Ã— h Ã— d/hê°€ ë˜ë©´ nì´ channelì´ ë˜ëŠ” ê±°ì•¼? ì•„ë‹ˆë©´ ì—¬ì „íˆ heightì•¼?&amp;rdquo;&lt;/p&gt;
&lt;p&gt;â—ï¸&lt;strong&gt;nì€ ì—¬ì „íˆ height (sequence axis), ì¦‰ &amp;lsquo;ë‹¨ì–´ ìˆ˜&amp;rsquo;ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¶•ì´ì•¼.&lt;/strong&gt;&lt;br&gt;
â†’ &lt;strong&gt;channel ì¶•ì€ h Ã— d/h ìª½ì„ (ì¦‰, ë‚˜ì¤‘ ì°¨ì›ë“¤)&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="-ì™œ-ê·¸ë ‡ê²Œ-í•´ì„í•´ì•¼-í•˜ëŠ”ê°€"&gt;ğŸ”¸ ì™œ ê·¸ë ‡ê²Œ í•´ì„í•´ì•¼ í•˜ëŠ”ê°€?
&lt;/h2&gt;&lt;h3 id="1-ì›ë˜-í…ì„œ-êµ¬ì¡°"&gt;1. ì›ë˜ í…ì„œ êµ¬ì¡°:
&lt;/h3&gt;&lt;p&gt;XQâˆˆRnÃ—dXQ âˆˆ â„^{n Ã— d}XQâˆˆRnÃ—d&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;n&lt;/strong&gt;: ë‹¨ì–´ ê°œìˆ˜ â†’ ë¬¸ì¥ ê¸¸ì´ â†’ height (ì„¸ë¡œ)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;d&lt;/strong&gt;: ê° ë‹¨ì–´ì˜ ì„ë² ë”© â†’ width (ê°€ë¡œ)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì´ êµ¬ì¡°ëŠ” ë§ˆì¹˜ ì´ë¯¸ì§€ì—ì„œ:&lt;/p&gt;
&lt;p&gt;arduino&lt;/p&gt;
&lt;p&gt;ë³µì‚¬í¸ì§‘&lt;/p&gt;
&lt;p&gt;height x width&lt;/p&gt;
&lt;p&gt;ì²˜ëŸ¼ ë³´ì„. (2D)&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="2-reshape"&gt;2. reshape:
&lt;/h3&gt;&lt;p&gt;RnÃ—hÃ—d/hâ„^{n Ã— h Ã— d/h}RnÃ—hÃ—d/h&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;n&lt;/strong&gt;ì€ ê·¸ëŒ€ë¡œ: ë‹¨ì–´ ìˆ˜ â†’ ê·¸ëŒ€ë¡œ height (ì„¸ë¡œ)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;h Ã— d/h&lt;/strong&gt;ëŠ”: ë²¡í„°ë¥¼ head ìˆ˜ë¡œ ë¶„ë¦¬í•œ ê²ƒ â†’ ì´ê²Œ &lt;strong&gt;channel ë°©í–¥ í™•ì¥ì²˜ëŸ¼ ì‘ë™&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="-ì´ë¯¸ì§€ì™€-ë¹„êµí•´ì„œ-ëŒ€ì‘ì‹œì¼œë³´ë©´"&gt;ğŸ”¸ ì´ë¯¸ì§€ì™€ ë¹„êµí•´ì„œ ëŒ€ì‘ì‹œì¼œë³´ë©´:
&lt;/h2&gt;&lt;p&gt;ìì—°ì–´ ì²˜ë¦¬ í…ì„œì´ë¯¸ì§€ ì²˜ë¦¬ í…ì„œì˜ë¯¸&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;n&lt;/th&gt;
&lt;th&gt;height&lt;/th&gt;
&lt;th&gt;ë‹¨ì–´ ìœ„ì¹˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;d (or h Ã— d/h)&lt;/td&gt;
&lt;td&gt;channel&lt;/td&gt;
&lt;td&gt;ì„ë² ë”© ì°¨ì› / attention head&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(ì—†ìŒ)&lt;/td&gt;
&lt;td&gt;width&lt;/td&gt;
&lt;td&gt;(ë‹¨ì–´ëŠ” 1Dì´ë¯€ë¡œ ê°€ë¡œì¶• ì—†ìŒ)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id="-ìš”ì -ë‹¤ì‹œ-ë§í•˜ë©´"&gt;âœ… ìš”ì  ë‹¤ì‹œ ë§í•˜ë©´:
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;n Ã— d: nì€ heightì²˜ëŸ¼ &amp;ldquo;ë‹¨ì–´ ìœ„ì¹˜&amp;rdquo;, dëŠ” ì„ë² ë”© (channelì²˜ëŸ¼ í•´ì„ ê°€ëŠ¥)&lt;/li&gt;
&lt;li&gt;n Ã— h Ã— d/h: nì€ ì—¬ì „íˆ height (ë‹¨ì–´ ìœ„ì¹˜),&lt;br&gt;
â†’ h Ã— d/hëŠ” channel dimensionì²˜ëŸ¼ ì‘ë™ (ê° ë‹¨ì–´ë‹¹ ì—¬ëŸ¬ head í‘œí˜„)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;â—ï¸&lt;strong&gt;channelì€ ë§¨ ë’¤ìª½ ì°¨ì›ì´ê³ , heightëŠ” í•­ìƒ ë‹¨ì–´ ìˆœì„œ(n)&lt;/strong&gt;&lt;br&gt;
reshapeë¥¼ í•´ë„ &lt;strong&gt;nì´ channelì´ ë˜ëŠ” ê±´ ì ˆëŒ€ ì•„ë‹˜&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id="-ê°ê°-ë¹„ìœ "&gt;ğŸ”¸ ê°ê° ë¹„ìœ 
&lt;/h2&gt;&lt;p&gt;ì´ë¯¸ì§€ì—ì„œëŠ”:&lt;/p&gt;
&lt;p&gt;less&lt;/p&gt;
&lt;p&gt;ë³µì‚¬í¸ì§‘&lt;/p&gt;
&lt;p&gt;ì´ë¯¸ì§€: &lt;/p&gt;
\[Height Ã— Width Ã— Channel\]&lt;p&gt; ë¬¸ì¥ ì…ë ¥: &lt;/p&gt;
\[Token ìœ„ì¹˜ Ã— Feature\]&lt;p&gt; â†’ reshape â†’ &lt;/p&gt;
\[Token ìœ„ì¹˜ Ã— Head Ã— Dim\_per\_Head\]&lt;p&gt;ê·¸ë˜ì„œ &lt;strong&gt;ë¬¸ì¥ì—ì„œ Token ìœ„ì¹˜(n)&lt;/strong&gt; ëŠ” &lt;strong&gt;í•­ìƒ height&lt;/strong&gt; ì—­í• ì´ì§€ channelì´ ì•„ë‹ˆì•¼.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="-ìš”ì•½-ì •ë¦¬"&gt;âœ… ìš”ì•½ ì •ë¦¬
&lt;/h2&gt;&lt;p&gt;reshape ì „reshape í›„nì˜ ì˜ë¯¸channelì€ ì–´ë””?&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;n Ã— d&lt;/th&gt;
&lt;th&gt;n Ã— h Ã— d/h&lt;/th&gt;
&lt;th&gt;âœ… ì—¬ì „íˆ ë‹¨ì–´ ìœ„ì¹˜ (height)&lt;/th&gt;
&lt;th&gt;âœ… h Ã— d/h (ë’¤ìª½ì´ channel ì—­í• )&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;channelì¸ê°€?&lt;/td&gt;
&lt;td&gt;âŒ ì•„ë‹˜&lt;/td&gt;
&lt;td&gt;âŒ&lt;/td&gt;
&lt;td&gt;Â &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="ê¶ê¸ˆí•œ-ê²ƒ222"&gt;&lt;strong&gt;ê¶ê¸ˆí•œ ê²ƒ!!222&lt;/strong&gt;
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;matrixì˜ ì˜ë¯¸ê°€ ê³ ì •ë˜ì–´ ìˆëŠ” ê²Œ ì•„ë‹ˆë¼&amp;hellip; visionì¸ì§€, LLMì¸ì§€ ë‹¤ ë‹¤ë¥¸ ê±°ì•¼?&amp;rdquo;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;âœ… &lt;strong&gt;ë§ì•„. í…ì„œ(í–‰ë ¬)ì˜ ê° ì°¨ì›ì´ ë­˜ ì˜ë¯¸í•˜ëŠ”ì§€ëŠ” &amp;lsquo;ë„ë©”ì¸&amp;rsquo;ì— ë”°ë¼ ë‹¬ë¼.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="ì˜ˆì‹œ-ë„ë©”ì¸ë³„-ê°™ì€-ì°¨ì›ì´-ì˜ë¯¸ê°€-ë‹¤ë¦„"&gt;ì˜ˆì‹œ: ë„ë©”ì¸ë³„ ê°™ì€ ì°¨ì›ì´ ì˜ë¯¸ê°€ ë‹¤ë¦„
&lt;/h2&gt;&lt;p&gt;ë„ë©”ì¸í…ì„œ ì°¨ì›ì°¨ì› ì˜ë¯¸&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Vision (CNN)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;\[B, C, H, W\]&lt;/th&gt;
&lt;th&gt;B: ë°°ì¹˜, C: ì±„ë„, H: ë†’ì´, W: ë„ˆë¹„&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;LLM (Transformer NLP)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;\[B, N, D\]&lt;/td&gt;
&lt;td&gt;B: ë°°ì¹˜, N: í† í° ìˆ˜, D: ì„ë² ë”© ì°¨ì›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Multi-Head Attention&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;\[B, H, N, D/H\]&lt;/td&gt;
&lt;td&gt;B: ë°°ì¹˜, H: head ìˆ˜, N: ë‹¨ì–´ ìˆ˜, D/H: headë‹¹ ì„ë² ë”©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Audio&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;\[B, T, F\]&lt;/td&gt;
&lt;td&gt;B: ë°°ì¹˜, T: ì‹œê°„ì¶•, F: ì£¼íŒŒìˆ˜ bin&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Time series&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;\[B, T, C\]&lt;/td&gt;
&lt;td&gt;B: ë°°ì¹˜, T: íƒ€ì„ìŠ¤í…, C: ë³€ìˆ˜ (ì±„ë„)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description></item><item><title>Transformer(1) - Self-attention</title><link>https://juijeong8324.github.io/p/nlp/transformer1-self-attention/</link><pubDate>Sat, 21 Jun 2025 22:36:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/transformer1-self-attention/</guid><description>&lt;p&gt;ìš°ë¦¬ê°€ ì•ì—ì„œ Attentionì´ input sequenceë¡œë¶€í„° ì…ë ¥ htì— ì¤‘ìš”í•œ informationì„ ë„˜ê²¨ì£¼ëŠ” ê²ƒì´ë¼ê³  ë°°ì› ë‹¤!Â &lt;/p&gt;
&lt;p&gt;ê·¼ë° RNNë„ ê³¼ê±° ì‹œì ì˜ informationì„ inputë¡œ ì „ë‹¬í•˜ëŠ” ê°™ì€ ëª©ì ì´ ë‹¤!Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ê·¸ë ‡ë‹¤ë©´&amp;hellip; RNNì„ êµ³ì´ ì“¸ í•„ìš”ê°€ ìˆì„ê¹Œ?? Attentionì´ ì •ë³´ë¥¼ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ì´ë¼ë©´!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œ Transformerê°€ ë“±ì¥!&lt;/p&gt;
&lt;h3 id="self-attention"&gt;Self-attention
&lt;/h3&gt;&lt;p&gt;Transformerë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” self-attentionì„ ì´í•´í•´ì•¼ í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cross Attention&lt;/strong&gt;ì€&lt;/p&gt;
&lt;p&gt;generate ytë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ input xì— attentioní•˜ ê²ƒ! (ì§€ë‚œ ì‹œê°„ ë°°ìš´ attention)&lt;/p&gt;
&lt;p&gt;ì—¬ê¸°ì„œÂ &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Self-Attention&lt;/strong&gt;ì€&lt;/p&gt;
&lt;p&gt;ytë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ y&amp;lt;tì— attentioní•˜ëŠ” ê²ƒ!&lt;/p&gt;
&lt;p&gt;ì¦‰, output seqë¥¼ ìƒì„±í•˜ëŠ”ë° í˜„ì¬ ì‹œì  tì˜ ì¶œë ¥ì„ ìƒì„±í•  ë•Œ ì´ì „ ì¶œë ¥ë“¤ì„ ë³´ê³  ìƒì„±í•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;ì´ì „ í† í°ë“¤ì„ ì°¸ê³ í•´ì„œ ì¤‘ìš”ë„ë¥¼ ë”°ì§€ê³  ì´ìš©í•´ì„œ ìƒì„±í•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@be8zpa/btsOLD9Pu2C/AAAAAAAAAAAAAAAAAAAAABekskayoAGc-4KwI0taA2S2n5x75RR84yoJp3LmHM5&lt;/em&gt;/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=oPXBMgLREoUk%2Bs1lXcOvkMDidx0%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:694,&amp;ldquo;originHeight&amp;rdquo;:431,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}_##]&lt;/p&gt;
&lt;h3 id="keys-queries-values"&gt;Keys, Queries, Values
&lt;/h3&gt;&lt;p&gt;ì vocabulary Vì˜ ë‹¨ì–´ sequence w1:nì´ ìˆë‹¤ê³  í•˜ì (e.g Zuko made his uncle tea)&lt;/p&gt;
&lt;p&gt;1. Embedding matrix Eì— ëŒ€í•˜ì—¬ word embeddingìœ¼ë¡œ ë°”ê¾¼ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê° wi -&amp;gt; xi ë¡œ ë°”ê¿”ì¤€ë‹¤. (Xi = Ewi)&lt;/p&gt;
&lt;p&gt;2. weight Matrix Q, K, Vë¥¼ ê° word embeddingìœ¼ë¡œ ë°”ê¾¼ë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@3bxeM/btsOLCJObQm/AAAAAAAAAAAAAAAAAAAAAPPwJYTdEqOoY-1m_a_89pdr78vQeiFFObvbF_PwsQSB/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=knLrb8DGb9z5D0QLpUUaxb5jFoM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:704,&amp;ldquo;originHeight&amp;rdquo;:50,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;3. Keyì™€ Queryì˜ similiaitesë¥¼ ê³„ì‚°í•˜ê³  softmaxë¡œ normalizeí•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@pu8xq/btsOLhTA3Ic/AAAAAAAAAAAAAAAAAAAAAEdv3PkowQlo4wCjxNURej_xaWUEUbOeP8IDwZKwTaeX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=EzMQQfvZ6qdz2wZnvtl1PM23nNk%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:440,&amp;ldquo;originHeight&amp;rdquo;:95,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;4. ê·¸ê²ƒì„ ê°€ì¤‘í•©í•˜ì—¬ ê³„ì‚°!~~~&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@brX2hH/btsOMOCt1Ss/AAAAAAAAAAAAAAAAAAAAAFHwzM5XzmrME2N66kQYaip9Xke9JpxQYgjLwixyGUxc/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=kFWt2skh%2Bd33OGIOUrXlvJKV6B4%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:170,&amp;ldquo;originHeight&amp;rdquo;:89,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h3 id="self-attentionì˜-ì¥ë²½-ê·¸ë¦¬ê³ -solutions"&gt;Self Attentionì˜ ì¥ë²½.. ê·¸ë¦¬ê³  Solutions!
&lt;/h3&gt;&lt;h4 id="1-ë‹¨ì–´ì˜-ìˆœì„œì—-ëŒ€í•œ-ì •ë³´ê°€-ì•„ì˜ˆ-ì—†ì–ì•„--sequence-order"&gt;&lt;strong&gt;1. ë‹¨ì–´ì˜ ìˆœì„œì— ëŒ€í•œ ì •ë³´ê°€ ì•„ì˜ˆ ì—†ì–ì•„! : Sequence order&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@ZtbFh/btsOLwJAES9/AAAAAAAAAAAAAAAAAAAAADKFLj7QwjL3cOCIukImqTwR25LakhzG6y-TD18VxGnq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=eJLlud8Oj3YYy2srFT%2F%2F%2BpJp37M%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:473,&amp;ldquo;originHeight&amp;rdquo;:65,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sollutions&lt;/strong&gt;: Position representationsì„ inputì— ì¶”ê°€í•´ì¤€ë‹¤!&lt;/p&gt;
&lt;p&gt;ì¦‰, key, query, valueë¥¼ ë§Œë“¤ê¸° ì´ì „ì— input embeddingì— order informationì„ ë¯¸ë¦¬ ë„£ì–´ì¤˜ì•¼ í•œë‹¤!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;poisional encoding&lt;/strong&gt;ì¸ vector Pi ëŠ” piê°€ ë¬¸ì¥ì˜ íŠ¹ì • ìœ„ì¹˜(index)ì— ìˆìŒì„ ê°€ë¦¬í‚¨ë‹¤. (ì‹¤ì œë¡œ sin,cos ë¡œ êµ¬ì„±ëœ ê³ ì •ëœ vector ê°’ì„)&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@VkgXq/btsOMP2sD9u/AAAAAAAAAAAAAAAAAAAAAAasu_r12kGGo8RBan-Ib1umxwTvS6JhqtmjjiuDG94M/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=BeQP0E3V%2B7bN4r5dIH3Y33d8z6U%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:529,&amp;ldquo;originHeight&amp;rdquo;:158,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì´ë¥¼ input embeddingì— ê·¸ëƒ¥ ë”í•´ì£¼ë©´ ëœë‹¤~~Â &lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œ xi~ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ë°˜ì˜í•œ ìµœì¢… embeddingì´ë¯€ë¡œÂ &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;positioned embedding&lt;/strong&gt;, &lt;strong&gt;positional input&lt;/strong&gt;ì´ë¼ê³  ë¶€ë¥¸ë‹¤.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ì–´ë–»ê²Œ Position representationì„ ë§Œë“¤ê¹Œ?&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. SinusoidalÂ positionÂ representations&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@c9Vr33/btsOLhzgeUc/AAAAAAAAAAAAAAAAAAAAAJavoxqGN70ZHvmnz&amp;ndash;tohf_l3ngojWt1gVCfmWjyhdx/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=bKmPA5WExLRHkchrf7xjRJVyxkI%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:864,&amp;ldquo;originHeight&amp;rdquo;:209,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;sin, cos í•¨ìˆ˜ë¡œ ë³€í™˜í•´ì„œ ë²¡í„°ë¡œ í‘œí˜„!Â &lt;/p&gt;
&lt;p&gt;ì¥ì &lt;/p&gt;
&lt;p&gt;- vector ì°¨ì›ë§ˆë‹¤ ì£¼ê¸°ì™€ dimensionì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì‹œì ì˜ íŒ¨í„´ì„ í‘œí˜„ ê°„ìœ¼!Â &lt;/p&gt;
&lt;p&gt;- ì™„ì „í•œ ì ˆëŒ€ì  ìœ„ì¹˜ê°€ ì•„ë‹Œ ìƒëŒ€ì  ìœ„ì¹˜ ì°¨ì´(ê°„ê²©)ì´ ë” ì¤‘ìš”í•˜ê²Œ ì‘ë™í•¨!Â &lt;/p&gt;
&lt;p&gt;- ì…ë ¥ sequenceê°€ ê¸¸ì–´ì ¸ë„ íŒ¨í„´ì´ ë°˜ë³µë  ìˆ˜ ìˆë‹¤! ê·¸ë˜ì„œ ì•ˆ ë³¸ ê¸¸ì´ê¹Œì§€ ì¼ë°˜í™”(extrapolation)í•  ìˆ˜ ìˆìŒ!Â &lt;/p&gt;
&lt;p&gt;ë‹¨ì &lt;/p&gt;
&lt;p&gt;- Not learnable: ì™„ì „íˆ ê³ ì •ëœ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì ¸ì„œ, í•™ìŠµ ì¤‘ì— ëª¨ë¸ì´ ììœ ë¡­ê²Œ ì¡°ì •í•˜ê±°ë‚˜ ìµœì í™” X&lt;/p&gt;
&lt;p&gt;- extrapolation ì‚¬ì‹¤ ì•ˆë¨ : ê¸´ ì…ë ¥ì— ëŒ€í•´ì„œ ì„±ëŠ¥ì´ ë˜‘ê°™ì´ ì˜ ì•ˆ ë‚˜ì˜´&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. scratch(ì²˜ìŒë¶€í„°, ì œë¡œë¡œ)ë¡œ ë¶€í„° Position representation vectorsë¥¼ í•™ìŠµì‹œí‚¤ì!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Absolute poistion representationì„ ë°°ìš°ì!&lt;/p&gt;
&lt;p&gt;pië¥¼ í•™ìŠµê°€ëŠ¥í•œ parameterë„ ë‘ì~~ piëŠ” P matrixì˜ matrix columnìœ¼ë¡œ ë‘ì!Â &lt;/p&gt;
&lt;p&gt;ì¥ì &lt;/p&gt;
&lt;p&gt;- ìœ ì—°í•˜ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ë‹¨ì &lt;/p&gt;
&lt;p&gt;- ì¼ë°˜í™” X : ë§Œì•½ í›ˆë ¨ ì‹œ ìµœëŒ€ nì˜ ê¸¸ì´ì¸ ë¬¸ì¥ ë³´ì•˜ëŠ”ë°&amp;hellip; ê·¸ ì´ìƒì˜ ë¬¸ì¥ì´ ë“¤ì–´ì˜¤ë©´?? ì•ˆ ë¨&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. RoPE : Common, modern position embeddings&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ë‹¤ì‹œ ìƒê°í•´ë³´ì.&lt;/strong&gt;Â &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;positioned embeddingì„ f(x, i) í˜•íƒœë¡œ relative position embeddingìœ¼ë¡œì„œ ìƒê°í•´ë³´ì.Â &lt;/p&gt;
&lt;p&gt;f(x, i) : ë‹¨ì–´ xì˜ ìœ„ì¹˜ iì—ì„œì˜ embeddingì´ë¼ê³  í•´ë³´ì Â (xëŠ” ë‹¨ì–´, iëŠ” ìœ„ì¹˜)&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bmsHwM/btsOMo48Apu/AAAAAAAAAAAAAAAAAAAAABCTMEWbF7JEplWdLSExxE0LJ4etKHholRd305xf5yI2/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=2tUd%2F%2FGuyVAjpc2GWv3hhXMOQY0%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:346,&amp;ldquo;originHeight&amp;rdquo;:79,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì—¬ê¸°ì„œ Attention function gëŠ”Â  x, yì˜ ì˜ë¯¸ì™€ (i-j)ë¼ëŠ” ìƒëŒ€ì  ìœ„ì¹˜ ì°¨ì´ì—ë§Œ ì˜ì¡´í•´ì•¼ í•œë‹¤!!&lt;/p&gt;
&lt;p&gt;ê¸°ì¡´ì˜ positional embeddingì€ ì´ ëª©í‘œë¥¼ ì¶©ì¡±ì‹œí‚¤ì§€ ëª» í•˜ëŠ”ê°€?Â &lt;/p&gt;
&lt;p&gt;- 1ì˜ ê²½ìš° : ìƒëŒ€ì ì´ì§€ ì•Šì€ ë‹¤ì–‘í•œ cross-termì„ ê°€ì§„ë‹¤. (ì ˆëŒ€ ìœ„ì¹˜ ì •ë³´ê°€ ë”°ë¡œë”°ë¡œ ë°˜ì˜ëœ ê²ƒ)Â &lt;/p&gt;
&lt;p&gt;- 2ì˜ ê²½ìš° : (i-j)ì— ëŒ€í•˜ì—¬ inner productë¡œ í‘œí˜„ë˜ì§€ ì•ŠëŠ”ë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Â &lt;strong&gt;Embedding via rotation&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ìš°ë¦¬ëŠ” position embeddingì´ absolute positionì— ì˜í–¥ì„ ë°›ì§€ ì•Šê²Œ í•˜ê³  ì‹¶ìŒ! -&amp;gt; relative positionìœ¼ë¡œ!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ìš°ë¦¬ëŠ” inner productsê°€ arbitrary rotationì— ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆì–´! -&amp;gt; ë‚´ì  ê°’ì€ ë™ì¼í•´!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@DtFFE/btsOLSr9vWn/AAAAAAAAAAAAAAAAAAAAADePNAOx6AlQof92jWFhowuivem3neJo5rh3uBiwXpN8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=Q0rZ6D1%2F5q6iS2VU%2Fu6AMsCUFts%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:829,&amp;ldquo;originHeight&amp;rdquo;:306,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:677,&amp;ldquo;height&amp;rdquo;:250}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ë‚´ì  ê¸°ë°˜ìœ¼ë¡œ attention scoreë¥¼ ê³„ì‚°í•˜ë©´..! ìƒëŒ€ ìœ„ì¹˜ ê¸°ë°˜ attentionì´ ê°€ëŠ¥í•˜ë‹¤!&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@1fMUn/btsOKA7fddu/AAAAAAAAAAAAAAAAAAAAAFiY4bPdxRyyNhxboOvoLfxVa_NpvRX9zY2gSX9qV884/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=0Ypa%2B5YtdisnSDC%2BdvW7G6TNGCQ%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:766,&amp;ldquo;originHeight&amp;rdquo;:439,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ coordinateë¥¼ ì§ì§€ì–´ì„œ 2D í‰ë©´ì—ì„œ íšŒì „ì‹œì¼œë¼!!! (ì•„ì´ë””ì–´ëŠ” ë³µì†Œìˆ˜ì—ì„œ ë”°ì˜¨ ê²ƒ!!)Â &lt;/p&gt;
&lt;p&gt;ì¦‰ ìœ„ì¹˜ iì— ëŒ€í•˜ì—¬ ë‹¨ì–´ vector xì— ëŒ€í•´ì„œ sin/così„ ê³±í•˜ì—¬ ë²¡í„° ê³µê°„ì—ì„œ íšŒì „ì‹œí‚¤ì!Â &lt;/p&gt;
&lt;p&gt;ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´Â &lt;/p&gt;
&lt;p&gt;ê° ë‹¨ì–´ëŠ” d ì°¨ì›ì˜ Query/Key ë²¡í„°ë¥¼ ê°€ì§„ë‹¤! ê·¸ë¦¬ê³  poisionì´ ì ìš© ëœ í›„ Position embdding(ìœ„ì¹˜ ì •ë³´ê°€ ë‚´ì œëœ) Query/Keyê°€ ìƒì„±ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;ë‹¨ì–´ Enhancedì— ëŒ€í•œ Queryì™€ Key vector (x1, x2)ê°€ ì¡´ì¬í•˜ê³  position m(indexì„)ì´ ìˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì´ë•Œ Q, K vector(x1, x2)ë¥¼ sin/cos ê¸°ë°˜ìœ¼ë¡œ më§Œí¼ íšŒì „ì‹œí‚¨ë‹¤. ê·¸ëŸ¬ë©´ ë°˜ì˜ì´ ë˜ê³ !!Â &lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë©´!! íšŒì „ì´ ë°˜ì˜ëœ vectorëœ í›„ Enhancedë¼ëŠ” Q ë²¡í„°(ìœ„ì¹˜ 1)ì™€ Rotaryë¼ëŠ” ë‹¨ì–´ì˜ K ë²¡í„°(ìœ„ì¹˜ 4)ê°€ dot productí•˜ì—¬ attention score ê³„ì‚° ì‹œ ìœ„ì¹˜ ì •ë³´ê°€ ë°˜ì˜ì´ ëœë‹¤~~~Â &lt;/p&gt;
&lt;h4 id="2-deep-larningì„-ìœ„í•œ-nonlinearitiesê°€-ì—†ì›Œ-ê·¸ëƒ¥-ë‹¨ìˆœíˆ-weighted-í‰ê· ì´ìëƒ--non-linearities"&gt;&lt;strong&gt;2. Deep Larningì„ ìœ„í•œ nonlinearitiesê°€ ì—†ì›Œ!! ê·¸ëƒ¥ ë‹¨ìˆœíˆ weighted í‰ê· ì´ìëƒ : non-linearities&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@cnQ8RS/btsOLBKXrNm/AAAAAAAAAAAAAAAAAAAAAFKU9q_Lzhwt1sEmCWN69mWDpMJBFc3f2Bne5KxbOL6F/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=PH05iw82z83oI%2Bz%2FWBPsUqLeBgQ%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:684,&amp;ldquo;originHeight&amp;rdquo;:530,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:506,&amp;ldquo;height&amp;rdquo;:392}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;Self-attention ë©”ì»¤ë‹ˆì¦˜ ìì²´ì—ëŠ” ë¹„ì„ í˜•ì„± ì´ ì—†ë‹¤&amp;hellip; ì „ë¶€ ì„ í˜• ì—°ì‚°ì„!!&lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ Self-attentionë§Œ ê³„ì† ìŒ“ë‹¤ë³´ë©´&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ì´ì „ layerì—ì„œ ì–»ì€ Value vectorë“¤ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ &lt;strong&gt;ì¬í‰ê· (re-averaging)&lt;/strong&gt; í•˜ëŠ” ê²ƒì— ë¶ˆê³¼í•˜ê²Œ ë¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Solutions&lt;/strong&gt;: Self-attention ì´í›„ Feed-Forward networkë¡œ ë¹„ì„ í˜•ì„±ì„ ì¶”ê°€í•˜ì—¬ ê° output vectorë¥¼ ì²˜ë¦¬í•¨!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bC9JFW/btsOMaTAZXU/AAAAAAAAAAAAAAAAAAAAAIMhHk4CCtIMmh3ZLczQgxLDfGQkZneu9oxm_6RbHjjj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=ZwTxvW9sZnvB1u21ip%2FiGgjZ8wk%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:492,&amp;ldquo;originHeight&amp;rdquo;:141,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h4 id="3-sequenceë¥¼-ì˜ˆì¸¡í• -ë•Œ"&gt;&lt;strong&gt;3. sequenceë¥¼ ì˜ˆì¸¡í•  ë•Œ &amp;ldquo;ë¯¸ë˜ë¥¼ ë³´ì§€ ì•ŠëŠ”ë‹¤&amp;quot;ëŠ” ë³´ì¥ì´ ìˆë‚˜? : Masking the future in self-attnetion&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;ì´ ë§ì€ ì¦‰ìŠ¨, Machine translationì´ë‚˜ Language modelingê³¼ ê°™ì´ ìˆœì°¨ì ì¸ taskì—ì„œ ì•„ì§ ë‚˜ì˜¤ì§€ ì•Šì€ ë‹¨ì–´ë¥¼ ë¯¸ë¦¬ ì°¸ê³ í•˜ë©´ ì•ˆ ëœë‹¤ëŠ” ëœ»!!! (self-attentionì€ input ì „ì²´ë¥¼ í™•ì¸í•˜ë‹ˆê¹Œ!) -&amp;gt; ì¦‰, training í•  ë•Œ! (inferenceëŠ” ì•„ë‹˜!!)Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@ddgVDd/btsOKS0PxOh/AAAAAAAAAAAAAAAAAAAAAOi-yB3vie78rxzMKs93S6BqZjHFUgrvqUUa1bHpPxsR/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=cyvxv8gcPjAo1aOSFR5x51ViWMo%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:704,&amp;ldquo;originHeight&amp;rdquo;:298,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:324,&amp;ldquo;height&amp;rdquo;:137}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;DecoderëŠ” ê¸°ë³¸ì ìœ¼ë¡œ self-attentionê³¼ cross-attentionì„ ì‚¬ìš©í•œëŠ”ë°,&lt;/p&gt;
&lt;p&gt;train ë„ì¤‘ì— inputê³¼ targetì„ ëª¨ë‘ ë°›ëŠ”ë‹¤. ì´ë•Œ ë‹¨ì–´ ì˜ˆì¸¡í•˜ëŠ”ë° self-attention ì‹œ target seq ì „ì²´ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ì´ë¥¼ ê°€ë ¤ì•¼ í•¨.&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë©´ ë§¤ timestepë§ˆë‹¤ keysë“¤ê³¼ querysë¥¼ ë°”ê¿”ì„œ ì´ì „ ë‹¨ì–´ë§Œ ë³´ê²Œ ë§Œë“¤ë©´ ë ê¹Œ? -&amp;gt; Inefficient!&lt;/p&gt;
&lt;p&gt;ë§¤ timestepë§ˆë‹¤ attention ë²”ìœ„ë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì•¼ í•˜ë¯€ë¡œ ë³‘ë ¬ ê³„ì‚°ì´ ë¶ˆê°€ëŠ¥&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;ì¦‰, paralleizationì´ ê°€ëŠ¥í•˜ë ¤ë©´&lt;/p&gt;
&lt;p&gt;- ì „ì²´ seqë¥¼ ë‹¤ ë„£ì€ í›„&lt;/p&gt;
&lt;p&gt;- future ë‹¨ì–´ë“¤ì˜ attention scoresë¥¼ -ë¬´í•œëŒ€ë¡œ ì„¤ì •í•˜ì—¬ attentionì„ mask out ì²˜ë¦¬í•´ì•¼ í•¨!Â &lt;/p&gt;
&lt;p&gt;- softmaxì—ì„œ exp (âˆ’âˆ ) = 0ì´ë¯€ë¡œ ì™„ì „íˆ ë¬´ì‹œëœë‹¤~~&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@TRTZW/btsOLhF2Z4s/AAAAAAAAAAAAAAAAAAAAADuKmel_ldl2RlpnDJcyRSNAbSZzMBz7mppbBHytCNAl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=9kk6y0Xu1gbYNWN3q28meDty3dY%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:240,&amp;ldquo;originHeight&amp;rdquo;:93,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##][##&lt;em&gt;Image|kage@baAlZ0/btsONayxgTE/AAAAAAAAAAAAAAAAAAAAANjvvtTqGeILUDd_ZK6OgOMF1lUF9iu1TwhfAOM-A1J5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=bow2jZu5lSfPkPtaH5X1Y6%2F0soM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:729,&amp;ldquo;originHeight&amp;rdquo;:587,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:507,&amp;ldquo;height&amp;rdquo;:408}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solutions&lt;/strong&gt;: attention weightë¥¼ 0ìœ¼ë¡œ ì¼ë¶€ëŸ¬ ë§Œë“¤ì–´ì„œ ë¯¸ë˜ë¥¼ mask outí•œë‹¤.Â &lt;/p&gt;
&lt;h3 id="ì •ë¦¬--self-attentionì„-ìœ„í•œ-building-block"&gt;ì •ë¦¬ : Self-attentionì„ ìœ„í•œ building block!
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@brSmTy/btsOKUdjH2z/AAAAAAAAAAAAAAAAAAAAAMg4S7fYAb3shTEAmgIlyP-GYvVUNOoPsSiBoIg6-Gct/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=oG%2FancrmYQbbA1RrMiYyw7MZXLc%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:405,&amp;ldquo;originHeight&amp;rdquo;:605,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. self-attention&lt;/strong&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. Position representations&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;seq orederë¥¼ êµ¬ì²´í™”í•˜ê¸° ìœ„í•´ì„œ! self-attentionì€ inputì˜ ìˆœì„œë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—!Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. nonlineariies&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;self-attention blockì˜ outputì— Feed Forwar newrokë¥¼ êµ¬í˜„!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. Masking&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ë¯¸ë˜ë¥¼ ë³´ì§€ ì•Šê³  parallize ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œÂ &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ë¯¸ë˜ì— ìƒì„±ë¼ì•¼ í•  ë‹¨ì–´ì˜ ì •ë³´ê°€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ì• ë‹¨ì–´ ì˜ˆì¸¡ ê³¼ì •ì— í˜ëŸ¬ ë“¤ì–´ê°€ë©´ ì•ˆ ë¨&lt;/strong&gt; âŒ&lt;/li&gt;
&lt;li&gt;Maskingì€ ì´ëŸ° **ì •ë³´ ëˆ„ì¶œ(leakage)**ì„ ë§‰ì•„ì¤Œ&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Attention</title><link>https://juijeong8324.github.io/p/nlp/attention/</link><pubDate>Sat, 21 Jun 2025 20:02:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/attention/</guid><description>&lt;p&gt;ì´ì „ì— RNNì˜ ë¬¸ì œì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ë‹¤..Â &lt;/p&gt;
&lt;p&gt;- ë³‘ë ¬ ì²˜ë¦¬ ì•ˆ ë¨Â &lt;/p&gt;
&lt;p&gt;- ì„ í˜• êµ¬ì¡°ì— ì˜ì¡´ë˜ì–´ ë¬¸ì¥ì„ ì´í•´í•˜ê¸° ë•Œë¬¸ì— ì˜ ì²˜ë¦¬í•˜ì§€ ëª»í•¨!Â &lt;/p&gt;
&lt;p&gt;ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‚˜ì˜¨ solutionì´ Attentionì´ë‹¤.Â &lt;/p&gt;
&lt;h3 id="core-idea"&gt;Core Idea
&lt;/h3&gt;&lt;p&gt;decoderì˜ ê° stepì—ì„œ &lt;strong&gt;encoderì™€ì˜ ì§ì ‘ ì—°ê²°ì„ ì´ìš©í•´ì„œ,&lt;/strong&gt; &lt;strong&gt;source sequenceì˜ íŠ¹ì • partì— ì§‘ì¤‘í•œë‹¤.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ì „í†µì ì¸ RNNì€ ì¸ì½”ë”ì˜ ë§ˆì§€ë§‰ hidden state í•˜ë‚˜ë§Œ ë³´ê³  ë‹¤ìŒ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í–ˆë‹¤! (ì •ë³´ ì†ì‹¤ì´ í¬ë‹¤!! )&lt;/p&gt;
&lt;h3 id="basic-idea"&gt;Basic Idea
&lt;/h3&gt;&lt;p&gt;attentionì´ ì—†ì„ ë•Œ ë‹¤ìŒì˜ ì•„ì´ë””ì–´ë¥¼ ë– ì˜¬ë ¸ë‹¤&amp;hellip;&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë©´&amp;hellip; hidden state ì •ë³´ í•˜ë‚˜ì— ì´ì „ì˜ ì •ë³´ê°€ ëª¨ë‘ ì˜ ìš”ì•½í–ˆë‹¤ê³  ë³´ì¥í•  ìˆ˜ ì—†ìœ¼ë‹ˆê¹Œ&amp;hellip;? ê·¸ê±¸ ë‹¤ ìš”ì•½í•˜ëŠ” ê±° ì–´ë•Œ??&lt;/p&gt;
&lt;p&gt;ì¦‰,&lt;/p&gt;
&lt;p&gt;Encoderë¡œë¶€í„° ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì€&amp;hellip; encoderì˜ hidden stateë“¤ì„ í‰ê· (average) ë‚´ëŠ” ê²ƒì´ë‹¤!!Â &lt;/p&gt;
&lt;p&gt;ì¦‰, decoderì— Encoderì˜ context vectorë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒ!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@DzINe/btsOL8VNoTS/AAAAAAAAAAAAAAAAAAAAADSpoVkTOAsA7wF9MjZMkmiyPmzuPpUAJixANG3RSohv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=NXR3m48WTG8XNRTJBf0gAnQSJ3Y%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:513,&amp;ldquo;originHeight&amp;rdquo;:331,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ë¬¸ì¥ì˜ encodingì„ ê³„ì‚°í•  ë–„ ëª¨ë“  hidden stateë“¤ì˜ element-wise max ë˜ëŠ” meanì„ ì·¨í•˜ëŠ” ê²ƒ!Â &lt;/p&gt;
&lt;h3 id="attention"&gt;Attention
&lt;/h3&gt;&lt;p&gt;ì¦‰ weighted averageë¥¼ í†µí•´ì„œ&amp;hellip; weightê°€ ë†’ì€ ê²ƒì„ ë¹„ì¤‘ìœ¼ë¡œ í•™ìŠµí•˜ëŠ”ê±°ì§€!!!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bIAhbq/btsOL3ty6o4/AAAAAAAAAAAAAAAAAAAAACs-ThR3rgXTYPTssuVKhnURBuKVs2n-EG99t9BcnWl&lt;/em&gt;/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=Nw566sYGRUABPHE7sXEyNVrjP2U%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:446,&amp;ldquo;originHeight&amp;rdquo;:299,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}_##]&lt;/p&gt;
&lt;p&gt;Attentionì—ëŠ” &lt;strong&gt;Query&lt;/strong&gt;, &lt;strong&gt;Keys&lt;/strong&gt;, &lt;strong&gt;Values&lt;/strong&gt;ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Query&lt;/strong&gt;ëŠ” ëª¨ë“  &lt;strong&gt;Keys&lt;/strong&gt;ë“¤ê³¼ ë¶€ë“œëŸ½ê²Œ ë§¤ì¹­ë˜ì–´ 0ê³¼ 1 ì‚¬ì´ì˜ weightë¥¼ ë§Œë“ ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê·¸ weightë¥¼ &lt;strong&gt;Key&lt;/strong&gt;ì— í•´ë‹¹í•˜ëŠ” &lt;strong&gt;Value&lt;/strong&gt;ë¥¼ ê³±í•˜ê³  ëª¨ë‘ ë”í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@r2Fiy/btsOLFT6U3Y/AAAAAAAAAAAAAAAAAAAAADVSA91a0Adca3w9eUKGdt8oU8SvCWTfee6_W5xrSTp0/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=M1U58ZHRsAVKoxonVNAMmI9N%2ByI%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:344,&amp;ldquo;originHeight&amp;rdquo;:288,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;Lookup tableì€ keyë“¤ì„ valueì— Mappingí•œ tableì´ë‹¤.Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Query&lt;/strong&gt;ê°€ íŠ¹ì • &lt;strong&gt;Key&lt;/strong&gt;ì™€ ì¼ì¹˜í•˜ë©´, ê·¸ &lt;strong&gt;Key&lt;/strong&gt;ì— í•´ë‹¹í•˜ëŠ” &lt;strong&gt;Value&lt;/strong&gt;ë¥¼ ë°˜í™˜í•œë‹¤.Â Â &lt;/p&gt;
&lt;h3 id="seq2seq-with-attentionì˜-ì‘ë™-ë°©ì‹"&gt;seq2seq with attentionì˜ ì‘ë™ ë°©ì‹
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@l4yAK/btsOLEgvH74/AAAAAAAAAAAAAAAAAAAAAPdoukWGC6LQxaiMEPsCv4MI-r_AcVKtzSjoi0XZLDGq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=HKYtM0yCNoBE4S66vj2GEuJPpEE%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:746,&amp;ldquo;originHeight&amp;rdquo;:407,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ë¹¨ê°„ìƒ‰ì€ Encoder, ì´ˆë¡ìƒ‰ì€ Decoder ë¶€ë¶„ì´ë¼ê³  í•˜ì!Â &lt;/p&gt;
&lt;p&gt;1. ê° inputì˜ hidden stateì— ëŒ€í•´ì„œ í˜„ì¬ st(decoderì˜ ì´ˆê¸°í™” vector)ë¥¼ ê³±í•´ì„œ Attention scoresë¥¼ ê³„ì‚°í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@mOuKB/btsOKqQYw8p/AAAAAAAAAAAAAAAAAAAAAGPQ6q_U9671wVdFeZTwEgEA17_CnmsLWW11L6pPpGxS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=p0B%2BCxP3mBSdvZy36bJcegFs%2FhA%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:593,&amp;ldquo;originHeight&amp;rdquo;:459,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;2. SoftMaxë¥¼ ì´ìš©í•´ì„œ ê³„ì‚°í•œ scoresë¥¼ probability distribution(ì´ê²ƒì´ ì§„ì§œ ê°€ì¤‘ì¹˜!)ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤.Â &lt;/p&gt;
&lt;p&gt;Decoder timestepì—ì„œëŠ” ìš°ë¦¬ëŠ” ì œì¼ ë¨¼ì € encdoer hidden state ë¥¼ ë¨¼ì € focusing í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bITsJ5/btsOMGRY8EJ/AAAAAAAAAAAAAAAAAAAAAL7KQOnnV7YuFMhrG-J9nAEXHgTGVkMlCT4YyZ4wKEsI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=mB%2BI%2Fdz6tTmEBS3MlJA%2BryCYPrU%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:742,&amp;ldquo;originHeight&amp;rdquo;:479,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:496,&amp;ldquo;height&amp;rdquo;:320}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;3. ì´ attention distribution(ê°€ì¤‘ì¹˜)ì„ ì´ìš©í•´ì„œ encoder hidden stateì˜ ê°€ì¤‘í•©ì„ ê³„ì‚°í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê³„ì‚°ëœ attention outputì€ ëŒ€ë¶€ë¶„ high attentionì„ ê°€ì§„ hidden stateì˜ ì •ë³´ë¥¼ í¬í•¨í•˜ê²Œ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@8IDHU/btsOKQomlFc/AAAAAAAAAAAAAAAAAAAAAFTLQ5a8Hx_aJPumAAmX_MDdOpwmrwrXYQDGH8c5z0FW/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=JUbcSl3rBUdudzevAyWIS3496fU%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:736,&amp;ldquo;originHeight&amp;rdquo;:457,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:581,&amp;ldquo;height&amp;rdquo;:361}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;6. attention output (context output)ê³¼ decoder hidden stateë¥¼ ì—°ê²°í•´ì„œ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ y1ì„ ê³„ì‚°í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@beZtrw/btsOMPg4qZg/AAAAAAAAAAAAAAAAAAAAAOh0qj7u_Q6kTeCNhG8flJLw-JIeY8Duad0puVbSMqg7/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=k8xTX3QjOZJWZkTfDEckIaq8uXQ%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:748,&amp;ldquo;originHeight&amp;rdquo;:467,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:529,&amp;ldquo;height&amp;rdquo;:330}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì–´ë–¤ ê²½ìš°ì—ëŠ” ì´ì „ stepì˜ attention outputë„ decoder inputì— ê°™ì´ ë„£ëŠ”ë‹¤.Â &lt;/p&gt;
&lt;h3 id="in-equations--ìˆ˜ì‹ìœ¼ë¡œ"&gt;In equations : ìˆ˜ì‹ìœ¼ë¡œ!Â 
&lt;/h3&gt;&lt;p&gt;1. Encoderì˜ hidden statesê°€ ì£¼ì–´ì§€ê³ , timestep tì— ëŒ€í•´ì„œ decoder hidden state stê°€ ìˆë‹¤ê³  í•˜ì.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@qmnw5/btsOLheU80P/AAAAAAAAAAAAAAAAAAAAABqmL3BeKs1-WwcucDIqZNZNwWTw4RZlWTUCuCAe2i6x/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=YCjEosVPZzeYKkXIP0SesBtVBLk%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:149,&amp;ldquo;originHeight&amp;rdquo;:26,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##][##&lt;em&gt;Image|kage@vdWwJ/btsOMasxrYh/AAAAAAAAAAAAAAAAAAAAAD5-9-XL4cOrEGwkLVzDy1XnV4vVSkZ917stNgHgXpTl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=sTgDFYKKxqQtemRVdUG5sJJx4CA%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:72,&amp;ldquo;originHeight&amp;rdquo;:27,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;2. ì´ stepì— ëŒ€í•´ì„œ attention scores(ë‹¨ì‹œ ìœ ì‚¬ë„ ì ìˆ˜!) ë¥¼ ê³„ì‚°í•˜ì!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bqTZ13/btsOKIcOqUM/AAAAAAAAAAAAAAAAAAAAAOzDKAMvg_w2UBQGSoDcRJ4CtMkT_RwxyMy-PXABjB1t/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=YjzML%2FZ8lXjTYNfgV49kEqPRS5w%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:319,&amp;ldquo;originHeight&amp;rdquo;:54,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì¦‰ í˜„ì¬ st(&lt;strong&gt;Query&lt;/strong&gt;)ì™€ ì…ë ¥ì˜ hidden state(&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Values&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;)ë¥¼ ê³±í•˜ë©´ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;3. ì´ stepì˜ attention distribution(&lt;strong&gt;attention Weight&lt;/strong&gt;)ì„ ê³„ì‚°í•œë‹¤. softmax í•¨ìˆ˜ë¡œ! (í™•ë¥  ë¶„í¬ë¥¼ ê³„ì‚°í•´ì£¼ê³ , í•©ì€ 1)&lt;/p&gt;
&lt;p&gt;ì¦‰, ê° stê°€ encoder hidden stateì— ëŒ€í•´ì„œ ì–¼ë§ˆë‚˜ ì§‘ì¤‘í• ì§€ í™•ë¥ ì²˜ëŸ¼ í•´ì„ ê°€ëŠ¥!!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bEvDUD/btsOKAsxBCz/AAAAAAAAAAAAAAAAAAAAAN3SAvBNcgPrYThoCliDXHKIj6l-4fUpJYJYpwck8bDS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=I3MdRz9DP3w8zkXggsLSnnuWm2c%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:264,&amp;ldquo;originHeight&amp;rdquo;:52,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;4. ì´ attention distribution(&lt;strong&gt;attention&lt;/strong&gt; &lt;strong&gt;Weight&lt;/strong&gt;)ì„ encoder hidden state(&lt;strong&gt;Values&lt;/strong&gt;)ì™€ weighted sumí•˜ì—¬ attention outputë¥¼ ì–»ëŠ”ë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@biOpXj/btsOMPaiSA6/AAAAAAAAAAAAAAAAAAAAAFZ8T5xInYjJeBn7dAg5MluLo2fCkUByTSaICLoT7Jri/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=o15kVaoMIH3jFZ72I8ynHHSJREE%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:192,&amp;ldquo;originHeight&amp;rdquo;:73,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;5. ì´ attention output atì™€ decoder hidden state stë¥¼ ì´ì–´ ë¶™ì´ê³  decoderë¡œ ë„˜ê²¨ì¤€ë‹¤!!Â &lt;/p&gt;
&lt;h3 id="ì •ë¦¬"&gt;ì •ë¦¬..!Â 
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Query qtq_t&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;ë””ì½”ë”ì˜ í˜„ì¬ hidden state (t ì‹œì )&lt;/th&gt;
&lt;th&gt;â€œì§€ê¸ˆ ì–´ë–¤ ì •ë³´ê°€ í•„ìš”í•˜ì§€?â€&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Keys kik_i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ì¸ì½”ë”ì˜ ê° hidden state&lt;/td&gt;
&lt;td&gt;ì…ë ¥ ë‹¨ì–´ë“¤ì˜ &amp;ldquo;ì •ì²´ì„±&amp;rdquo;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Values viv_i&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ë³´í†µ Keysì™€ ê°™ê³ , ì¸ì½”ë”ì˜ hidden state ìì²´&lt;/td&gt;
&lt;td&gt;ì…ë ¥ ë‹¨ì–´ë“¤ì˜ ì‹¤ì œ ì •ë³´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Attention distribution&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Queryì™€ ê° Key ê°„ì˜ ìœ ì‚¬ë„ â†’ softmaxë¡œ ë§Œë“  ê°€ì¤‘ì¹˜ë“¤&lt;/td&gt;
&lt;td&gt;Î±1,Î±2,â€¦,Î±T\alpha_1, \alpha_2, \dots, \alpha_T, ì´í•© = 1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Attention output (context vector)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âˆ‘iÎ±iâ‹…vi\sum_i \alpha_i \cdot v_i&lt;/td&gt;
&lt;td&gt;ì§‘ì¤‘í•œ ê°’ë“¤ì˜ ê°€ì¤‘ í‰ê· &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="attention-is-awesome"&gt;Attention is awesome!
&lt;/h3&gt;&lt;p&gt;Attentionì€ parallelizableí•˜ê³ Â &lt;/p&gt;
&lt;p&gt;bottlenck issuesë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.Â &lt;/p&gt;
&lt;p&gt;ì¦‰, ê° ë‹¨ì–´ì˜ representation(==vector)ì„ Queryë¡œ ì‚¬ìš©í•´ì„œ Valuesì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  ê²°í•©í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;== ê° ë‹¨ì–´(Query)ëŠ” ëª¨ë“  ë‹¨ì–´ë¥¼ íƒìƒ‰í•˜ì—¬(key) ìê¸°ì—ê²Œ í•„ìš”í•œ ì •ë³´ë§Œ ê³¨ë¼ë‚¸ë‹¤!Â &lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ ë³¸ ê²ƒì€ &lt;strong&gt;Cross-Attention&lt;/strong&gt;(Decoderê°€ Encoderë¥¼ ì³ë‹¤ë³´ëŠ” ê²ƒ)Â &lt;/p&gt;
&lt;p&gt;ì´ì œëŠ” í•œ ë¬¸ì¥ ì•ˆì—ì„œ ë‹¨ì–´ë“¤ë¼ë¦¬ ì„œë¡œ ì£¼ëª©í•˜ëŠ” &lt;strong&gt;Self-Attention&lt;/strong&gt; (ë‹¨ì–´ë“¤ë¼ë¦¬ ì„œë¡œë¥¼ ë™ì‹œì— ì³ë‹¤ë´„)ì„ ë³´ì!!Â &lt;/p&gt;
&lt;p&gt;Self-attentionì€ íŠ¹íˆ &lt;strong&gt;ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì—°ì‚°ì˜ ê°œìˆ˜&lt;/strong&gt;ê°€ sequence ê¸¸ì´ì— ë”°ë¼ ëŠ˜ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤! ì¦‰ GPUì— ì¹œí™”ì ì´ë‹¤!!&lt;/p&gt;
&lt;p&gt;ëª¨ë“  wordê°€ í•œ layerì—ì„œ ì„œë¡œ ìƒí˜¸ì‘ìš© í•˜ê¸° ë•Œë¬¸ì— ìµœëŒ€ interaction distanceëŠ” O(1)ì´ë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bJvhuO/btsOLqQdNqO/AAAAAAAAAAAAAAAAAAAAAPw0Kk8Tq9MJ_Y4-LHuDkA61C7WrHa04922uXhjVYdto/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=dryUYJGjATLAKGTSRH4XsjvRICw%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:460,&amp;ldquo;originHeight&amp;rdquo;:209,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h3 id="attention-is-awesome-deep-learning-technique"&gt;Attention is awesome Deep Learning technique
&lt;/h3&gt;&lt;p&gt;ìš°ë¦¬ëŠ”&amp;hellip; seq2seq ëª¨ë¸ì„ Machine Translation í•˜ê¸° ìœ„í•´ ê°œì„ í•œ ë°©ë²•ì¸ attentionì„ ë³´ì•˜ìŠµë‹ˆë‹¤..&lt;/p&gt;
&lt;p&gt;í•˜ì§€ë§Œ!! ë‹¤ë¥¸ ë§ì€ architextures, ê·¸ë¦¬ê³  ë§ì€ taskì—ì„œ ì‚¬ìš©ëœë‹¤ë‹¤!!Â &lt;/p&gt;
&lt;h4 id="more-general-definition-of-attention-"&gt;&lt;strong&gt;More general definition of attention :&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;â€¢ Given a set of vector values, and a vector query, attention a weighted sum of the values, dependent on the query.&lt;/p&gt;
&lt;p&gt;ì–´ë–¤ ê²½ìš°ì—ëŠ” query ê°€ valueì— attendí•œë‹¤. ë¼ê³  ë§í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ ë³¸ seq2seq + attention êµ¬ì¡°ì—ì„œëŠ” Decoderì˜ ê° hidden state (query)ê°€ Encoderì˜ ëª¨ë“  hidden state (value)ì— attentioní•œë‹¤. (ì¦‰, ì–´ë–¤ ì •ë³´ê°€ í•„ìš”í•œì§€ attentionì„ í†µí•´ ê²°ì •!)&lt;/p&gt;
&lt;h3 id="ì •ë¦¬-ì§ê´€"&gt;&lt;strong&gt;ì •ë¦¬: ì§ê´€&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ê°€ì¤‘í•© : queryê°€ ì§‘ì¤‘í•´ì•¼ í•  ê°’ì„ ê²°ì •í•œ valuesë“¤ì´ í¬í•¨ëœ ì •ë³´ì˜ ì„ íƒì  ìš”ì•½,Â &lt;/p&gt;
&lt;p&gt;Attentionì€ ì•„ë¬´ë¦¬ ë§ì€ representationì´ ìˆì–´ë„ í•˜ë‚˜ì˜ ê³ ì •ëœ fixed-size representation(vector)ì„ ë½‘ì•„ë‚¸ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê·¸ vectorëŠ” queryê°€ ì–´ë””ì— ì§‘ì¤‘í–ˆëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.Â &lt;/p&gt;
&lt;p&gt;Attentionì€ ê±°ì˜ ëª¨ë“  Deep Learning modelì—ì„œ ê°€ì¥ ê°•ë ¥í•˜ê³  ìœ ì—°í•˜ê³  ì¼ë°˜ì ì¸ pointerì´ì memory manipulationì´ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œ ì´ ì•„ì´ë””ì–´ê°€ ì ìš©ëœê²Œ NMTì—¬!Â &lt;/p&gt;
&lt;h3 id="ì¶”ê°€-ê¶ê¸ˆì¦-ì™œ-querystë‘-keysinput-hidden-stateë¥¼-dot-productí•˜ëŠ”ê²Œ-ì •ë³´ë¥¼-ê²°í•©í•˜ëŠ”ê²Œ-ë˜ëŠ”ê±°ì•¼"&gt;ì¶”ê°€ ê¶ê¸ˆì¦&amp;hellip; ì™œ Query(st)ë‘ Keys(input hidden state)ë¥¼ dot productí•˜ëŠ”ê²Œ ì •ë³´ë¥¼ ê²°í•©í•˜ëŠ”ê²Œ ë˜ëŠ”ê±°ì•¼?Â 
&lt;/h3&gt;&lt;p&gt;dot productëŠ” ê²°êµ­ ë‘ ì…ë ¥ì´ ì–¼ë§ˆë‚˜ ê´€ë ¨ ìˆëŠ”ì§€ (ìœ ì‚¬ë„)ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒ! ê·¸ë˜ì„œ Query(st)ë‘ Key(ì…ë ¥)ì–¼ë§ˆë‚˜ ê´€ë ¨ì´ ìˆëŠ”ì§€ ì¸¡ì •í•˜ê³  value(=ì •ë³´)ë¥¼ ì–¼ë§ˆë‚˜ ê°€ì ¸ì˜¬ì§€ ê²°ì •í•˜ëŠ”ê²Œ ì •ë³´ ê²°í•©!!!!&lt;/p&gt;
&lt;p&gt;ê·¼ë° ìœ„ì˜ ëª¨ë¸ì—ì„œëŠ”&lt;br&gt;
&lt;strong&gt;Key = Value = Encoder Hidden State&lt;/strong&gt;ë¡œ ê·¸ëƒ¥ ì¨ë²„ë¦° ê²ƒ!!Â &lt;/p&gt;
&lt;p&gt;Transformerì—ì„œëŠ” Key, ValueëŠ” hidden stateì— ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ marixë¥¼ ê³±í•œë‹¤.&lt;/p&gt;</description></item><item><title>Machine Translation (MT)ì˜ ë°œì „</title><link>https://juijeong8324.github.io/p/nlp/machine-translation-mt%EC%9D%98-%EB%B0%9C%EC%A0%84/</link><pubDate>Sat, 21 Jun 2025 18:13:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/machine-translation-mt%EC%9D%98-%EB%B0%9C%EC%A0%84/</guid><description>&lt;p&gt;sentence xë¥¼ source languageì—ì„œ target lanugeì¸ sentence yë¡œ ë²ˆì—­í•˜ëŠ” task&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@pGqje/btsOLcLteEK/AAAAAAAAAAAAAAAAAAAAAJ8N5fEEcNKATTcOrT6v8Z2T9AlfGSSn9AL_69fY9USs/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=eajn9PkUyAUTu8iHDsP0Rqep3SQ%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:575,&amp;ldquo;originHeight&amp;rdquo;:248,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h3 id="statistical-machine-translation"&gt;Statistical Machine TranslationÂ 
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Core Idea&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;dataë¡œë¶€í„° probabilistic modelì„ í•™ìŠµí•˜ì!!&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bshULM/btsOL9UEEqN/AAAAAAAAAAAAAAAAAAAAAIp1l1JOWvn-gSVfpn_N1HdbHlVlG2rHxsPH8wbZkC2g/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=rmHlRNvtGTV4s%2B%2BZPCEf9yo8ZuM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:710,&amp;ldquo;originHeight&amp;rdquo;:380,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;í”„ë‘ìŠ¤ì–´ sentence xê°€ ì£¼ì–´ì¡Œì„ ë•Œ, sentence yë¥¼ ì°¾ì•„ë³´ì!!!&lt;/p&gt;
&lt;p&gt;ì¦‰ 2ê°œì˜ componentë¡œ ê°ê° ë¶„ë¦¬í•´ì„œ í•™ìŠµì‹œí‚¨ë‹¤!Â &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Translation Model&lt;/strong&gt;wordë‚˜ phrasesë¥¼ ì–´ë–»ê²Œ ë²ˆì—­í•´ì•¼ í•˜ëŠ”ì§€ ëª¨ë¸ë§, parallel dataë¡œë¶€í„° í•™ìŠµë¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Language Model&lt;/strong&gt;&lt;br&gt;
ì¢‹ì€ Englishë¥¼ ì–´ë–»ê²Œ ì¨ì•¼ í•˜ëŠ”ì§€ ëª¨ë¸ë§, monologual dataë¡œë¶€í„° í•™ìŠµë¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ê·¸ëŸ¬ë‚˜&amp;hellip; ê·¹ë„ë¡œ ë³µì¡í•˜ê³  ì¤‘ìš”í•œ detailë“¤ì´ ë„ˆë¬´ ë§ë‹¤&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;ê°‘ìê¸°&amp;hellip;ë“±ì¥í•œ ê²ƒì´ ìˆìœ¼ë‹ˆ..&lt;/p&gt;
&lt;h3 id="neural-machine-translation-nmt"&gt;Neural Machine Translation (NMT)
&lt;/h3&gt;&lt;p&gt;êµ¬ê¸€ ë²ˆì—­ë„ ì›ë˜ SMT systemì´ì—ˆëŠ”ë°..! NMT systemìœ¼ë¡œ ë°”ë€Œë©´ì„œ ë¹ ë¥´ê²Œ ë°œì „ë¨!!&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@KztoA/btsOLjKAPJO/AAAAAAAAAAAAAAAAAAAAAKSVFfP_V1F1CGPM8qs4CtkTkr9qolVRwRl448JVY1b2/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=LYQiQbO%2BxDXQc%2BSMzU2ImHKugGo%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:748,&amp;ldquo;originHeight&amp;rdquo;:436,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:640,&amp;ldquo;height&amp;rdquo;:373}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;sequence-to-sequence model ì´ë‹¤!!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;**Encoder RNN&lt;br&gt;
**Encoder RNNì€ source sentenceì˜ encodingì„ ìƒì„±&lt;br&gt;
Encoding ê²°ê³¼ëŠ” Decoderì˜ ì´ˆê¸° hidden stateë¡œ ì œê³µÂ &lt;/li&gt;
&lt;li&gt;**Decoder RNN&lt;br&gt;
**encodingì„ ì¡°ê±´ìœ¼ë¡œ í•˜ì—¬ target sentenceë¥¼ ìƒì„±í•˜ëŠ” Language ModelÂ &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì¦‰ EncoderëŠ” inputì„ ì·¨í•˜ê³  neural representaionì„ ìƒì„±, DecoderëŠ” neural representationì„ ê¸°ë°˜ìœ¼ë¡œ outputì„ ìƒì„±&lt;/p&gt;
&lt;p&gt;ì´ëŠ” seq2seq model ì´ë¼ê³  ë¶€ë¥¸ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ë§ì€ NLP taskì—ì„œëŠ” seq-to-seqë¡œ í‘œí˜„ë  ìˆ˜ ìˆìŒ!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SummarizationÂ (longÂ textÂ â†’Â shortÂ text)&lt;/li&gt;
&lt;li&gt;Dialogue (previous utterances â†’ next utterance)&lt;/li&gt;
&lt;li&gt;Parsing (input text â†’ output parse as sequence)&lt;/li&gt;
&lt;li&gt;Code generation (natural language â†’ Python code)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="nmt"&gt;NMT
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@el1MRG/btsOLt0scSI/AAAAAAAAAAAAAAAAAAAAAPIidx9a-aWVJQotstRic7e-OxaafFnqpJygAm0-iGFH/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=aj7Nv2EZj29i%2B5XsCKiWclilJMs%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:654,&amp;ldquo;originHeight&amp;rdquo;:165,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;seq2seq ëª¨ë¸ì€ &lt;strong&gt;Conditional Laguage Model&lt;/strong&gt;ì˜ í•œ ì˜ˆì‹œì„!&lt;/p&gt;
&lt;p&gt;Language modelì¸ ì´ìœ ëŠ” decoderê°€ target sentece yì˜ ë‹¤ìŒ wordë¥¼ ì˜ˆì¸¡í•˜ê¸° ë•Œë¬¸ì´ê³ Â &lt;/p&gt;
&lt;p&gt;Conditionalì¸ ì´ìœ ëŠ” predctionì´ ì´ì „ ë‹¨ì–´ë“¤ì— ë”í•´ source senteceì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸!Â &lt;/p&gt;
&lt;h3 id="ì–´ë–»ê²Œ-train"&gt;ì–´ë–»ê²Œ train?
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@4Twsx/btsOMmM2cZG/AAAAAAAAAAAAAAAAAAAAAKAe9xc8Q4WOYWbkWdvIrtxE287Km-HlwKyzNev4TxfS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=oNJVT4MAY3sM9mEKBHnEseFO0mY%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:774,&amp;ldquo;originHeight&amp;rdquo;:453,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì¦‰ lossëŠ” decoderì—ì„œ ê³„ì‚°ë˜ê³ &amp;hellip; í•˜ë‚˜ì˜ systemdã…¡ë¡œì„œ end-to-endë¡œ Backpropagationí•¨!Â &lt;/p&gt;
&lt;h3 id="ë¬¸ì œì -issues-with-recurrent-models"&gt;ë¬¸ì œì : issues with recurrent models
&lt;/h3&gt;&lt;h4 id="linear-interaction-distance"&gt;Linear interaction distanceÂ 
&lt;/h4&gt;&lt;p&gt;O(sequence length) ë‹¨ê³„ì˜ ê±°ë¦¬ì˜ word pairsê°„ ìƒí˜¸ì‘ìš©í•œë‹¤ëŠ” ëœ»ì€&amp;hellip;&lt;/p&gt;
&lt;p&gt;ê¸´ ê±°ë¦¬ì˜ dependenciesì€ í•™ìŠµí•˜ê¸° ì–´ë µë‹¤..(grdient ì†Œì‹¤ ë¬¸ì œ ì—¬ì „íˆ&amp;hellip;)&lt;/p&gt;
&lt;p&gt;â†’ ì˜ˆ: &amp;ldquo;The &lt;strong&gt;dog&lt;/strong&gt; that chased the cat &lt;strong&gt;ran&lt;/strong&gt;&amp;rdquo; â†’ &amp;ldquo;dog&amp;quot;ê³¼ &amp;ldquo;ran&amp;quot;ì€ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìŒ&lt;/p&gt;
&lt;p&gt;RNNì€ ê·¸ëƒ¥ ì™¼ìª½ë¶€í„° ì˜¤ë¥¸ìª½ìœ¼ë¡œ í•˜ë‚˜ì”© ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë¬¸ì¥ êµ¬ì¡°ì— Linear orderê°€ ì¥ì œë¡œ ë°•í˜€ìˆë‹¤.&lt;/p&gt;
&lt;p&gt;ë¬¸ì¥ì„ ë‹¨ìˆœí•œ ìˆœì„œë¡œë§Œ ìƒê°í•´ì„œëŠ” ì•ˆ ëœë‹¤..!Â Â &lt;/p&gt;
&lt;p&gt;&amp;ldquo;The dog &lt;strong&gt;that chased the cat&lt;/strong&gt; ran away.&amp;rdquo;&lt;br&gt;
â†’ ì£¼ì–´ëŠ” &amp;ldquo;The dog&amp;rdquo;, ë™ì‚¬ëŠ” &amp;ldquo;ran&amp;rdquo;, ê·¼ë° ë‘˜ ì‚¬ì´ì— ê´€ê³„ ìˆëŠ” ë‹¨ì–´ë“¤ì´ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìŒ&lt;/p&gt;
&lt;p&gt;ì¦‰ ì´ë¥¼ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ëŠ” ëª¨ë¸ì€ êµ¬ë¬¸ êµ¬ì¡°ë‚˜ ì˜ë¯¸ ê´€ê³„ë¥¼ ì˜ íŒŒì•…í•˜ì§€ ëª»í•œë‹¤.Â &lt;/p&gt;
&lt;h4 id="lack-of-parallelizability"&gt;Lack of parallelizability
&lt;/h4&gt;&lt;p&gt;Unparallelizableí•˜ê²Œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— forwardì™€ backward ì—°ì‚°ì€Â  O(seq length)ë¥¼ ê°€ì§„ë‹¤.Â &lt;/p&gt;
&lt;p&gt;GPU ë³‘ë ¬ ì²˜ë¦¬ì— ì˜ ì•ˆ ë§ê³ ..(ì´ì „ hidden stateë¥¼ ê³„ì‚°í•´ì•¼ ë‹¤ìŒ hidden stateë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸!!)Â &lt;/p&gt;
&lt;p&gt;í° ë°ì´í„° í•™ìŠµì´ í˜ë“¤ë‹¤!!&lt;/p&gt;</description></item><item><title>Long Short-Term Memory (LSTM)</title><link>https://juijeong8324.github.io/p/nlp/long-short-term-memory-lstm/</link><pubDate>Sat, 21 Jun 2025 17:32:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/long-short-term-memory-lstm/</guid><description>&lt;p&gt;vanishing gradientsì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ì œì•ˆëœ RNNì˜ í•œ ì¢…ë¥˜ì„!&lt;/p&gt;
&lt;p&gt;ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬!&lt;/p&gt;
&lt;p&gt;get, cell ë“± ë‚´ë¶€ êµ¬ì¡°&lt;/p&gt;</description></item><item><title>Recurrent Neural Networks(RNN)</title><link>https://juijeong8324.github.io/p/nlp/recurrent-neural-networksrnn/</link><pubDate>Sat, 21 Jun 2025 16:53:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/recurrent-neural-networksrnn/</guid><description>&lt;h3 id="core-idea"&gt;Core Idea
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@cd3kQx/btsOL55YG2J/AAAAAAAAAAAAAAAAAAAAANYIGed86TNJRULXuEeGhsPDL1fSZKTEgFCyVcJT_nnM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=xtXMYU30gOU9Dw%2FwaYztfGNHw2E%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:620,&amp;ldquo;originHeight&amp;rdquo;:302,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê°™ì€ ê°€ì¤‘ì¹˜ Wë¥¼ ë°˜ë³µí•´ì„œ ì ìš©í•œë‹¤!!!!&lt;/p&gt;
&lt;p&gt;ê° ì…ë ¥ì— ëŒ€í•´ì„œ hidden stateì— ê°™ì€ Wë¥¼ ê³±í•œê²ƒì„ ê°™ì´ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. (ì´ì „ì—ëŠ” x1ì€ w1, x2ëŠ” w2ë‘ ê³±í•´ì ¸ì™”ìŒ)Â &lt;/p&gt;
&lt;h3 id="rnnì˜-ì „ì²´-êµ¬ì¡°"&gt;RNNì˜ ì „ì²´ êµ¬ì¡°Â 
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@nAlnd/btsOKCKGYh2/AAAAAAAAAAAAAAAAAAAAAI_fpqbVrSvAnP94hHCY_7jcCxy1K1hw80WqHlf7PRzI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=agopE1K1jweMPlppzIrc%2BVSfsUY%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:761,&amp;ldquo;originHeight&amp;rdquo;:525,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;h4 id="ì¥ì "&gt;ì¥ì 
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;ì–´ë–¤ ê¸¸ì´ì˜ inputì´ë“  ì²˜ë¦¬ ê°€ëŠ¥&lt;/li&gt;
&lt;li&gt;step tì— ëŒ€í•œ ê³„ì‚°ì€ ë§ì€ ë’¤ì˜ stepì˜ ì •ë³´ë¥¼ í™œìš©í•œë‹¤.(ì´ì „ ì •ë³´ë¥¼ í™œìš©í•œë‹¤!)Â &lt;/li&gt;
&lt;li&gt;input í¬ê¸°ì— ë”°ë¼ Model size(Wh, We)ê°€ ì¦ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤.Â &lt;/li&gt;
&lt;li&gt;ëª¨ë“  ì‹œê°„ step tì— ê°™ì€ Wë¥¼ ì ìš©í•˜ê¸° ë•Œë¬¸ì— ìœ„ì¹˜ì— ìƒê´€ì—†ì´ ê³µì •í•˜ê²Œ ì²˜ë¦¬ëœë‹¤.Â &lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ë‹¨ì "&gt;ë‹¨ì Â 
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Recurrent computationì´ ë„ˆë¬´ ëŠë ¤ -&amp;gt; ë³‘ë ¬ ì²˜ë¦¬ê°€ ì•ˆ ëœë‹¤!!Â &lt;/li&gt;
&lt;li&gt;ì™„ì „ ì´ì „ stepì˜ ì •ë³´ë¥¼ ì–»ëŠ”ê²Œ ì¢€ ì–´ë ¤ì›€&amp;hellip; -&amp;gt; ì •ë³´ ì†Œì‹¤ ë¬¸ì œ! (gradient vanishing)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="training"&gt;TrainingÂ 
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Input : ë‹¨ì–´ë“¤ì˜ sequence&lt;/li&gt;
&lt;li&gt;Ouput : ëª¨ë“  ê° step tì˜ distribution yt&lt;/li&gt;
&lt;li&gt;Loss : step tì— ëŒ€í•´ì„œ, ì˜ˆì¸¡ í™•ë¥  ë¶„í¬ ytì™€ ì§„ì§œ ë‹¤ìŒ ë‹¨ì–´ yt ê°„ì˜ cross-entoropy(ë¶ˆì¼ì¹˜ë¥¼ ì¸¡ì •í•˜ëŠ” í•¨ìˆ˜)ë¥¼ ê³„ì‚°Â &lt;/li&gt;
&lt;li&gt;ê·¸ Lossë¥¼ ëª¨ë‘ ë”í•´ì„œ í‰ê· ì„ ë‚¸ë‹¤.Â Â &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;* cross-entropy?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ì˜ˆì¸¡í•œ í™•ë¥  ë¶„í¬ytì™€ ì‹¤ì œ ì •ë‹µ(label)ì˜ ë¶„í¬ yt ì‚¬ì´ì˜ ë¶ˆì¼ì¹˜ë¥¼ ì¸¡ì •, ëª¨ë¸ì— í™•ì‹ ì„ ê°€ì§€ê³  ë§ì·„ëŠ”ì§€ë¥¼ í‰ê°€í•˜ëŠ” Loss í•¨ìˆ˜!Â &lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ ì •ë‹µì„ ë§ì¶°ë„ í™•ì‹ ì´ ì—†ìœ¼ë©´ Lossê°€ ì»¤ì§„ë‹¤&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bu6ZvL/btsOL8OXDOx/AAAAAAAAAAAAAAAAAAAAANYGFDr1VnpHth2STLiZISwfe_wqt8My-valyxnwKa7Y/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=OBFojuUdiS4Ro%2FJuzjm6fOXkAGA%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:616,&amp;ldquo;originHeight&amp;rdquo;:255,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##][##&lt;em&gt;Image|kage@qz5G4/btsOK40UBYS/AAAAAAAAAAAAAAAAAAAAAPgHM10-ONI6fduzzG8qC55ZS0yeKIB5r3a_e-eiFBq3/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=Ln447zxoSPmQ9%2B6wXoRP9D%2Fvt%2BM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:839,&amp;ldquo;originHeight&amp;rdquo;:522,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:681,&amp;ldquo;height&amp;rdquo;:424}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;1. x1ì´ ë“¤ì–´ì™€ì„œ y1ì„ ì˜ˆì¸¡&lt;/p&gt;
&lt;p&gt;2. ì´ë•Œ LossëŠ” ì‹¤ì œ trueê°’(y2) ì™€ì˜ nevative log probì„ ê³„ì‚°í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;3. time step të§ˆë‹¤ ê³„ì‚° í›„ì—Â &lt;/p&gt;
&lt;p&gt;4. Lossë¥¼ ê³„ì‚° í›„ í‰ê· Â &lt;/p&gt;
&lt;h3 id="ë¬¸ì œì "&gt;ë¬¸ì œì 
&lt;/h3&gt;&lt;p&gt;ì „ì²´ corpus(ë¬¸ì¥, document)ì— ëŒ€í•´ì„œ lossì™€ grandientë¥¼ í•œë²ˆì— ê³„ì‚°í•˜ëŠ” ê²ƒì€ ë„ˆë¬´ ë¹„ìŒˆ.. ë©”ëª¨ë¦¬ ë¬¸ì œ..Â &lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œÂ &lt;/p&gt;
&lt;p&gt;Stochastic Gradient Descent ê¸°ì–µí•˜ë‹ˆ??? ì´ëŸ¬í•œ ì‘ì€ data chunkì— ëŒ€í•´ì„œ lossì™€ gradientë¥¼ ê³„ì‚°í•˜ê³  update..&lt;/p&gt;
&lt;p&gt;ì´ê±¸ ì ìš©í•´ë³´ê² ë‹¤&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œ í•œ ë¬¸ì¥ì— ëŒ€í•´ì„œ lossë¥¼ ê³„ì‚°í•˜ê³ (ì›ë˜ëŠ” ì—¬ëŸ¬ ë¬¸ì¥ batchì— ëŒ€í•´ì„œ ê³„ì‚°í–ˆì—ˆìŒ) graeidntë‘ weightë¥¼ ì—…ë°ì´íŠ¸ í•´ì„œ.. ì´ì œ ë‹¤ë¥¸ ìƒˆë¡œìš´ í•œ ë¬¸ì¥ì— ëŒ€í•´ì„œ ë°˜ë³µí•œë‹¤~Â Â &lt;/p&gt;
&lt;h3 id="backpropagation-for-rnns-w-parameterë¥¼-í›ˆë ¨-ì‹œí‚¤ê¸°-ìœ„í•¨"&gt;Backpropagation for RNNs (W parameterë¥¼ í›ˆë ¨ ì‹œí‚¤ê¸° ìœ„í•¨!)Â 
&lt;/h3&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@mg3iq/btsOK3gBiFm/AAAAAAAAAAAAAAAAAAAAAOoIiVeMS4EAFLxLbEQdFCnjBPX6LasLXf1C3cmF95GE/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=pAazc3X5vbWcsh65DO1koqUo68s%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:756,&amp;ldquo;originHeight&amp;rdquo;:419,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:612,&amp;ldquo;height&amp;rdquo;:339}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê°€ì¤‘ì¹˜ matrix Whì— ëŒ€í•´ì„œ Jtì˜ ë¯¸ë¶„ì€ ë¬´ì—‡ì¸ê°€?Â &lt;/p&gt;
&lt;p&gt;ì—¬ëŸ¬ ìœ„ì¹˜ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ëœ ê°™ì€ ê°€ì¤‘ì¹˜ì— ëŒ€í•œ gradientëŠ” ê°ê°ì˜ ì‚¬ìš© ìœ„ì¹˜ì—ì„œ ë‚˜ì˜¨ gradientë“¤ì„ ëª¨ë‘ ë”í•œê²ƒ!Â &lt;/p&gt;
&lt;p&gt;ì¦‰, ê° timestepì—ì„œ lossì— ê¸°ì—¬í•œ Wì— gradientê°€ ë”°ë¡œ ìƒê¹€! ì´ Wì— ëŒ€í•´ ì—…ë°ì´íŠ¸ í•˜ë ¤ë©´ ëª¨ë“  timestepì—ì„œ ë‚˜ì˜¨ gradientë¥¼ í•œë²ˆì— ë”í•´ì•¼í•´!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@3lKBN/btsOLfnQEAb/AAAAAAAAAAAAAAAAAAAAAPjbKuP46Dg-E-VCUPX_CFF7mHCsyRNM6Q1Is8H4ZAvF/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=u%2BO2hvqDSwJXiSFX%2Bq0GuR%2FeUeU%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:872,&amp;ldquo;originHeight&amp;rdquo;:459,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;timestepë¥¼ ë”°ë¼ ê±°ê¾¸ë¡œ ì—­ì „íŒŒí•˜ë©´ì„œ(t, t-1, .. 0) ê° ì‹œì ë§ˆë‹¤ì˜ gradientë¥¼ ê³„ì‚°í•´ì„œ ì „ë¶€ ë”í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ backpropatgation through time (BPTT)Â &lt;/p&gt;
&lt;p&gt;ê·¸ë‹ˆê¹Œ ì‹œê°„ì„ ê±°ê¾¸ë¡œ ëŒë©´ì„œ&amp;hellip;! ê³„ì‚°í•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;ë§ˆì¹˜ n-gram LMê°™ìŒ! ë°˜ë³µë˜ëŠ” samplingì„ í†µí•´ì„œ textë¥¼ ìƒì„±í•˜ëŠ”~~&lt;/p&gt;
&lt;h3 id="problems-with-rnns-vanishing-and-exploding-gradients"&gt;Problems with RNNs: Vanishing and Exploding Gradients
&lt;/h3&gt;&lt;p&gt;ê·¸ëŸ¬ë©´ ì´ì œ ê° timestep tì— ëŒ€í•´ì„œ Whì— ëŒ€í•œ J4ì˜ gradientë¥¼ ê³„ì‚°í•´ì•¼ í•¨!Â &lt;/p&gt;
&lt;p&gt;ì´ë•Œ ì‹œì ì´ 1ì¼ ë•Œ J4/Wh&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@c6Mtp5/btsOMqIBmyj/AAAAAAAAAAAAAAAAAAAAAKBM8pAVxyGZw73TMjsAJ0pmdqhp4Zt-xEYITKJG6djN/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=3BiU%2FM%2BvC7sZD6aur%2BHCTsfdFps%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:595,&amp;ldquo;originHeight&amp;rdquo;:350,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ê°€ 4ë²ˆì§¸ Lossë¥¼ ê³„ì‚°í•˜ê³  ì´ê²ƒì„ ì²« ë²ˆì§¸ W(hidden state)ì— ëŒ€í•œ ê°€ì¤‘ì¹˜ë¥¼ ê³„ì‚°í•´ì•¼ í•¨!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@c41Eec/btsOKq4vd6Y/AAAAAAAAAAAAAAAAAAAAAJdDrLhfcBcbPxKpllFz0izw43toU0HB8hVXWQxP56yA/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=e7hJ%2BvM10%2FBDDhCsVZL1ldD2sT0%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:799,&amp;ldquo;originHeight&amp;rdquo;:511,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:458,&amp;ldquo;height&amp;rdquo;:293}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì´ë¥¼ ìœ„í•´ì„œëŠ” chain ruleì— ë”°ë¼ ìœ„ì™€ ê°™ì´ ê³„ì‚°ëœë‹¤..Â &lt;/p&gt;
&lt;p&gt;ê·¸ëŸ°ë°&amp;hellip; ê³±í•´ì§€ëŠ” ì € ê°’ë“¤ì´ ì‘ìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‹ˆ?Â &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Vanishing gradient problem&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;backpropagationì´ ë” ë©€ë¦¬ ì§„í–‰ë  ìˆ˜ë¡ gradient signalì´ ë” ì‘ì´ì§€ê³  ì‘ì•„ì§€ëŠ” í˜„ìƒ&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@cSSAqq/btsOLwJyfLB/AAAAAAAAAAAAAAAAAAAAANx0D3CcClzEqW80cTkfeIK2NffZKwAtp-HYRQzx45o5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=MM5pOJ%2Fsdg7lqRrGlRThWq9NhhQ%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:770,&amp;ldquo;originHeight&amp;rdquo;:409,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë‹ˆê¹Œ&amp;hellip; ht í•¨ìˆ˜ì—ëŠ” wh ë¼ëŠ” ìš°ë¦¬ê°€ ê³„ì‚°í•´ì•¼ í•  ê°€ì¤‘ì¹˜ê°€ ìˆê³  ë˜ ê·¸ ì•ˆì˜ ht-1 í•¨ìˆ˜ì—ëŠ” ìš°ë¦¬ê°€ ê³„ì‚°í•´ì•¼ í•  ê°€ì¤‘ì¹˜ê°€ ìˆë‹¤. chainìœ¼ë¡œ ê³±ì±„ì§€ëŠ”ë°&amp;hellip; ê³±í•´ì§€ëŠ” ê°’ì´ ì‘ì€ ìˆ˜ë©´.. ì‘ì€ ìˆ˜ ë¼ë¦¬ ê³„ì† ê³±í•´ì§„ë‹¤&amp;hellip; ë”°ë¼ì„œ ì§€ìˆ˜ì ìœ¼ë¡œ ì‘ì•„ì§„ë‹¤ëŠ” ë¬¸ì œê°€ ë°œìƒ&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@UOpMn/btsOLdDCn8y/AAAAAAAAAAAAAAAAAAAAAJ1SE3Q95f-Db_u_s_neu4yQdaqc7_iRYuoKmdU0ES1p/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=pPPO1mCmNROOkzinLjcn9Q5Z7Bs%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:916,&amp;ldquo;originHeight&amp;rdquo;:455,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œ ë¬¸ì œëŠ”&amp;hellip; backpropagationì„ í•  ë•Œ timestepì´ ì˜¬ë¼ê°ˆ ìˆ˜ë¡ ì ì  ê·¸ ê°’ì´ ì‘ì•„ì ¸ì„œ .. ë‚˜ë‘ ê°€ê¹Œìš´ ì‹œì ì˜ gradientëŠ” í¬ê³  ë‚˜ë‘ ë¨¼ ì‹œì ì˜ gradientëŠ” ê¸°ì–µí•˜ì§€ ëª»í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ì¦‰, ì§§ì€ ê¸°ì–µë§Œ ê°€ëŠ¥í•˜ë‹¤!!! ê¸´ ë¬¸ì¥ ì²˜ë¦¬ ëª» í•¨!!Â &lt;/p&gt;
&lt;p&gt;ì¦‰ ì–´ë–¤ t ì‹œì ì˜ Lossì™€ Wë¥¼ ê³„ì‚°í•˜ë ¤ë©´ i ì‹œì ì˜ gradient ì¦‰, Loss t / hië¥¼ ê³„ì‚°í•´ì•¼ í•˜ê³  ì´ë•Œ iê°€ të³´ë‹¤ ë„ˆë¬´ ë©€ë©´ ì•„ì˜ˆ ê°’ì´ ì‘ì•„ì ¸ì„œ ì˜í–¥ì„ ëª» ì¤€ë‹¤ëŠ” ê±°êµ¬ë‚˜!!!&lt;/p&gt;
&lt;p&gt;ê·¸ë˜ì„œ&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;ê¸´ ë¬¸ì¥ì´ ì£¼ì–´ì§€ê³  ë¹ˆì¹¸ì„ ì£¼ì–´ì§€ëŠ” ë¬¸ì œë¥¼ ë§ì¶œ ë•Œ&amp;hellip;!Â &lt;/p&gt;
&lt;p&gt;WhenÂ sheÂ triedÂ toÂ printÂ herÂ tickets,Â sheÂ foundÂ thatÂ theÂ printerÂ wasÂ outÂ ofÂ toner.Â SheÂ wentÂ toÂ theÂ stationeryÂ storeÂ toÂ buyÂ moreÂ toner.Â ItÂ wasÂ veryÂ overpriced.Â AfterÂ installingÂ theÂ tonerÂ intoÂ theÂ printer,Â sheÂ finallyÂ printedÂ herÂ ________&lt;/p&gt;
&lt;p&gt;ì—¬ê¸°ì„œ ë‹µì€ ticket ì¦‰, ë§¨ ì•ì˜ 7ë²ˆì§¸ ë‹¨ì–´ë¥¼ ë³´ê³  ë§ì¶°ì•¼ í•˜ëŠ”ë°.. ë„ˆë¬´ ë©€ì–´ì„œ vanishing ë˜ê¸° ë•Œë¬¸ì—.. ëª» ë§ì¶¤..Â &lt;/p&gt;
&lt;p&gt;exploding ë¬¸ì œëŠ” ê±.. ì•„ì˜ˆ ë‹¤ë¥¸ ê°’ì´ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤ëŠ” ëœ»!!! NaN&lt;/p&gt;
&lt;p&gt;ì´ ë¬¸ì œëŠ”Â &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Gradientê°€ ì¼ì • thresholdë³´ë‹¤ í¬ë©´ ì˜ë¼ì£¼ëŠ” ì‘ì—…ì„ í•˜ê²Œ ë¨! clipping!!&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="vanishing-ë¬¸ì œë¥¼-ì–´ë–»ê²Œ-í•´ê²°í•´ì•¼-í• ê¹Œ"&gt;Vanishing ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•´ì•¼ í• ê¹Œ?Â 
&lt;/h3&gt;&lt;p&gt;1. &lt;strong&gt;ê¸°ì–µì„ ë”°ë¡œ ë³´ê´€í•˜ê³  ë”í•´ê°€ëŠ” RNNì€ ì–´ë•Œ?&lt;/strong&gt;&amp;quot;&lt;/p&gt;
&lt;p&gt;-&amp;gt; LSTM&lt;/p&gt;
&lt;p&gt;2. &lt;strong&gt;ì •ë³´ê°€ ë” ì§ì ‘ì ìœ¼ë¡œ í˜ëŸ¬ê°€ê²Œ (linear pass-through)&lt;/strong&gt; í•˜ëŠ” êµ¬ì¡°&lt;/p&gt;
&lt;p&gt;-&amp;gt; &lt;strong&gt;Attention&lt;/strong&gt;ì´ë‚˜ &lt;strong&gt;Residual Connection&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id="ì¶”ê°€-ì§ˆë¬¸"&gt;ì¶”ê°€ ì§ˆë¬¸
&lt;/h3&gt;&lt;p&gt;Q. ì—¬ê¸°ì„œ embeddingì€ word2vectorì™€ ê°™ì€ pretrained embedding modelì„ í†µí•´ ë¥¼ í†µí•´ì„œ embedding ë˜ëŠ”ê±´ê°€?&lt;/p&gt;
&lt;p&gt;No! ê·¸ëƒ¥ ê°€ì¤‘ì¹˜ Wì— ì˜í•´ vectorí™” í•´ì£¼ëŠ”ê±°ê³  pretraining ë‹¨ê³„ì—ì„œ embeddingì€ ìë™ìœ¼ë¡œ í•¨ê»˜ í•™ìŠµëœë‹¤. (ì¦‰ end-to-endë¡œ ê°™ì´ í•™ìŠµ)Â &lt;/p&gt;
&lt;p&gt;Q. RNNì€ LMì¸ê°€?&lt;/p&gt;
&lt;p&gt;ì•„ë‹˜!! RNNì€ ëª¨ë¸ ì•„í‚¤í…ì³ì´ê³  LMì€ í•™ìŠµ ëª©ì ì´ì Task!!!Â &lt;/p&gt;
&lt;p&gt;ì¦‰ RNNì€ ì‹œí€€ìŠ¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì‹ ê²½ë§ êµ¬ì¡°ì´ê³ Â &lt;/p&gt;
&lt;p&gt;LMì€ í…ìŠ¤íŠ¸ì—ì„œ ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡ ê°™ì€ Taskë¥¼ ìˆ˜í–‰í•˜ëŠ” ëª¨ë¸Â &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ë„ˆëŠ” &lt;strong&gt;RNNì„ ì¨ì„œ Language Modelì„ ë§Œë“¤ ìˆ˜ ìˆì–´&lt;/strong&gt;&lt;br&gt;
â†’ ì˜ˆ: RNN-based Language Model (2015ë…„ ì´ì „ì— ë§ì´ ì‚¬ìš©)&lt;/li&gt;
&lt;li&gt;í•˜ì§€ë§Œ &lt;strong&gt;RNNì´ í•­ìƒ Language Modelì„ ì˜ë¯¸í•˜ëŠ” ê±´ ì•„ë‹ˆì•¼&lt;/strong&gt;&lt;br&gt;
â†’ ì˜ˆ: RNNìœ¼ë¡œ ìŒì•… ìƒì„±, ì‹œê³„ì—´ ì˜ˆì¸¡, ë²ˆì—­ ë“± &lt;strong&gt;ë¹„-LM task&lt;/strong&gt;ë„ ê°€ëŠ¥í•¨&lt;/li&gt;
&lt;li&gt;ê·¸ë¦¬ê³  &lt;strong&gt;Language Modelì´ ê¼­ RNNì„ ì¨ì•¼ í•˜ëŠ” ê²ƒë„ ì•„ëƒ&lt;/strong&gt;&lt;br&gt;
â†’ GPT ê°™ì€ ëª¨ë¸ì€ &lt;strong&gt;Transformer ê¸°ë°˜ LM&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Language Modeling</title><link>https://juijeong8324.github.io/p/nlp/language-modeling/</link><pubDate>Sat, 21 Jun 2025 14:10:00 +0900</pubDate><guid>https://juijeong8324.github.io/p/nlp/language-modeling/</guid><description>&lt;h2 id="language-modelingì˜-ì •ì˜"&gt;Language Modelingì˜ ì •ì˜Â Â 
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;ë‹¤ìŒì— ì˜¬ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” taskë¥¼ ìˆ˜í–‰í•œë‹¤&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;EX) the students opened their ____ -&amp;gt; (books, laptops, exams, minds)&lt;/p&gt;
&lt;p&gt;&lt;em&gt;ì£¼ì–´ì§„ ë‹¨ì–´ë“¤ì˜ sequence(== ë¬¸ì¥)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;x1, x2, ,,,, xt&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;ë‹¤ìŒ ë‹¨ì–´ xt+1ì˜ probability distributionë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒ&lt;/em&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;em&gt;x+1ì€ vocabulary V= {w1, &amp;hellip; , wV}ì˜ ì•„ë¬´ ë‹¨ì–´ë¥¼ ì˜ë¯¸í•œë‹¤.&lt;/em&gt;Â &lt;/p&gt;
&lt;p&gt;&lt;em&gt;ìœ„ì™€ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ Language Modelì´ë‹¤.&lt;/em&gt;Â &lt;/p&gt;
&lt;p&gt;ì‰½ê²Œ ìƒê°í•´ì„œ ë‹¨ë” ì¡°ê°ì˜ probabiltiyë¥¼ í• ë‹¹í•´ì£¼ëŠ” systemì´ë¼ê³  ìƒê°í•˜ì!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@bEu4UG/btsOMbx4VHd/AAAAAAAAAAAAAAAAAAAAALAuedCmtWhEmgVvyRDKLlYNoK0C_VgaLV7x_pUgvez8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=c1L%2Ft7T%2BP3fKyowIDA7ity6N4xU%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:628,&amp;ldquo;originHeight&amp;rdquo;:179,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë‹ˆê¹Œ ì¦‰, ì–´ë–¤ ë¬¸ì¥ì´ ìƒì„±ë˜ê¸° ìœ„í•´ì„œëŠ” ì²« ë²ˆì§¸ ë‹¨ì–´ê°€ ì˜¬ í™•ë¥  x ì²« ë²ˆì§¸ ë‹¨ì–´ê°€ ìˆì„ ë•Œ 2ë²ˆì§¸ ë‹¨ì–´ê°€ ì˜¬ í™•ë¥  x &amp;hellip;&lt;/p&gt;
&lt;p&gt;ì‰½ê²Œ ìƒê°í•˜ë©´ inputì€ ê·¸ë™ì•ˆ ìƒì„±í•œ ê¸€ì˜ í™•ë¥ , outputì€ ê·¸ ê¸€ì˜ ë‹¤ìŒ ë‹¨ì–´ì˜ í™•ë¥ Â &lt;/p&gt;
&lt;h2 id="language-modelingì„-ì™œ-ì‹ ê²½ì¨ì•¼-í• ê¹Œ"&gt;Language Modelingì„ ì™œ ì‹ ê²½ì¨ì•¼ í• ê¹Œ?Â 
&lt;/h2&gt;&lt;p&gt;Language ModelingëŠ” &lt;strong&gt;benchmark task&lt;/strong&gt;ì´ë‹¤!&lt;/p&gt;
&lt;p&gt;ì´ëŠ” ìš°ë¦¬ì˜ progressê°€ ì˜ ì˜ˆì¸¡í•˜ëŠ”ì§€ ì¸¡ì •í•˜ëŠ”ë° ë„ì›€ì´ ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;ë˜í•œ ë§ì€ NLP(Natural Language Process)ì˜ subcomponentë¼ê³  ë³´ë©´ ëœë‹¤.&lt;/p&gt;
&lt;p&gt;ì™œëƒí•˜ë©´ &lt;strong&gt;text ìƒì„± ì´ë‚˜ textì˜ í™•ë¥ ì„ ì˜ˆì¸¡&lt;/strong&gt;í•˜ëŠ” ì¼ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤ã….Â &lt;/p&gt;
&lt;p&gt;â€¢Â  Predictive typing&lt;br&gt;
â€¢ Speech recognition&lt;br&gt;
â€¢ Handwriting recognition&lt;br&gt;
â€¢ Spelling/grammar correction&lt;br&gt;
â€¢ Authorship identification&lt;br&gt;
â€¢ Machine translation&lt;br&gt;
â€¢ Summarization&lt;br&gt;
â€¢ Dialogue&lt;/p&gt;
&lt;p&gt;ê²°ë¡ &lt;/p&gt;
&lt;p&gt;NLPì˜ ëª¨ë“  ê¸°ìˆ ì€ LMì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì‹œ ì„¤ê³„ëœ ê²ƒ.&lt;/p&gt;
&lt;p&gt;ì˜›ë‚ ì—ëŠ” NLP ê° taskë§ˆë‹¤ modelì´ ë”°ë¡œ ì¡´ì¬(ê°ì • ë¶„ì„: SVM, ë²ˆì—­: RNN, ìš”ì•½ Seq2Seq&amp;hellip;)&lt;/p&gt;
&lt;p&gt;ìš”ì¦˜ì€ ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸(GPT, Bert) í•˜ë‚˜ë¡œ ëª¨ë“  ê±¸ í•´ê²°!Â &lt;/p&gt;
&lt;h2 id="next-word-prediction"&gt;Next word predictionÂ 
&lt;/h2&gt;&lt;p&gt;[##&lt;em&gt;Image|kage@B880X/btsOK56w4m9/AAAAAAAAAAAAAAAAAAAAAGi7MTKKVksaHyg8oGF0rKmbkx07-XeOS6WYhS79W1rJ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=ZvaUY0HkP726Ec1gIbbi2I5wAXM%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:876,&amp;ldquo;originHeight&amp;rdquo;:272,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:699,&amp;ldquo;height&amp;rdquo;:217}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì´ëŸ°ì‹ìœ¼ë¡œ ë¬¸ì¥ ì•ˆì˜ blankë¥¼ ë‘ì–´ì„œ ì˜ˆì¸¡ì„ í•˜ë„ë¡ í•™ìŠµì‹œì¼°ë‹¤ë©´&amp;hellip;Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@brGrYk/btsOMbrhW2U/AAAAAAAAAAAAAAAAAAAAAJVZ7cxHL1j8l05ObJ55ytt-g0YBZVYRgco6NaEaiMlP/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=I736lUxcPUJPfuxX3GzgIH38w3U%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:768,&amp;ldquo;originHeight&amp;rdquo;:364,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;,&amp;ldquo;width&amp;rdquo;:684,&amp;ldquo;height&amp;rdquo;:324,&amp;ldquo;caption&amp;rdquo;:&amp;ldquo;Contextì™€ example í•˜ë‚˜ë¥¼ ë³´ì—¬ì£¼ê³  ì§ˆë¬¸ì— ë‹µì„ í•˜ê²Œ í•œë‹¤.&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ìš”ì¦˜ì€ ì´ë ‡ê²Œ GPT ê°™ì€ ëª¨ë¸ë“¤ì´ &lt;strong&gt;in-context learning&lt;/strong&gt; ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;ì¦‰, ëª‡ ê°œì˜ exampleì„ ì£¼ì–´ì§€ë©´ ê·¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;fine-tuning(í›ˆë ¨)í•˜ì§€ ì•Šê³  propmt ìƒì—ì„œ example ëª‡ ê°œ(í•œ ê°œ í˜¹ì€ ê·¸ ì´ìƒ)ë§Œ ë³´ì—¬ì£¼ì–´ì„œ ìƒˆë¡œìš´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.Â &lt;/p&gt;
&lt;h2 id="ì˜ˆì „ì—ëŠ”-ì–´ë–»ê²Œ-language-modelì„-í•™ìŠµì‹œì¼°ì„ê¹Œ"&gt;ì˜ˆì „ì—ëŠ” ì–´ë–»ê²Œ Language Modelì„ í•™ìŠµì‹œì¼°ì„ê¹Œ?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;n-gram Language Model!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Markov assumption&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;í˜„ì¬ ìƒíƒœëŠ” ì˜¤ì§ ì§ì „ ìƒíƒœì— ì˜ì¡´í•œë‹¤. ê³¼ê±°ì˜ ëª¨ë“  ì •ë³´ëŠ” ì§ì „ ìƒíƒœ(nì´ë©´ n-1ê°œê¹Œì§€ì˜ ê³¼ê±°)ì— ìš”ì•½ë˜ì–´ ìˆë‹¤!Â &lt;/p&gt;
&lt;p&gt;ìì—°ì–´ ì²˜ë¦¬ì—ì„œëŠ”&amp;hellip;Â  Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@buCTf6/btsOLCCYRPY/AAAAAAAAAAAAAAAAAAAAAEJfukJ_v1O9xuY3QzTuz7i_7f-TsttY1Bv7BWikBI8k/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=xhloXgei4u44u82gqR%2B99W%2FZtIk%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:762,&amp;ldquo;originHeight&amp;rdquo;:114,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;xt+1(í˜„ì¬ ë‹¨ì–´)ì€ ì´ì „ì˜ n-1 ê°œì˜ ë‹¨ì–´ì—(ê³¼ê±°ì˜ ì •ë³´) ì˜ì¡´í•œë‹¤.&lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@cpa9dj/btsOKBkD6Gh/AAAAAAAAAAAAAAAAAAAAAE1v60qR30vxs8aj35g8PCBZX72lX-Cy40UCZ6SEp8ps/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=qIY0LUvEpKo1VTag8E7SzXTM%2Feo%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:614,&amp;ldquo;originHeight&amp;rdquo;:187,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ë§Œì•½ 4-gram Language Modelì´ë¼ê³  í•˜ë©´ 3ê°œì˜ ë‹¨ì–´ë¥¼ í™•ì¸Â &lt;/p&gt;
&lt;p&gt;ì´ë¥¼ ì§ì ‘ statistical approximation í•˜ê²Œ count í•œë‹¤.Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@MjTJo/btsOLvqmrvI/AAAAAAAAAAAAAAAAAAAAAPGTzzs7bDTPGiHL-aOJuJUES5godmZjlxljy8xrcZvy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=9ArLFBmwn2JsNsaf4ukucZ4IMwA%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:730,&amp;ldquo;originHeight&amp;rdquo;:202,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì¦‰ corpusì—ì„œ 3ê°œì˜ ë‹¨ì–´ê°€ 1000ê°œ ë‚˜ì™”ì„ ë•Œ ë‹¤ìŒ ë‹¨ì–´ë¥¼ countí•´ì„œ í•™ìŠµÂ &lt;/p&gt;
&lt;p&gt;í•˜ì§€ë§Œ proctor ë¼ëŠ” context(ë¬¸ë§¥)ì„ ì•„ì˜ˆ ë¬´ì‹œí•´ë„ ë ê¹Œ??&lt;/p&gt;
&lt;h3 id="ë¬¸ì œ-1"&gt;ë¬¸ì œ 1
&lt;/h3&gt;&lt;p&gt;ë§Œì•½ dataì— &amp;ldquo;students opened their w&amp;rdquo; ì´ ì•„ì˜ˆ ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©´?Â &lt;/p&gt;
&lt;p&gt;-&amp;gt; ì‘ì€ ì…ì‹¤ë¡ ì„ ì¶”ê°€í•´ì¤€ë‹¤.Â &lt;/p&gt;
&lt;h3 id="ë¬¸ì œ-2"&gt;ë¬¸ì œ 2
&lt;/h3&gt;&lt;p&gt;&amp;ldquo;students opened their&amp;rdquo; ê°€ ì•„ì˜ˆ ì—†ìœ¼ë©´?&lt;/p&gt;
&lt;p&gt;-&amp;gt; backoffë¡œ &amp;ldquo;opened their&amp;rdquo; ë¡œ ëŒ€ì‹ í•´ë¼!Â Â &lt;/p&gt;
&lt;h3 id="ë¬¸ì œ-3"&gt;ë¬¸ì œ 3
&lt;/h3&gt;&lt;p&gt;ê·¸ë¦¬ê³  ê·¸ ëª¨ë“  í™•ë¥ ì„ ë‹¤ count í•´ì•¼ í•˜ëŠ”ë°..?Â &lt;/p&gt;
&lt;p&gt;-&amp;gt; storage ë¬¸ì œ ë°œìƒÂ &lt;/p&gt;
&lt;p&gt;ì‚¬ì‹¤ n=5ì´ìƒì´ë©´ ë¬¸ì œê°€ ë°œìƒí•´ì„œ&amp;hellip; ì˜ ì•ˆ ì“´ë‹¤.Â &lt;/p&gt;
&lt;p&gt;ê·¼ë°&amp;hellip;&lt;/p&gt;
&lt;p&gt;incohrentí•˜ë‹¤!! ì¦‰ ì•ë’¤ê°€ ì•ˆ ë§ëŠ” ë¬¸ì¥ì´ ìƒì„±ëœë‹¤.Â &lt;/p&gt;
&lt;p&gt;ì ì–´ë„ 3ê°œ ì´ìƒì˜ ë‹¨ì–´ë¥¼ ê³ ë ¤í•´ì•¼ í•˜ëŠ”ë°&amp;hellip; nì´ ì»¤ì§€ë©´ ìœ„ì™€ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•˜ê³ &amp;hellip; ì–´ëœ©í•˜ì§€Â &lt;/p&gt;
&lt;h2 id="neural-language-model"&gt;Neural Language Model?Â 
&lt;/h2&gt;&lt;p&gt;ì¦‰ í™•ë¥ ì„ ëª¨ë¸ë§í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼&amp;hellip; Deep Learning(ì‹ ê²½ë§)ì„ ì´ìš©í•´ì„œ í™•ë¥ ì„ ëª¨ë¸ë§í•˜ì!Â &lt;/p&gt;
&lt;p&gt;[##&lt;em&gt;Image|kage@UZADO/btsOKDicr3a/AAAAAAAAAAAAAAAAAAAAAKs73WHd8Jz4kU62qvLWkSTEREbXI-zd3iVBIIyhRW8t/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;amp;expires=1761922799&amp;amp;allow_ip=&amp;amp;allow_referer=&amp;amp;signature=bLSWe3euV220bNV8vjgc99woGa4%3D|CDM|1.3|{&amp;ldquo;originWidth&amp;rdquo;:721,&amp;ldquo;originHeight&amp;rdquo;:495,&amp;ldquo;style&amp;rdquo;:&amp;ldquo;alignCenter&amp;rdquo;}&lt;/em&gt;##]&lt;/p&gt;
&lt;p&gt;ì¦‰ ìœ„ì™€ ê°™ì´ vectorë¥¼ ë§Œë“¤ì–´ì„œ embeddingì„ í•´ì£¼ê³  hidden layerë¥¼ í†µí•´ ê³„ì‚°.Â &lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ n-gram LMì˜ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤!Â &lt;/p&gt;
&lt;p&gt;ê´€ì°°ë˜ì–´ì•¼ í•  n-gramì„ ëª¨ë‘ ì €ì¥í•  í•„ìš”ê°€ ì—†ê³ Â &lt;/p&gt;
&lt;p&gt;ì •ë³´ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì•„ë‹Œì§€ë„ ë¬¸ì œ (sparsity problem) ë„ ì—†ì–´ì§„ë‹¤!&lt;/p&gt;
&lt;p&gt;ê·¸ëŸ¬ë‚˜&amp;hellip; ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ê°€ ì¡´ì¬í•˜ëŠ”ë°&amp;hellip;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fixed windowë„ ë„ˆë¬´ ì‘ë‹¤.Â &lt;/li&gt;
&lt;li&gt;window sizeë¥¼ í‚¤ìš°ë©´ W(ê°€ì¤‘ì¹˜)ë„ ë” ì»¤ì§„ë‹¤!!!&lt;/li&gt;
&lt;li&gt;ì¦‰, ë§¤ìš° ê¸´ sequnceë¥¼ ì´í•´í•  ìˆ˜ ì—†ë‹¤!! (ë¬¸ì¥ ì•ë¶€ë¶„ì˜ ê°œë…ì´ ë’·ë¶€ë¶„ í•´ì„ì— ì¤‘ìš”í•  ìˆ˜ë„ ìˆìœ¼ë‹ˆ!)&lt;/li&gt;
&lt;li&gt;x1ê³¼ x2ëŠ” ê³±í•´ì§€ëŠ” ê°€ì¤‘ì¹˜ê°€ ë‹¤ë¥´ë‹¤! (ì¦‰, ì…ë ¥ ìœ„ì¹˜ì— ë”°ë¼ ì²˜ë¦¬ ë°©ì‹ì´ ë‹¬ë¼ì§„ë‹¤) ì´ëŸ° ê²½ìš° ì…ë ¥ ìœ„ì¹˜ê°€ ë‹¤ë¥´ë©´ ê°™ì€ ë‹¨ì–´ë¼ë„ ë‹¤ë¥´ê²Œ ì²˜ë¦¬ë  ìˆ˜ë„..(ì¦‰ dogë¼ëŠ” ì˜ë¯¸ëŠ” ì•ì´ë“  ë’¤ì´ë“  ê°™ì•„ì•¼ í•¨!!)Â &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì–´ë–¤ ê¸¸ì´ì˜ inputì´ë“  ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” neural architectureê°€ í•„ìš”í•˜ë‹¤!!!Â &lt;/p&gt;
&lt;p&gt;ì´ì œ&amp;hellip; RNN ì„ ë°°ìš¸ ë•Œë‹¤!!&lt;/p&gt;</description></item></channel></rss>