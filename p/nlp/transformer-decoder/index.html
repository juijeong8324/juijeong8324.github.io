<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."><title>Transformer - Decoder</title><link rel=canonical href=https://juijeong8324.github.io/p/nlp/transformer-decoder/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Transformer - Decoder"><meta property='og:description' content="ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."><meta property='og:url' content='https://juijeong8324.github.io/p/nlp/transformer-decoder/'><meta property='og:site_name' content="DDubi's World"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='NLP'><meta property='article:tag' content='Deep Learning'><meta property='article:published_time' content='2025-06-22T00:34:00+09:00'><meta property='article:modified_time' content='2025-06-22T00:34:00+09:00'><meta name=twitter:title content="Transformer - Decoder"><meta name=twitter:description content="ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="ë©”ë‰´ ì—¬ë‹«ê¸°">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_e94bd0a766f2d89e.jpeg width=300 height=235 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>DDubi's World</a></h1><h2 class=site-description>Hello World!</h2></div></header><ol class=menu-social><li><a href=https://github.com/juijeong8324 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>ë‹¤í¬ ëª¨ë“œ</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ëª©ì°¨</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#transformer-decoder>Transformer Decoder</a><ol><li><a href=#1-multi-head-attention><strong>1. Multi-head Attention</strong></a></li><li><a href=#2-residual-connections><strong>2. Residual Connections</strong></a></li><li><a href=#3-layernormalization><strong>3. LayerÂ normalization</strong></a></li></ol></li><li><a href=#ì§œì”><strong>ì§œì”!</strong></a><ol><li><a href=#ê¶ê¸ˆí•œ-ê²ƒ><strong>ê¶ê¸ˆí•œ ê²ƒ!!</strong></a></li></ol></li></ol></li><li><a href=#-ì™œ-ê·¸ë ‡ê²Œ-í•´ì„í•´ì•¼-í•˜ëŠ”ê°€>ğŸ”¸ ì™œ ê·¸ë ‡ê²Œ í•´ì„í•´ì•¼ í•˜ëŠ”ê°€?</a><ol><li><a href=#1-ì›ë˜-í…ì„œ-êµ¬ì¡°>1. ì›ë˜ í…ì„œ êµ¬ì¡°:</a></li><li><a href=#2-reshape>2. reshape:</a></li></ol></li><li><a href=#-ì´ë¯¸ì§€ì™€-ë¹„êµí•´ì„œ-ëŒ€ì‘ì‹œì¼œë³´ë©´>ğŸ”¸ ì´ë¯¸ì§€ì™€ ë¹„êµí•´ì„œ ëŒ€ì‘ì‹œì¼œë³´ë©´:</a></li><li><a href=#-ìš”ì -ë‹¤ì‹œ-ë§í•˜ë©´>âœ… ìš”ì  ë‹¤ì‹œ ë§í•˜ë©´:</a></li><li><a href=#-ê°ê°-ë¹„ìœ >ğŸ”¸ ê°ê° ë¹„ìœ </a></li><li><a href=#-ìš”ì•½-ì •ë¦¬>âœ… ìš”ì•½ ì •ë¦¬</a><ol><li><a href=#ê¶ê¸ˆí•œ-ê²ƒ222><strong>ê¶ê¸ˆí•œ ê²ƒ!!222</strong></a></li></ol></li><li><a href=#ì˜ˆì‹œ-ë„ë©”ì¸ë³„-ê°™ì€-ì°¨ì›ì´-ì˜ë¯¸ê°€-ë‹¤ë¦„>ì˜ˆì‹œ: ë„ë©”ì¸ë³„ ê°™ì€ ì°¨ì›ì´ ì˜ë¯¸ê°€ ë‹¤ë¦„</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/nlp/ style=background-color:#2a9d8f;color:#fff>NLP</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/nlp/transformer-decoder/>Transformer - Decoder</a></h2><h3 class=article-subtitle>ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>6ì›” 22, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>9 ë¶„ ì •ë„</time></div></footer></div></header><section class=article-content><p>TransformerëŠ” Decoderì™€ EncoderÂ  êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤..! ì•ì—ì„œ ë°°ìš´ í•µì‹¬ ê°œë…ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ê° êµ¬ì¡°ë¥¼ ìì„¸íˆ ì•Œì•„ë³´ë„ë¡ í•˜ì.Â </p><h3 id=transformer-decoder>Transformer Decoder</h3><p>[##<em>Image|kage@bU8qFf/btsOKCcUETl/AAAAAAAAAAAAAAAAAAAAANxHlKSJS4OWqoujltyGRQZCjz-0SeP4dPPdkvWSJj4Q/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=eYzKHUr9ewovgtCNHcXFdQL0lSQ%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:426,&ldquo;originHeight&rdquo;:594,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;,&ldquo;width&rdquo;:255,&ldquo;height&rdquo;:356}</em>##]</p><p>ì‰½ê²Œ ìƒê°í•´ì„œ Language modelsì²˜ëŸ¼ ì–´ë–»ê²Œ ìš°ë¦¬ê°€ systemsì„ buildí• ê¹Œë¥¼ ìƒê°í•˜ë©´ ëœë‹¤.Â </p><p>minimal self-attention architectureë¡œ ë³´ì´ì§€ë§Œ, ì‚¬ì‹¤ ì¢€ ë” ë§ì€ componentê°€ ìˆë‹¤!Â </p><p>- Embeddingsì™€ Position EmbeddingsëŠ” ë™ì¼í•˜ë‹¤.Â </p><h4 id=1-multi-head-attention><strong>1. Multi-head Attention</strong>Â </h4><p><strong>ë¨¼ì € <strong>self-attentionì´ ì•„ë‹Œ multi-head self-attetionì´ë„¤..?</strong></strong></p><p>[##<em>Image|kage@JZfkN/btsOLeP8Om5/AAAAAAAAAAAAAAAAAAAAAG8vKO-oE3BZoqxfdNLP0Uk8-Drz3pCbja42a7Rje257/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=FxRnVrMw6ZV7WPJmfY2nPPglNQg%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:1048,&ldquo;originHeight&rdquo;:528,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;,&ldquo;width&rdquo;:775,&ldquo;height&rdquo;:390}</em>##]</p><p>ì—¬ê¸°ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì‚¬ì‹¤.. HeadëŠ” ë¬´ì—‡ì„ attention í•  ê²ƒì¸ì§€ë¥¼ ê²°ì •í•´ì£¼ëŠ” ê²ƒì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.Â </p><p>ìš°ì„ &mldr; Attentionì´ ê³„ì‚°ë˜ëŠ” ê³¼ì •ì„ ì•Œì•„ë³´ì!Â </p><p>Matricesì—ì„œ key-query-value attentionì´ ì–´ë–»ê²Œ ê³„ì‚°ë˜ëŠ” ì§€ ë´…ì‹œë‹¤&mldr;</p><ul><li><strong>Input</strong>Input vectorsì˜ concatenationë¼ê³  í•  ìˆ˜ ìˆë‹¤.Â X = \[x1; ... ; xn\] âˆˆ â„ğ‘›Ã— ğ‘‘ (í–‰ì´ nê°œ, ì—´ì´ dê°œ; ì¦‰, nì€ ë‹¨ì–´ì˜ ê°œìˆ˜ dëŠ” ì°¨ì›)</li><li><strong>Output</strong><br>softmax(XQ(XK)T)XV âˆˆâˆˆâ„ğ‘›Ã—ğ‘‘<br>ì´ë•Œ, ğ‘‹ğ¾ âˆˆ â„ğ‘›Ã—ğ‘‘, ğ‘‹ğ‘„ âˆˆ â„ğ‘›Ã—ğ‘‘, ğ‘‹ğ‘‰ âˆˆ â„ğ‘›Ã—ğ‘‘</li></ul><p>1. <strong>Query-Key dot products : Â ğ‘‹ğ‘„Â ğ‘‹ğ¾Â âŠ¤</strong></p><p>[##<em>Image|kage@bHygVe/btsOMHpR4u6/AAAAAAAAAAAAAAAAAAAAAJQHdXe472r-kBNk9-TJICHeLE0lO-blGYRs7X__jwwM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=27m1ZJXKwrOLB5luicgVpt2yEcU%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:668,&ldquo;originHeight&rdquo;:172,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ì¦‰ ê²°ê³¼ëŠ” ì‰½ê²Œ ìƒê°í•´ì„œ ê° Query ë²¡í„°ì™€ ê° Key ë²¡í„° ê°„ì˜ dot productì˜ ê°’ì„ ëª¨ë‘ êµ¬í•œ matrixë¼ê³  ë³´ë©´ ëœë‹¤..!Â </p><p>ê²°ê³¼ matrixì˜ (i,j)ì˜ ê°’ì€ Qì˜ ië²ˆì§¸ í–‰(ië²ˆì§¸ wordì˜ Query) Kì˜ jë²ˆì§¸ ì—´(jë²ˆì§¸ wordì˜ Key)ì˜ dot product (í˜„ì¬ Queryê°€ Keyë¥¼ ì–¼ë§ˆë‚˜ ì°¸ê³ í•˜ëŠ”ê°€?) ë¼ê³  ë³´ë©´ ëœë‹¤!! ê·¸ë¦¬ê³ í•œ í–‰ì´ Queryì— ëŒ€í•œ ë‹¤ë¥¸ keyì˜ attention scoreê°€ ëœë‹¤.Â Â </p><p>[##<em>Image|kage@XI3Hz/btsOKK9wXI7/AAAAAAAAAAAAAAAAAAAAAMmmaeiAuZCsfruzcRqCSsGtNYOyLw-ytHZSWZgzwZ_u/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=nFFGzsI2B7YglWAhS%2FfDo59dIzw%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:684,&ldquo;originHeight&rdquo;:194,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ê·¸ë¦¬ê³  softmaxë¥¼ ì ìš©í•˜ë¨„,</p><p>ê° í–‰ì€ Query ìœ„ì¹˜ iê°€ ì „ì²´ Keyë“¤(j=1~n)ì— ëŒ€í•´ attentioní•˜ëŠ” <strong>ê°€ì¤‘ì¹˜</strong></p><p>ì´ë¥¼ V(ê° wordì˜ ì‹¤ì œ ì •ë³´)ì— ê³±í•˜ì—¬ weighted averageë¥¼ ê³„ì‚°í•œë‹¤!Â </p><p>softmax ê²°ê³¼ì˜Â <strong>í•œ í–‰</strong> (ì¦‰, Queryê°€ ë³´ëŠ” attention weight)<br>ì™€ Vì˜ <strong>í•œ ì—´</strong> (íŠ¹ì • ì˜ë¯¸ ì°¨ì›ë§Œ ë‹´ê³  ìˆìŒ)ì„ ê³±í•˜ë©´<br>ê³¼ì—° ì´ê²Œ ë¬´ìŠ¨ ì˜ë¯¸ì§€?â€</p><blockquote><p>Softmaxí•œ í•œ í–‰ Ã— Vì˜ í•œ ì—´ =<br><strong>&ldquo;ì´ Queryê°€ í•´ë‹¹ ì˜ë¯¸ ì°¨ì›ì— ëŒ€í•´ ì–¼ë§ˆë‚˜ ì •ë³´ë¥¼ ëŒì–´ì™”ëŠ”ê°€?&rdquo;</strong></p></blockquote><p>ê·¸ë¦¬ê³  ê·¸ê±¸ <strong>d_v ê°œ ì°¨ì›ì— ëŒ€í•´ ëª¨ë‘</strong> ê³„ì‚°í•˜ë‹ˆê¹Œ<br>â†’ ië²ˆì§¸ Queryì˜ <strong>context vector</strong>ê°€ ë‚˜ì˜¤ëŠ” ê±°ì˜ˆìš”!</p><p>ì¦‰ ê²°ê³¼ matrixì˜ (i, j)ì˜ ê°’ì€ í•œ wordì˜ Attention ê°€ì¤‘ì¹˜ì— ëŒ€í•˜ì—¬ ë‹¤ë¥¸ wordë“¤ì— ëŒ€í•´ ê³±í•˜ì—¬ ë”í•œ ê°’(ì´ë•Œ ë‹¤ë¥¸ wordì˜ ì¼ë¶€ ì°¨ì›ë§Œ ê³±í•œ ê²ƒ)Â </p><p>ë”°ë¼ì„œ ië²ˆì§¸ í–‰ì€ ì „ì²´ contextì„!!</p><p><strong>ë§Œì•½ ìš°ë¦¬ê°€ í•œ sentenceì—ì„œ ì—¬ëŸ¬ ìœ„ì¹˜ë¥¼ í•œë²ˆì— ë³´ê³ ì‹¶ë‹¤ë©´ ì–´ë–¨ê¹Œ??</strong></p><p>ë‹¨ì–´ iëŠ” ë³´í†µ, self-attentionì´ xiTQTKxj (ì¦‰ xiì˜ Query, xjì˜ Key)ê°€ ë†’ì€ ê³³ì„ &ldquo;ë³´ê³ "ìˆëŠ”ë°, ì¦‰ ë‹¨ì–´ jë¥¼ ë°”ë¼ë³´ëŠ”ë°, ì–´ì©Œë©´ ë‹¤ë¥¸ ì´ìœ ë¡œ ë‹¤ë¥¸ j(ë‹¤ë¥¸ ë‹¨ì–´ë“¤)ë„ ì§‘ì¤‘í•´ì„œ ë³´ê³  ì‹¶ì„ ìˆ˜ë„ ìˆì§€ ì•Šì„ê¹Œ?</p><p>ìš°ë¦¬ëŠ” ì—¬ëŸ¬ ê°œì˜ Q, K, V metricesì„ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ ê°œì˜ attention &ldquo;head"ë¥¼ ì •ì˜í•  ê²ƒì´ë‹¤.Â </p><p>[##<em>Image|kage@Q6rwO/btsOKByllUD/AAAAAAAAAAAAAAAAAAAAAAWQ59oYeD3MYB6pbl_b33hwnPTT02HUEnPvMDQSSXSL/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=8mCDlJK7KD%2FYybjO0feQnPsIxrM%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:217,&ldquo;originHeight&rdquo;:50,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>Ql, Kl, VlëŠ” ê°ê° lë²ˆì§¸ headì—ì„œ ì‚¬ìš©ë˜ëŠ” í–‰ë ¬ì´ê³ ,</p><p>hëŠ” headì˜ ê°œìˆ˜, lì€ head ë²ˆí˜¸ (1ë¶€í„° hê¹Œì§€)ë¼ê³  í•˜ì.Â </p><p>ì—¬ê¸°ì„œ ì „ì²´ ì°¨ì› dë¥¼ head ìˆ˜ hë¡œ ë‚˜ëˆ„ì–´ì„œ ê° headëŠ” ë” ì‘ê³  ë…ë¦½ì ì¸ ê³µê°„ì—ì„œ ì‘ë™í•¨.</p><p>[##<em>Image|kage@dC2ypW/btsOLuSGwUr/AAAAAAAAAAAAAAAAAAAAAJHiJj9SOuemqas0W38uXz5iwcuUmErvBcFPS7gdwi_u/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=I8M1ZFDFf1HnsKa3x8l9Z7oHzSI%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:814,&ldquo;originHeight&rdquo;:57,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ê° attention headëŠ” attentionì€ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰í•œë‹¤.Â </p><p>attention score : XQl(Kl)TXT</p><p>value í•©ì‚° : ê·¸ ê²°ê³¼ì— XVlë¥¼ ê³±í•©Â </p><p>ê° headëŠ” ì„œë¡œ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ attentionì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ê°’ì€ ì‘ì§€ë§Œ ë…ë¦½ì ì¸ feature representationì´ ëœë‹¤.Â </p><p>[##<em>Image|kage@JEEE9/btsOMVuVg3F/AAAAAAAAAAAAAAAAAAAAANwwdgS3eIQEJWHparx&ndash;n0sZBjcxZZN937ht1nKoYGE/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=k0QKofMYuIO4QAUiYNiAbzg9h%2BA%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:660,&ldquo;originHeight&rdquo;:42,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>output vectorë¥¼ í–‰ë ¬ë¡œ ë§Œë“  í›„ combineÂ </p><p><strong>ì¦‰, ê° headëŠ” ì„œë¡œ different thingsë¥¼ &ldquo;ë³´ê³ &rdquo;, value vectorsë„ ë‹¤ë¥´ê²Œ constrcutí•œë‹¤!!</strong></p><p><strong>íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ë°©ë²•</strong>Â </p><p>ìš°ë¦¬ê°€ hê°œì˜ ë§ì€ attention headsë¥¼ ê³„ì‚°í• ì§€ë¼ë„ ê·¸ê²ƒì€ ë§¤ìš° ë¹„ì‹¸ì§€ ì•Šë‹¤.Â </p><p>1. <strong>ğ‘‹ğ‘„âˆˆâ„ğ‘›Ã—ğ‘‘ ë¥¼ ê³„ì‚°í•˜ê³  â„ğ‘›Ã—â„Ã—ğ‘‘/â„ ë¡œ reshape</strong> í•œë‹¤. (XK, XVë„ ë§ˆì°¬ê°€ì§€ë¡œ!!)Â </p><p>ì´ë ‡ê²Œ ë˜ë©´ dì°¨ì›ì˜ nê°œì˜ wordì—ì„œ attention head hê°œë¥¼ ë§Œë“¤ê³  ì‹¶ê¸° ë•Œë¬¸ì—</p><p>dimenstion dë¥¼ hê°œì˜ headë¡œ ë‚˜ëˆ„ê³  ê° headì— d/hë§Œí¼ í• ë‹¹í•´ì¤€ë‹¤.Â </p><p>ë”°ë¼ì„œ resahpe ì‹œ ê° ë‹¨ì–´(n)ê°œê°€ hê°œì˜ headë¥¼ ê°€ì§€ë©° ê° headëŠ” d/h ì°¨ì›ì˜ query vectorë¥¼ ê°€ì§„ë‹¤. (2ì°¨ì› í–‰ë ¬ì´ì—ˆëŠ”ë° ì´ì œ 3ì°¨ì› tensorê°€ ëœë‹¤)Â </p><p>2. <strong>â„â„Ã—ğ‘›Ã—ğ‘‘/â„ ë¡œ transpose</strong>í•œë‹¤. ê·¸ëŸ¬ë©´ head axisì´ batch axisì²˜ëŸ¼ ì‘ë™í•œë‹¤. (ë˜í•œ ë§¨ ì•ì´ ë³´í†µ depthì˜ ì˜ë¯¸..!)</p><p>Transformer êµ¬í˜„ì—ì„œëŠ” ê° headì— ëŒ€í•´ ë…ë¦½ì ìœ¼ë¡œ attentionì„ ê³„ì‚°í•´ì•¼ í•˜ëŠ”ë°, <strong>ë³´í†µ batch aixsë¥¼ ì œì¼ ì•ì— ë‘ê³  batch ì°¨ì› ë‹¨ìœ„ë¡œ ë³‘ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤.</strong>Â </p><p><strong>ì¦‰, ê° headë¥¼ ë…ë¦½ì ì¸ sampleì²˜ëŸ¼ ë³‘ë ¬ ì²˜ë¦¬ í•˜ê¸° ìœ„í•´ì„œë‹¤!</strong>Â </p><p>ê·¸ëƒ¥ ì‰½ê²Œ ìƒê°í•´ì„œ hê°œì˜ headê°€ nxd/hì˜ í¬ê¸°ì˜ matrixë¥¼ ê°–ê³  ìˆë‹¤ ìƒê°í•˜ì!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ì›ë˜:
</span></span><span class=line><span class=cl>[ ë‹¨ì–´1: head1, head2, ..., headh ]
</span></span><span class=line><span class=cl>[ ë‹¨ì–´2: head1, head2, ..., headh ]
</span></span><span class=line><span class=cl>     â†“
</span></span><span class=line><span class=cl>transpose
</span></span><span class=line><span class=cl>[ head1: ë‹¨ì–´1, ë‹¨ì–´2, ... ]
</span></span><span class=line><span class=cl>[ head2: ë‹¨ì–´1, ë‹¨ì–´2, ... ]
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p><strong>ê±°ì˜ ë‹¤ë¥¸ ëª¨ë“  ê²ƒì€ ë™ì¼í•˜ê³  í–‰ë ¬ë“¤ì˜ í¬ê¸°ë“¤ë„ ë™ì¼í•˜ë‹¤!!</strong>Â </p><p>[##<em>Image|kage@bqj8M3/btsOMWHmfti/AAAAAAAAAAAAAAAAAAAAAF57waTz0TN_gIlpr1n2S9W0yFIumLkPrqiVmgsA3rWk/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=paBWHF47CiK5BkOGc1zDSSZ6G68%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:712,&ldquo;originHeight&rdquo;:205,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´ headê°€ 3ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. (ê°€ë¡œ ì„¸ë¡œê°€ ì°¨ì›ê³¼ ëŒ€ì‘ë˜ëŠ”ê²Œ ì•„ë‹˜ ì£¼ì˜!!!)Â </p><p>XQ, XK: nxd/hê°€ 3ê°œ ìˆë‹¤! ë¼ê³  ì´í•´í•˜ë©´ ì‰¬ìš¸ë“¯!Â </p><p>XQKX: 3ê°œì˜ headê°€ ê°ê° nxn í¬ê¸°ì˜ attention score matrixë¥¼ ê°–ê³  ìˆë‹¤.Â </p><p>dot productí•´ì„œ ê° headì˜ attention scoreë¥¼ ê³„ì‚°í•˜ê²Œ ëœë‹¤.Â </p><p>[##<em>Image|kage@Rthvu/btsONayBQbW/AAAAAAAAAAAAAAAAAAAAAAnSO07E_Wm7qCPAZthbcpzc44sdrbX8s1TVz2gLUm1n/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=Ndh%2FrOW7XNRiZ3xjeSy3rRphUp4%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:808,&ldquo;originHeight&rdquo;:193,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>softmaxë¥¼ ìˆ˜í–‰í•œ í›„ ê° headë³„ë¡œ weighted average ìˆ˜í–‰í•œë‹¤.Â </p><p>ê° headì˜ attention scores matrixì™€ ê° headì˜ XVë¥¼ ê°ê° ê³±í•œ ê²°ê³¼ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤!</p><p><strong>Scaled dot Product</strong>Â </p><p>Qì™€ Kì˜ ì°¨ì›ì´ ì»¤ì§€ë©´ ë‚´ì  ê°’ì´ ë„ˆë¬´ ì»¤ì ¸ì„œ softmaxê°€ í„°ì§€ë‹ˆê¹Œ, ê·¸ê±¸ ë°©ì§€í•˜ë ¤ê³  âˆš(d/h)ë¡œ ë‚˜ëˆ ì£¼ëŠ” ê²Œ â€œScaled Dot Product Attentionâ€ì´ë‹¤.</p><p>ë§Œì•½ dimensionality d (embedding ì°¨ì›ì˜ ìˆ˜)ê°€ ë„ˆë¬´ ì»¤ì§€ë©´, vector ê°„ì˜ dot products ê°’ë„ ë” ì»¤ì§€ëŠ” ê²½í–¥ì´ ìˆë‹¤. ì´ëŸ¬ë©´ softmax í•¨ìˆ˜ì˜ inputì´ ë” ì»¤ì§ˆ ìˆ˜ ìˆëŠ”ë°,,, ê·¸ëŸ¬ë©´ softmaxì˜ ì¶œë ¥ì´ ë„ˆë¬´ ë¾°ì£¡í•´ì ¸ì„œ, backpropagation ë•Œ gradientsê°€ ë§¤ìš° ì‘ì•„ì§€ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.</p><p>ìš°ë¦¬ê°€ ë³¸ ì´ self-attention function ëŒ€ì‹ ì—</p><p>[##<em>Image|kage@dFKBY5/btsONaSUJ9p/AAAAAAAAAAAAAAAAAAAAAInbOgy7vn8xxuJxnVytPDmpeOGYo4fkla18Rq2j3CDd/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=gkmQXl51aS%2BHeswq2915ngwBC5Q%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:483,&ldquo;originHeight&rdquo;:58,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>attention scoreë“¤ì„ ë£¨íŠ¸ d/hë¡œ ë‚˜ëˆ„ì–´ì„œ scoresë“¤ì´ ë” ì»¤ì§€ì§€ ì•Šê²Œ ë§‰ì•„ì¤€ë‹¤!Â </p><p>[##<em>Image|kage@3OYaJ/btsOMPnVrZE/AAAAAAAAAAAAAAAAAAAAAB1UXP4AA7e0w5fsq_VPe6CoDIZ5mmgqYX1BeOgiruWF/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=el2wnpDwXb2wRhpEpczmk68PBXY%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:471,&ldquo;originHeight&rdquo;:69,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##][##<em>Image|kage@o4J0S/btsONd3buUS/AAAAAAAAAAAAAAAAAAAAADofAExHVj7_N97OY9Zs-8Lij24z1s5Pck0KkqGBpciL/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=eiqFHJqOS1ZNOlMLDswQfIlnhQM%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:371,&ldquo;originHeight&rdquo;:567,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><h4 id=2-residual-connections><strong>2. Residual Connections</strong></h4><p><strong>ì´ì œ optimization trick ëª‡ ê°€ì§€ë¥¼ ì•Œì•„ë³´ì&mldr;!!! ì´ì „ ê²°ê³¼ì™€ Layerë¥¼ í†µê³¼í•œ ê²°ê³¼ë¥¼ ë”í•¨ìœ¼ë¡œì¨ ê·¸ ë³€í™”ëŸ‰ë§Œ í•™ìŠµí•œë‹¤!!</strong>Â </p><p>ë³´í†µ diagramì—ì„œëŠ” ì¢…ì¢… Add & Normì´ë¼ê³  í‘œí˜„ë˜ë¯€ë¡œ ì°¸ê³ í•˜ì‹œê¸¸..!Â </p><p><strong>Residual Connectionsì€ model ë” ì˜ traingë˜ë„ë¡ ë„ì™€ì£¼ëŠ” trickì´ë‹¤.</strong>Â </p><p>[##<em>Image|kage@bHgXRo/btsONbK3W44/AAAAAAAAAAAAAAAAAAAAAKOrF8OaH0_iKARp0hS_5yMMgOV7Pd2q4rsEMUzg0uMI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=QS9Id%2FLagGTDlT%2BMxSioY2%2FW4Xc%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:437,&ldquo;originHeight&rdquo;:88,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ìš°ë¦¬ëŠ” ë³´í†µ ië²ˆì§¸ layerì˜ representaionì€ ì´ì „ layerì˜ representationì„ layerë¥¼ ë„£ì€ ê²°ê³¼ë¼ê³  ìƒê°í•œë‹¤.</p><p>[##<em>Image|kage@x53sD/btsOLdKt4Gt/AAAAAAAAAAAAAAAAAAAAAFF5A4DLuQQoRHBwsKR6Sfztkwdhx6gK70aJevsNkdmC/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=9R764qZ%2FKZsn6qp0WZAq%2Fg5jZjw%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:430,&ldquo;originHeight&rdquo;:96,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ê·¸ëŸ°ë°, Residual Connectionì—ì„œëŠ” ìœ„ì™€ ê°™ì´ ë°”ê¿”ì§„ë‹¤. ì´ì „ layerì˜ representationì— Layerì˜ representationì„ ë”í•œë‹¤!</p><p>ì¦‰, ìš°ë¦¬ëŠ” ì „ì²´ functionë¥¼ ìƒˆë¡œ ë°°ìš°ëŠ” ê²Œ ì•„ë‹ˆë¼ residual(ë³€í™”ëŸ‰)ë§Œ í•™ìŠµí•˜ë©´ ëœë‹¤!!Â </p><p>ì¦‰ ê¸°ì¡´ ì…ë ¥ + ë³€í™”ëœ ë¶€ë¶„ì„ ë„£ìœ¼ë‹ˆ <strong>ê¸°ì¡´ ì…ë ¥ì„ ì–¼ë§ˆë‚˜ ë°”ê¿€ì§€ë¥¼ í•™ìŠµí•œë‹¤.</strong>Â </p><p>- ì¥ì </p><p>ì´ êµ¬ì¡° ë•ë¶„ì— Gradientê°€ ë” ì¢‹ì•„ì§„ë‹¤. -> ì—­ì „íŒŒê°€ ì˜ ì „ë‹¬ëœë‹¤!Â </p><p>Biasë„ ë” ì¢‹ì•„ì§„ë‹¤!! -> í•™ìŠµ ì´ˆê¸°ì— ì…ë ¥ ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜(identity)ì— ê°€ê¹Œìš´ í¸í–¥ì„ ê°€ì§€ê²Œ ëœë‹¤. ëª¨ë¸ì´ ì²˜ìŒì—” ë­”ê°€ë¥¼ ë°”ê¾¸ì§€ ì•Šê³  ê·¸ëƒ¥ í˜ë ¤ë³´ë‚´ëŠ” ê²ƒì— ìµìˆ™í•´ì§!Â </p><p>[##<em>Image|kage@ct3AVM/btsOMqhCltF/AAAAAAAAAAAAAAAAAAAAABDqhFU8a9GPRKkFriDpNB_hUlxvl6uchzwO2y-SB-ul/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=7B7VhBO4ErmPDWcu%2BWVCASiN2FA%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:413,&ldquo;originHeight&rdquo;:275,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><h4 id=3-layernormalization><strong>3. LayerÂ normalization</strong></h4><p><strong>Layer normalizaitonì´ modelì´ ë” ë¹ ë¥´ê²Œ trainë˜ë„ë¡ ë„ì™€ì£¼ëŠ” trickì´ë‹¤.</strong>Â </p><p><strong>LayerNormì€ ë‹¨ì–´ ë²¡í„° ë‚´ë¶€ì˜ ê°’ ë¶„í¬ë¥¼ ì •ê·œí™”í•´ì„œ, í•™ìŠµì„ ì•ˆì •í™”í•˜ê³  ë¹ ë¥´ê²Œ ë§Œë“œëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.</strong></p><ul><li><strong>Idea</strong></li></ul><p><strong>ê° layerì—ì„œ hidden vectorì˜ ë¶ˆí•„ìš”í•œ, ì˜ë¯¸ì—†ëŠ” variation(ì¡ìŒ)ì„ cut downí•˜ê¸° ìœ„í•´, standard deviation(í‘œì¤€ í¸ì°¨)ê³¼ unit meanì„ normalizingí•˜ëŠ” ê²ƒ! (í‰ê· ì´ 0ì´ê³  í‘œì¤€í¸ì°¨ê°€ 1ì´ ë˜ë„ë¡ ì •ê·œí™”í•˜ëŠ” ê²ƒ!)</strong></p><p>ì´ê²Œ ì˜ ì‘ë™í•˜ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜ëŠ”, gradient(ê¸°ìš¸ê¸°)ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ì •ê·œí™”í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.</p><p><strong>ğ‘¥ âˆˆâ„ğ‘‘</strong> : modelì—ì„œì˜ í•œ individual(word) vector , dì°¨ì›(embedding ëœ ì°¨ì›)ì„</p><p><strong>ğœ‡ =Ïƒğ‘—=1 ğ‘‘ ğ‘¥ğ‘—</strong> : ì´ê±´ meanì´ì—ì—¬ ğœ‡ âˆˆ â„, xì˜ ê° ì„±ë¶„ì„ í‰ê·  ë‚´ë©´ scala ê°’ì´ ëœë‹¤.Â </p><p><strong>ğœ 2 = 1 ğ‘‘ ğ‘‘ Ïƒ ğ‘— = 1 ğ‘¥ ğ‘— âˆ’ ğœ‡</strong> ; ì´ê±´ standard deviationì´ì—ì—¬ , Â ğœ âˆˆ â„. í‰ê· ì—ì„œ ì–¼ë§ˆë‚˜ í¼ì ¸ ìˆëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ë©´ ë¶„ì‚° í˜¹ì€ í‘œì¤€í¸ì°¨ê°€ ëœë‹¤.Â </p><p><strong>ğ›¾ âˆˆâ„ğ‘‘</strong> : gain parameters í•™ìŠµ ê°€ëŠ¥í•œ parameter</p><p><strong>ğ›½ âˆˆâ„ğ‘‘</strong>Â  :bias parameters í•™ìŠµ ê°€ëŠ¥í•œ parameter</p><p>ìœ„ì˜ ë‘ parameterëŠ” ìµœì¢… ì¶œë ¥ scaleì„ ì¡°ì •í•˜ëŠ”ë° ì‚¬ìš©, í•„ìš”ì—†ìœ¼ë©´ ìƒëµ ê°€ëŠ¥í•¨.</p><p>ë˜í•œ ì •ê·œí™” í•´ì£¼ë‹¤ê°€ ì •ë³´ ì†ì‹¤ì˜ ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ë³µì› ê°€ëŠ¥ì„±ì„ ì£¼ê¸° ìœ„í•´ í•™ìŠµ ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°ë¥¼ ë¶™ì¸ë‹¤.Â </p><p>ê·¸ëŸ¼ë…€ layer normalizationì€ ë‹¤ìŒê³¼ ê°™ì´ compute ëœë‹¤.Â </p><p>[##<em>Image|kage@bzundi/btsOLdwZG81/AAAAAAAAAAAAAAAAAAAAAPIoF1Mu9BEVX6I6BDGP-DfyqObOIQZkGKQMH-QLG_B</em>/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=hDiFjO8Rby2Z758WU2LPXSb7Fo4%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:860,&ldquo;originHeight&rdquo;:128,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}_##]</p><p><strong>ì…ë ¥ vecotrì—ì„œ í‰ê· ì„ ë¹¼ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ì›Œì„œ ì •ê·œí™” í•œ í›„ ê°ë§ˆì™€ ë² íƒ€ë¡œ scale ì¡°ì •</strong>Â </p><h3 id=ì§œì”><strong>ì§œì”!</strong></h3><p>Transforemer DecoderëŠ” ë‹¤ìŒê³¼ ê°™ì€ Blockìœ¼ë¡œ ì´ë£¨ì–´ì¡Œë‹µë‹ˆë‹¤.Â </p><p>[##<em>Image|kage@7J3Ex/btsOK9nKDyq/AAAAAAAAAAAAAAAAAAAAAGIfAhhGOKFkXFLsXkKguFv5zwYiFQ-E7AOOotqaA9aT/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=jKPRgP%2FzTDkKagUu3Iu2FyXG0CE%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:386,&ldquo;originHeight&rdquo;:662,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><ul><li>Self-attentionÂ </li><li>Add & Norm (ì´ê±´ ê° ë‹¨ê³„ë§ˆë‹¤ ë¶™ì—¬ì£¼ëŠ” ê²ƒì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤)Â </li><li>Feed-Forward</li><li>Add & Norm</li></ul><h4 id=ê¶ê¸ˆí•œ-ê²ƒ><strong>ê¶ê¸ˆí•œ ê²ƒ!!</strong></h4><p>&ldquo;n Ã— dì—ì„œ nì€ heightê³  dëŠ” widthì²˜ëŸ¼ ë´¤ëŠ”ë°,<br>reshapeí•´ì„œ n Ã— h Ã— d/hê°€ ë˜ë©´ nì´ channelì´ ë˜ëŠ” ê±°ì•¼? ì•„ë‹ˆë©´ ì—¬ì „íˆ heightì•¼?&rdquo;</p><p>â—ï¸<strong>nì€ ì—¬ì „íˆ height (sequence axis), ì¦‰ &lsquo;ë‹¨ì–´ ìˆ˜&rsquo;ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¶•ì´ì•¼.</strong><br>â†’ <strong>channel ì¶•ì€ h Ã— d/h ìª½ì„ (ì¦‰, ë‚˜ì¤‘ ì°¨ì›ë“¤)</strong></p><hr><h2 id=-ì™œ-ê·¸ë ‡ê²Œ-í•´ì„í•´ì•¼-í•˜ëŠ”ê°€>ğŸ”¸ ì™œ ê·¸ë ‡ê²Œ í•´ì„í•´ì•¼ í•˜ëŠ”ê°€?</h2><h3 id=1-ì›ë˜-í…ì„œ-êµ¬ì¡°>1. ì›ë˜ í…ì„œ êµ¬ì¡°:</h3><p>XQâˆˆRnÃ—dXQ âˆˆ â„^{n Ã— d}XQâˆˆRnÃ—d</p><ul><li><strong>n</strong>: ë‹¨ì–´ ê°œìˆ˜ â†’ ë¬¸ì¥ ê¸¸ì´ â†’ height (ì„¸ë¡œ)</li><li><strong>d</strong>: ê° ë‹¨ì–´ì˜ ì„ë² ë”© â†’ width (ê°€ë¡œ)</li></ul><p>ì´ êµ¬ì¡°ëŠ” ë§ˆì¹˜ ì´ë¯¸ì§€ì—ì„œ:</p><p>arduino</p><p>ë³µì‚¬í¸ì§‘</p><p>height x width</p><p>ì²˜ëŸ¼ ë³´ì„. (2D)</p><hr><h3 id=2-reshape>2. reshape:</h3><p>RnÃ—hÃ—d/hâ„^{n Ã— h Ã— d/h}RnÃ—hÃ—d/h</p><ul><li><strong>n</strong>ì€ ê·¸ëŒ€ë¡œ: ë‹¨ì–´ ìˆ˜ â†’ ê·¸ëŒ€ë¡œ height (ì„¸ë¡œ)</li><li><strong>h Ã— d/h</strong>ëŠ”: ë²¡í„°ë¥¼ head ìˆ˜ë¡œ ë¶„ë¦¬í•œ ê²ƒ â†’ ì´ê²Œ <strong>channel ë°©í–¥ í™•ì¥ì²˜ëŸ¼ ì‘ë™</strong></li></ul><hr><h2 id=-ì´ë¯¸ì§€ì™€-ë¹„êµí•´ì„œ-ëŒ€ì‘ì‹œì¼œë³´ë©´>ğŸ”¸ ì´ë¯¸ì§€ì™€ ë¹„êµí•´ì„œ ëŒ€ì‘ì‹œì¼œë³´ë©´:</h2><p>ìì—°ì–´ ì²˜ë¦¬ í…ì„œì´ë¯¸ì§€ ì²˜ë¦¬ í…ì„œì˜ë¯¸</p><div class=table-wrapper><table><thead><tr><th>n</th><th>height</th><th>ë‹¨ì–´ ìœ„ì¹˜</th></tr></thead><tbody><tr><td>d (or h Ã— d/h)</td><td>channel</td><td>ì„ë² ë”© ì°¨ì› / attention head</td></tr><tr><td>(ì—†ìŒ)</td><td>width</td><td>(ë‹¨ì–´ëŠ” 1Dì´ë¯€ë¡œ ê°€ë¡œì¶• ì—†ìŒ)</td></tr></tbody></table></div><hr><h2 id=-ìš”ì -ë‹¤ì‹œ-ë§í•˜ë©´>âœ… ìš”ì  ë‹¤ì‹œ ë§í•˜ë©´:</h2><ul><li>n Ã— d: nì€ heightì²˜ëŸ¼ &ldquo;ë‹¨ì–´ ìœ„ì¹˜&rdquo;, dëŠ” ì„ë² ë”© (channelì²˜ëŸ¼ í•´ì„ ê°€ëŠ¥)</li><li>n Ã— h Ã— d/h: nì€ ì—¬ì „íˆ height (ë‹¨ì–´ ìœ„ì¹˜),<br>â†’ h Ã— d/hëŠ” channel dimensionì²˜ëŸ¼ ì‘ë™ (ê° ë‹¨ì–´ë‹¹ ì—¬ëŸ¬ head í‘œí˜„)</li></ul><blockquote><p>â—ï¸<strong>channelì€ ë§¨ ë’¤ìª½ ì°¨ì›ì´ê³ , heightëŠ” í•­ìƒ ë‹¨ì–´ ìˆœì„œ(n)</strong><br>reshapeë¥¼ í•´ë„ <strong>nì´ channelì´ ë˜ëŠ” ê±´ ì ˆëŒ€ ì•„ë‹˜</strong></p></blockquote><hr><h2 id=-ê°ê°-ë¹„ìœ >ğŸ”¸ ê°ê° ë¹„ìœ </h2><p>ì´ë¯¸ì§€ì—ì„œëŠ”:</p><p>less</p><p>ë³µì‚¬í¸ì§‘</p><p>ì´ë¯¸ì§€:</p>\[Height Ã— Width Ã— Channel\]<p>ë¬¸ì¥ ì…ë ¥:</p>\[Token ìœ„ì¹˜ Ã— Feature\]<p>â†’ reshape â†’</p>\[Token ìœ„ì¹˜ Ã— Head Ã— Dim\_per\_Head\]<p>ê·¸ë˜ì„œ <strong>ë¬¸ì¥ì—ì„œ Token ìœ„ì¹˜(n)</strong> ëŠ” <strong>í•­ìƒ height</strong> ì—­í• ì´ì§€ channelì´ ì•„ë‹ˆì•¼.</p><hr><h2 id=-ìš”ì•½-ì •ë¦¬>âœ… ìš”ì•½ ì •ë¦¬</h2><p>reshape ì „reshape í›„nì˜ ì˜ë¯¸channelì€ ì–´ë””?</p><div class=table-wrapper><table><thead><tr><th>n Ã— d</th><th>n Ã— h Ã— d/h</th><th>âœ… ì—¬ì „íˆ ë‹¨ì–´ ìœ„ì¹˜ (height)</th><th>âœ… h Ã— d/h (ë’¤ìª½ì´ channel ì—­í• )</th></tr></thead><tbody><tr><td>channelì¸ê°€?</td><td>âŒ ì•„ë‹˜</td><td>âŒ</td><td>Â </td></tr></tbody></table></div><h3 id=ê¶ê¸ˆí•œ-ê²ƒ222><strong>ê¶ê¸ˆí•œ ê²ƒ!!222</strong></h3><blockquote><p><strong>matrixì˜ ì˜ë¯¸ê°€ ê³ ì •ë˜ì–´ ìˆëŠ” ê²Œ ì•„ë‹ˆë¼&mldr; visionì¸ì§€, LLMì¸ì§€ ë‹¤ ë‹¤ë¥¸ ê±°ì•¼?&rdquo;</strong></p></blockquote><p>âœ… <strong>ë§ì•„. í…ì„œ(í–‰ë ¬)ì˜ ê° ì°¨ì›ì´ ë­˜ ì˜ë¯¸í•˜ëŠ”ì§€ëŠ” &lsquo;ë„ë©”ì¸&rsquo;ì— ë”°ë¼ ë‹¬ë¼.</strong></p><h2 id=ì˜ˆì‹œ-ë„ë©”ì¸ë³„-ê°™ì€-ì°¨ì›ì´-ì˜ë¯¸ê°€-ë‹¤ë¦„>ì˜ˆì‹œ: ë„ë©”ì¸ë³„ ê°™ì€ ì°¨ì›ì´ ì˜ë¯¸ê°€ ë‹¤ë¦„</h2><p>ë„ë©”ì¸í…ì„œ ì°¨ì›ì°¨ì› ì˜ë¯¸</p><div class=table-wrapper><table><thead><tr><th><strong>Vision (CNN)</strong></th><th>\[B, C, H, W\]</th><th>B: ë°°ì¹˜, C: ì±„ë„, H: ë†’ì´, W: ë„ˆë¹„</th></tr></thead><tbody><tr><td><strong>LLM (Transformer NLP)</strong></td><td>\[B, N, D\]</td><td>B: ë°°ì¹˜, N: í† í° ìˆ˜, D: ì„ë² ë”© ì°¨ì›</td></tr><tr><td><strong>Multi-Head Attention</strong></td><td>\[B, H, N, D/H\]</td><td>B: ë°°ì¹˜, H: head ìˆ˜, N: ë‹¨ì–´ ìˆ˜, D/H: headë‹¹ ì„ë² ë”©</td></tr><tr><td><strong>Audio</strong></td><td>\[B, T, F\]</td><td>B: ë°°ì¹˜, T: ì‹œê°„ì¶•, F: ì£¼íŒŒìˆ˜ bin</td></tr><tr><td><strong>Time series</strong></td><td>\[B, T, C\]</td><td>B: ë°°ì¹˜, T: íƒ€ì„ìŠ¤í…, C: ë³€ìˆ˜ (ì±„ë„)</td></tr></tbody></table></div></section><footer class=article-footer><section class=article-tags><a href=/tags/nlp/>NLP</a>
<a href=/tags/deep-learning/>Deep Learning</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ê´€ë ¨ ê¸€</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/nlp/pretraining/><div class=article-details><h2 class=article-title>Pretraining</h2></div></a></article><article><a href=/p/nlp/transformer-encoder/><div class=article-details><h2 class=article-title>Transformer - Encoder</h2></div></a></article><article><a href=/p/nlp/transformer1-self-attention/><div class=article-details><h2 class=article-title>Transformer(1) - Self-attention</h2></div></a></article><article><a href=/p/nlp/attention/><div class=article-details><h2 class=article-title>Attention</h2></div></a></article><article><a href=/p/nlp/machine-translation-mt%EC%9D%98-%EB%B0%9C%EC%A0%84/><div class=article-details><h2 class=article-title>Machine Translation (MT)ì˜ ë°œì „</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 DDubi's World</section><section class=powerby><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>ë¡œ ë§Œë“¦<br><a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>ì˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> í…Œë§ˆ ì‚¬ìš© ì¤‘</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>