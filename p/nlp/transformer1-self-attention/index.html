<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."><title>Transformer(1) - Self-attention</title><link rel=canonical href=https://juijeong8324.github.io/p/nlp/transformer1-self-attention/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Transformer(1) - Self-attention"><meta property='og:description' content="ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."><meta property='og:url' content='https://juijeong8324.github.io/p/nlp/transformer1-self-attention/'><meta property='og:site_name' content="DDubi's World"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='NLP'><meta property='article:tag' content='Deep Learning'><meta property='article:published_time' content='2025-06-21T22:36:00+09:00'><meta property='article:modified_time' content='2025-06-21T22:36:00+09:00'><meta name=twitter:title content="Transformer(1) - Self-attention"><meta name=twitter:description content="ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="ë©”ë‰´ ì—¬ë‹«ê¸°">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_e94bd0a766f2d89e.jpeg width=300 height=235 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>DDubi's World</a></h1><h2 class=site-description>Hello World!</h2></div></header><ol class=menu-social><li><a href=https://github.com/juijeong8324 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>ë‹¤í¬ ëª¨ë“œ</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ëª©ì°¨</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#self-attention>Self-attention</a></li><li><a href=#keys-queries-values>Keys, Queries, Values</a></li><li><a href=#self-attentionì˜-ì¥ë²½-ê·¸ë¦¬ê³ -solutions>Self Attentionì˜ ì¥ë²½.. ê·¸ë¦¬ê³  Solutions!</a><ol><li><a href=#1-ë‹¨ì–´ì˜-ìˆœì„œì—-ëŒ€í•œ-ì •ë³´ê°€-ì•„ì˜ˆ-ì—†ì–ì•„--sequence-order><strong>1. ë‹¨ì–´ì˜ ìˆœì„œì— ëŒ€í•œ ì •ë³´ê°€ ì•„ì˜ˆ ì—†ì–ì•„! : Sequence order</strong></a></li><li><a href=#2-deep-larningì„-ìœ„í•œ-nonlinearitiesê°€-ì—†ì›Œ-ê·¸ëƒ¥-ë‹¨ìˆœíˆ-weighted-í‰ê· ì´ìëƒ--non-linearities><strong>2. Deep Larningì„ ìœ„í•œ nonlinearitiesê°€ ì—†ì›Œ!! ê·¸ëƒ¥ ë‹¨ìˆœíˆ weighted í‰ê· ì´ìëƒ : non-linearities</strong></a></li><li><a href=#3-sequenceë¥¼-ì˜ˆì¸¡í• -ë•Œ><strong>3. sequenceë¥¼ ì˜ˆì¸¡í•  ë•Œ â€œë¯¸ë˜ë¥¼ ë³´ì§€ ì•ŠëŠ”ë‹¤"ëŠ” ë³´ì¥ì´ ìˆë‚˜? : Masking the future in self-attnetion</strong></a></li></ol></li><li><a href=#ì •ë¦¬--self-attentionì„-ìœ„í•œ-building-block>ì •ë¦¬ : Self-attentionì„ ìœ„í•œ building block!</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/nlp/ style=background-color:#2a9d8f;color:#fff>NLP</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/nlp/transformer1-self-attention/>Transformer(1) - Self-attention</a></h2><h3 class=article-subtitle>ë³¸ ê¸€ì€ cs224në¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>6ì›” 21, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 ë¶„ ì •ë„</time></div></footer></div></header><section class=article-content><p>ìš°ë¦¬ê°€ ì•ì—ì„œ Attentionì´ input sequenceë¡œë¶€í„° ì…ë ¥ htì— ì¤‘ìš”í•œ informationì„ ë„˜ê²¨ì£¼ëŠ” ê²ƒì´ë¼ê³  ë°°ì› ë‹¤!Â </p><p>ê·¼ë° RNNë„ ê³¼ê±° ì‹œì ì˜ informationì„ inputë¡œ ì „ë‹¬í•˜ëŠ” ê°™ì€ ëª©ì ì´ ë‹¤!Â </p><p><strong>ê·¸ë ‡ë‹¤ë©´&mldr; RNNì„ êµ³ì´ ì“¸ í•„ìš”ê°€ ìˆì„ê¹Œ?? Attentionì´ ì •ë³´ë¥¼ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ì´ë¼ë©´!</strong>Â </p><p>ê·¸ë˜ì„œ Transformerê°€ ë“±ì¥!</p><h3 id=self-attention>Self-attention</h3><p>Transformerë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” self-attentionì„ ì´í•´í•´ì•¼ í•œë‹¤.Â </p><p><strong>Cross Attention</strong>ì€</p><p>generate ytë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ input xì— attentioní•˜ ê²ƒ! (ì§€ë‚œ ì‹œê°„ ë°°ìš´ attention)</p><p>ì—¬ê¸°ì„œÂ </p><p><strong>Self-Attention</strong>ì€</p><p>ytë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ y&lt;tì— attentioní•˜ëŠ” ê²ƒ!</p><p>ì¦‰, output seqë¥¼ ìƒì„±í•˜ëŠ”ë° í˜„ì¬ ì‹œì  tì˜ ì¶œë ¥ì„ ìƒì„±í•  ë•Œ ì´ì „ ì¶œë ¥ë“¤ì„ ë³´ê³  ìƒì„±í•œë‹¤!Â </p><p>ì´ì „ í† í°ë“¤ì„ ì°¸ê³ í•´ì„œ ì¤‘ìš”ë„ë¥¼ ë”°ì§€ê³  ì´ìš©í•´ì„œ ìƒì„±í•œë‹¤!Â </p><p>[##<em>Image|kage@be8zpa/btsOLD9Pu2C/AAAAAAAAAAAAAAAAAAAAABekskayoAGc-4KwI0taA2S2n5x75RR84yoJp3LmHM5</em>/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=oPXBMgLREoUk%2Bs1lXcOvkMDidx0%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:694,&ldquo;originHeight&rdquo;:431,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}_##]</p><h3 id=keys-queries-values>Keys, Queries, Values</h3><p>ì vocabulary Vì˜ ë‹¨ì–´ sequence w1:nì´ ìˆë‹¤ê³  í•˜ì (e.g Zuko made his uncle tea)</p><p>1. Embedding matrix Eì— ëŒ€í•˜ì—¬ word embeddingìœ¼ë¡œ ë°”ê¾¼ë‹¤.Â </p><p>ê° wi -> xi ë¡œ ë°”ê¿”ì¤€ë‹¤. (Xi = Ewi)</p><p>2. weight Matrix Q, K, Vë¥¼ ê° word embeddingìœ¼ë¡œ ë°”ê¾¼ë‹¤.Â </p><p>[##<em>Image|kage@3bxeM/btsOLCJObQm/AAAAAAAAAAAAAAAAAAAAAPPwJYTdEqOoY-1m_a_89pdr78vQeiFFObvbF_PwsQSB/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=knLrb8DGb9z5D0QLpUUaxb5jFoM%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:704,&ldquo;originHeight&rdquo;:50,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>3. Keyì™€ Queryì˜ similiaitesë¥¼ ê³„ì‚°í•˜ê³  softmaxë¡œ normalizeí•œë‹¤!Â </p><p>[##<em>Image|kage@pu8xq/btsOLhTA3Ic/AAAAAAAAAAAAAAAAAAAAAEdv3PkowQlo4wCjxNURej_xaWUEUbOeP8IDwZKwTaeX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=EzMQQfvZ6qdz2wZnvtl1PM23nNk%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:440,&ldquo;originHeight&rdquo;:95,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>4. ê·¸ê²ƒì„ ê°€ì¤‘í•©í•˜ì—¬ ê³„ì‚°!~~~</p><p>[##<em>Image|kage@brX2hH/btsOMOCt1Ss/AAAAAAAAAAAAAAAAAAAAAFHwzM5XzmrME2N66kQYaip9Xke9JpxQYgjLwixyGUxc/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=kFWt2skh%2Bd33OGIOUrXlvJKV6B4%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:170,&ldquo;originHeight&rdquo;:89,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><h3 id=self-attentionì˜-ì¥ë²½-ê·¸ë¦¬ê³ -solutions>Self Attentionì˜ ì¥ë²½.. ê·¸ë¦¬ê³  Solutions!</h3><h4 id=1-ë‹¨ì–´ì˜-ìˆœì„œì—-ëŒ€í•œ-ì •ë³´ê°€-ì•„ì˜ˆ-ì—†ì–ì•„--sequence-order><strong>1. ë‹¨ì–´ì˜ ìˆœì„œì— ëŒ€í•œ ì •ë³´ê°€ ì•„ì˜ˆ ì—†ì–ì•„! : Sequence order</strong></h4><p>[##<em>Image|kage@ZtbFh/btsOLwJAES9/AAAAAAAAAAAAAAAAAAAAADKFLj7QwjL3cOCIukImqTwR25LakhzG6y-TD18VxGnq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=eJLlud8Oj3YYy2srFT%2F%2F%2BpJp37M%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:473,&ldquo;originHeight&rdquo;:65,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p><strong>Sollutions</strong>: Position representationsì„ inputì— ì¶”ê°€í•´ì¤€ë‹¤!</p><p>ì¦‰, key, query, valueë¥¼ ë§Œë“¤ê¸° ì´ì „ì— input embeddingì— order informationì„ ë¯¸ë¦¬ ë„£ì–´ì¤˜ì•¼ í•œë‹¤!</p><p><strong>poisional encoding</strong>ì¸ vector Pi ëŠ” piê°€ ë¬¸ì¥ì˜ íŠ¹ì • ìœ„ì¹˜(index)ì— ìˆìŒì„ ê°€ë¦¬í‚¨ë‹¤. (ì‹¤ì œë¡œ sin,cos ë¡œ êµ¬ì„±ëœ ê³ ì •ëœ vector ê°’ì„)</p><p>[##<em>Image|kage@VkgXq/btsOMP2sD9u/AAAAAAAAAAAAAAAAAAAAAAasu_r12kGGo8RBan-Ib1umxwTvS6JhqtmjjiuDG94M/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=BeQP0E3V%2B7bN4r5dIH3Y33d8z6U%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:529,&ldquo;originHeight&rdquo;:158,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ì´ë¥¼ input embeddingì— ê·¸ëƒ¥ ë”í•´ì£¼ë©´ ëœë‹¤~~Â </p><p>ê·¸ë˜ì„œ xi~ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ë°˜ì˜í•œ ìµœì¢… embeddingì´ë¯€ë¡œÂ </p><p><strong>positioned embedding</strong>, <strong>positional input</strong>ì´ë¼ê³  ë¶€ë¥¸ë‹¤.Â </p><p><strong>ì–´ë–»ê²Œ Position representationì„ ë§Œë“¤ê¹Œ?</strong>Â </p><p><strong>1. SinusoidalÂ positionÂ representations</strong></p><p>[##<em>Image|kage@c9Vr33/btsOLhzgeUc/AAAAAAAAAAAAAAAAAAAAAJavoxqGN70ZHvmnz&ndash;tohf_l3ngojWt1gVCfmWjyhdx/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=bKmPA5WExLRHkchrf7xjRJVyxkI%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:864,&ldquo;originHeight&rdquo;:209,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>sin, cos í•¨ìˆ˜ë¡œ ë³€í™˜í•´ì„œ ë²¡í„°ë¡œ í‘œí˜„!Â </p><p>ì¥ì </p><p>- vector ì°¨ì›ë§ˆë‹¤ ì£¼ê¸°ì™€ dimensionì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì‹œì ì˜ íŒ¨í„´ì„ í‘œí˜„ ê°„ìœ¼!Â </p><p>- ì™„ì „í•œ ì ˆëŒ€ì  ìœ„ì¹˜ê°€ ì•„ë‹Œ ìƒëŒ€ì  ìœ„ì¹˜ ì°¨ì´(ê°„ê²©)ì´ ë” ì¤‘ìš”í•˜ê²Œ ì‘ë™í•¨!Â </p><p>- ì…ë ¥ sequenceê°€ ê¸¸ì–´ì ¸ë„ íŒ¨í„´ì´ ë°˜ë³µë  ìˆ˜ ìˆë‹¤! ê·¸ë˜ì„œ ì•ˆ ë³¸ ê¸¸ì´ê¹Œì§€ ì¼ë°˜í™”(extrapolation)í•  ìˆ˜ ìˆìŒ!Â </p><p>ë‹¨ì </p><p>- Not learnable: ì™„ì „íˆ ê³ ì •ëœ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì ¸ì„œ, í•™ìŠµ ì¤‘ì— ëª¨ë¸ì´ ììœ ë¡­ê²Œ ì¡°ì •í•˜ê±°ë‚˜ ìµœì í™” X</p><p>- extrapolation ì‚¬ì‹¤ ì•ˆë¨ : ê¸´ ì…ë ¥ì— ëŒ€í•´ì„œ ì„±ëŠ¥ì´ ë˜‘ê°™ì´ ì˜ ì•ˆ ë‚˜ì˜´&mldr;Â </p><p><strong>2. scratch(ì²˜ìŒë¶€í„°, ì œë¡œë¡œ)ë¡œ ë¶€í„° Position representation vectorsë¥¼ í•™ìŠµì‹œí‚¤ì!</strong></p><p>Absolute poistion representationì„ ë°°ìš°ì!</p><p>pië¥¼ í•™ìŠµê°€ëŠ¥í•œ parameterë„ ë‘ì~~ piëŠ” P matrixì˜ matrix columnìœ¼ë¡œ ë‘ì!Â </p><p>ì¥ì </p><p>- ìœ ì—°í•˜ë‹¤.Â </p><p>ë‹¨ì </p><p>- ì¼ë°˜í™” X : ë§Œì•½ í›ˆë ¨ ì‹œ ìµœëŒ€ nì˜ ê¸¸ì´ì¸ ë¬¸ì¥ ë³´ì•˜ëŠ”ë°&mldr; ê·¸ ì´ìƒì˜ ë¬¸ì¥ì´ ë“¤ì–´ì˜¤ë©´?? ì•ˆ ë¨</p><p><strong>3. RoPE : Common, modern position embeddings</strong></p><ul><li><strong>ë‹¤ì‹œ ìƒê°í•´ë³´ì.</strong>Â </li></ul><p>positioned embeddingì„ f(x, i) í˜•íƒœë¡œ relative position embeddingìœ¼ë¡œì„œ ìƒê°í•´ë³´ì.Â </p><p>f(x, i) : ë‹¨ì–´ xì˜ ìœ„ì¹˜ iì—ì„œì˜ embeddingì´ë¼ê³  í•´ë³´ì Â (xëŠ” ë‹¨ì–´, iëŠ” ìœ„ì¹˜)</p><p>[##<em>Image|kage@bmsHwM/btsOMo48Apu/AAAAAAAAAAAAAAAAAAAAABCTMEWbF7JEplWdLSExxE0LJ4etKHholRd305xf5yI2/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=2tUd%2F%2FGuyVAjpc2GWv3hhXMOQY0%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:346,&ldquo;originHeight&rdquo;:79,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ì—¬ê¸°ì„œ Attention function gëŠ”Â  x, yì˜ ì˜ë¯¸ì™€ (i-j)ë¼ëŠ” ìƒëŒ€ì  ìœ„ì¹˜ ì°¨ì´ì—ë§Œ ì˜ì¡´í•´ì•¼ í•œë‹¤!!</p><p>ê¸°ì¡´ì˜ positional embeddingì€ ì´ ëª©í‘œë¥¼ ì¶©ì¡±ì‹œí‚¤ì§€ ëª» í•˜ëŠ”ê°€?Â </p><p>- 1ì˜ ê²½ìš° : ìƒëŒ€ì ì´ì§€ ì•Šì€ ë‹¤ì–‘í•œ cross-termì„ ê°€ì§„ë‹¤. (ì ˆëŒ€ ìœ„ì¹˜ ì •ë³´ê°€ ë”°ë¡œë”°ë¡œ ë°˜ì˜ëœ ê²ƒ)Â </p><p>- 2ì˜ ê²½ìš° : (i-j)ì— ëŒ€í•˜ì—¬ inner productë¡œ í‘œí˜„ë˜ì§€ ì•ŠëŠ”ë‹¤.</p><ul><li>Â <strong>Embedding via rotation</strong></li></ul><p><strong>ìš°ë¦¬ëŠ” position embeddingì´ absolute positionì— ì˜í–¥ì„ ë°›ì§€ ì•Šê²Œ í•˜ê³  ì‹¶ìŒ! -> relative positionìœ¼ë¡œ!</strong>Â </p><p><strong>ìš°ë¦¬ëŠ” inner productsê°€ arbitrary rotationì— ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆì–´! -> ë‚´ì  ê°’ì€ ë™ì¼í•´!</strong>Â </p><p>[##<em>Image|kage@DtFFE/btsOLSr9vWn/AAAAAAAAAAAAAAAAAAAAADePNAOx6AlQof92jWFhowuivem3neJo5rh3uBiwXpN8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=Q0rZ6D1%2F5q6iS2VU%2Fu6AMsCUFts%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:829,&ldquo;originHeight&rdquo;:306,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;,&ldquo;width&rdquo;:677,&ldquo;height&rdquo;:250}</em>##]</p><p><strong>ë‚´ì  ê¸°ë°˜ìœ¼ë¡œ attention scoreë¥¼ ê³„ì‚°í•˜ë©´..! ìƒëŒ€ ìœ„ì¹˜ ê¸°ë°˜ attentionì´ ê°€ëŠ¥í•˜ë‹¤!</strong>Â </p><p>[##<em>Image|kage@1fMUn/btsOKA7fddu/AAAAAAAAAAAAAAAAAAAAAFiY4bPdxRyyNhxboOvoLfxVa_NpvRX9zY2gSX9qV884/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=0Ypa%2B5YtdisnSDC%2BdvW7G6TNGCQ%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:766,&ldquo;originHeight&rdquo;:439,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p>ë”°ë¼ì„œ coordinateë¥¼ ì§ì§€ì–´ì„œ 2D í‰ë©´ì—ì„œ íšŒì „ì‹œì¼œë¼!!! (ì•„ì´ë””ì–´ëŠ” ë³µì†Œìˆ˜ì—ì„œ ë”°ì˜¨ ê²ƒ!!)Â </p><p>ì¦‰ ìœ„ì¹˜ iì— ëŒ€í•˜ì—¬ ë‹¨ì–´ vector xì— ëŒ€í•´ì„œ sin/così„ ê³±í•˜ì—¬ ë²¡í„° ê³µê°„ì—ì„œ íšŒì „ì‹œí‚¤ì!Â </p><p>ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´Â </p><p>ê° ë‹¨ì–´ëŠ” d ì°¨ì›ì˜ Query/Key ë²¡í„°ë¥¼ ê°€ì§„ë‹¤! ê·¸ë¦¬ê³  poisionì´ ì ìš© ëœ í›„ Position embdding(ìœ„ì¹˜ ì •ë³´ê°€ ë‚´ì œëœ) Query/Keyê°€ ìƒì„±ëœë‹¤.Â </p><p>ë‹¨ì–´ Enhancedì— ëŒ€í•œ Queryì™€ Key vector (x1, x2)ê°€ ì¡´ì¬í•˜ê³  position m(indexì„)ì´ ìˆë‹¤.</p><p>ì´ë•Œ Q, K vector(x1, x2)ë¥¼ sin/cos ê¸°ë°˜ìœ¼ë¡œ më§Œí¼ íšŒì „ì‹œí‚¨ë‹¤. ê·¸ëŸ¬ë©´ ë°˜ì˜ì´ ë˜ê³ !!Â </p><p>ê·¸ëŸ¬ë©´!! íšŒì „ì´ ë°˜ì˜ëœ vectorëœ í›„ Enhancedë¼ëŠ” Q ë²¡í„°(ìœ„ì¹˜ 1)ì™€ Rotaryë¼ëŠ” ë‹¨ì–´ì˜ K ë²¡í„°(ìœ„ì¹˜ 4)ê°€ dot productí•˜ì—¬ attention score ê³„ì‚° ì‹œ ìœ„ì¹˜ ì •ë³´ê°€ ë°˜ì˜ì´ ëœë‹¤~~~Â </p><h4 id=2-deep-larningì„-ìœ„í•œ-nonlinearitiesê°€-ì—†ì›Œ-ê·¸ëƒ¥-ë‹¨ìˆœíˆ-weighted-í‰ê· ì´ìëƒ--non-linearities><strong>2. Deep Larningì„ ìœ„í•œ nonlinearitiesê°€ ì—†ì›Œ!! ê·¸ëƒ¥ ë‹¨ìˆœíˆ weighted í‰ê· ì´ìëƒ : non-linearities</strong></h4><p>[##<em>Image|kage@cnQ8RS/btsOLBKXrNm/AAAAAAAAAAAAAAAAAAAAAFKU9q_Lzhwt1sEmCWN69mWDpMJBFc3f2Bne5KxbOL6F/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=PH05iw82z83oI%2Bz%2FWBPsUqLeBgQ%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:684,&ldquo;originHeight&rdquo;:530,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;,&ldquo;width&rdquo;:506,&ldquo;height&rdquo;:392}</em>##]</p><p>Self-attention ë©”ì»¤ë‹ˆì¦˜ ìì²´ì—ëŠ” ë¹„ì„ í˜•ì„± ì´ ì—†ë‹¤&mldr; ì „ë¶€ ì„ í˜• ì—°ì‚°ì„!!</p><p>ë”°ë¼ì„œ Self-attentionë§Œ ê³„ì† ìŒ“ë‹¤ë³´ë©´</p><ul><li>ì´ì „ layerì—ì„œ ì–»ì€ Value vectorë“¤ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ <strong>ì¬í‰ê· (re-averaging)</strong> í•˜ëŠ” ê²ƒì— ë¶ˆê³¼í•˜ê²Œ ë¨</li></ul><p><strong>Solutions</strong>: Self-attention ì´í›„ Feed-Forward networkë¡œ ë¹„ì„ í˜•ì„±ì„ ì¶”ê°€í•˜ì—¬ ê° output vectorë¥¼ ì²˜ë¦¬í•¨!Â </p><p>[##<em>Image|kage@bC9JFW/btsOMaTAZXU/AAAAAAAAAAAAAAAAAAAAAIMhHk4CCtIMmh3ZLczQgxLDfGQkZneu9oxm_6RbHjjj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=ZwTxvW9sZnvB1u21ip%2FiGgjZ8wk%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:492,&ldquo;originHeight&rdquo;:141,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><h4 id=3-sequenceë¥¼-ì˜ˆì¸¡í• -ë•Œ><strong>3. sequenceë¥¼ ì˜ˆì¸¡í•  ë•Œ &ldquo;ë¯¸ë˜ë¥¼ ë³´ì§€ ì•ŠëŠ”ë‹¤"ëŠ” ë³´ì¥ì´ ìˆë‚˜? : Masking the future in self-attnetion</strong></h4><p>ì´ ë§ì€ ì¦‰ìŠ¨, Machine translationì´ë‚˜ Language modelingê³¼ ê°™ì´ ìˆœì°¨ì ì¸ taskì—ì„œ ì•„ì§ ë‚˜ì˜¤ì§€ ì•Šì€ ë‹¨ì–´ë¥¼ ë¯¸ë¦¬ ì°¸ê³ í•˜ë©´ ì•ˆ ëœë‹¤ëŠ” ëœ»!!! (self-attentionì€ input ì „ì²´ë¥¼ í™•ì¸í•˜ë‹ˆê¹Œ!) -> ì¦‰, training í•  ë•Œ! (inferenceëŠ” ì•„ë‹˜!!)Â </p><p>[##<em>Image|kage@ddgVDd/btsOKS0PxOh/AAAAAAAAAAAAAAAAAAAAAOi-yB3vie78rxzMKs93S6BqZjHFUgrvqUUa1bHpPxsR/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=cyvxv8gcPjAo1aOSFR5x51ViWMo%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:704,&ldquo;originHeight&rdquo;:298,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;,&ldquo;width&rdquo;:324,&ldquo;height&rdquo;:137}</em>##]</p><p>DecoderëŠ” ê¸°ë³¸ì ìœ¼ë¡œ self-attentionê³¼ cross-attentionì„ ì‚¬ìš©í•œëŠ”ë°,</p><p>train ë„ì¤‘ì— inputê³¼ targetì„ ëª¨ë‘ ë°›ëŠ”ë‹¤. ì´ë•Œ ë‹¨ì–´ ì˜ˆì¸¡í•˜ëŠ”ë° self-attention ì‹œ target seq ì „ì²´ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ì´ë¥¼ ê°€ë ¤ì•¼ í•¨.</p><p>ê·¸ëŸ¬ë©´ ë§¤ timestepë§ˆë‹¤ keysë“¤ê³¼ querysë¥¼ ë°”ê¿”ì„œ ì´ì „ ë‹¨ì–´ë§Œ ë³´ê²Œ ë§Œë“¤ë©´ ë ê¹Œ? -> Inefficient!</p><p>ë§¤ timestepë§ˆë‹¤ attention ë²”ìœ„ë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì•¼ í•˜ë¯€ë¡œ ë³‘ë ¬ ê³„ì‚°ì´ ë¶ˆê°€ëŠ¥&mldr;Â </p><p>ì¦‰, paralleizationì´ ê°€ëŠ¥í•˜ë ¤ë©´</p><p>- ì „ì²´ seqë¥¼ ë‹¤ ë„£ì€ í›„</p><p>- future ë‹¨ì–´ë“¤ì˜ attention scoresë¥¼ -ë¬´í•œëŒ€ë¡œ ì„¤ì •í•˜ì—¬ attentionì„ mask out ì²˜ë¦¬í•´ì•¼ í•¨!Â </p><p>- softmaxì—ì„œ exp (âˆ’âˆ ) = 0ì´ë¯€ë¡œ ì™„ì „íˆ ë¬´ì‹œëœë‹¤~~</p><p>[##<em>Image|kage@TRTZW/btsOLhF2Z4s/AAAAAAAAAAAAAAAAAAAAADuKmel_ldl2RlpnDJcyRSNAbSZzMBz7mppbBHytCNAl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=9kk6y0Xu1gbYNWN3q28meDty3dY%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:240,&ldquo;originHeight&rdquo;:93,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##][##<em>Image|kage@baAlZ0/btsONayxgTE/AAAAAAAAAAAAAAAAAAAAANjvvtTqGeILUDd_ZK6OgOMF1lUF9iu1TwhfAOM-A1J5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=bow2jZu5lSfPkPtaH5X1Y6%2F0soM%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:729,&ldquo;originHeight&rdquo;:587,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;,&ldquo;width&rdquo;:507,&ldquo;height&rdquo;:408}</em>##]</p><p><strong>Solutions</strong>: attention weightë¥¼ 0ìœ¼ë¡œ ì¼ë¶€ëŸ¬ ë§Œë“¤ì–´ì„œ ë¯¸ë˜ë¥¼ mask outí•œë‹¤.Â </p><h3 id=ì •ë¦¬--self-attentionì„-ìœ„í•œ-building-block>ì •ë¦¬ : Self-attentionì„ ìœ„í•œ building block!</h3><p>[##<em>Image|kage@brSmTy/btsOKUdjH2z/AAAAAAAAAAAAAAAAAAAAAMg4S7fYAb3shTEAmgIlyP-GYvVUNOoPsSiBoIg6-Gct/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1761922799&amp;allow_ip=&amp;allow_referer=&amp;signature=oG%2FancrmYQbbA1RrMiYyw7MZXLc%3D|CDM|1.3|{&ldquo;originWidth&rdquo;:405,&ldquo;originHeight&rdquo;:605,&ldquo;style&rdquo;:&ldquo;alignCenter&rdquo;}</em>##]</p><p><strong>1. self-attention</strong>Â </p><p><strong>2. Position representations</strong></p><p>seq orederë¥¼ êµ¬ì²´í™”í•˜ê¸° ìœ„í•´ì„œ! self-attentionì€ inputì˜ ìˆœì„œë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—!Â </p><p><strong>3. nonlineariies</strong></p><p>self-attention blockì˜ outputì— Feed Forwar newrokë¥¼ êµ¬í˜„!</p><p><strong>4. Masking</strong></p><p>ë¯¸ë˜ë¥¼ ë³´ì§€ ì•Šê³  parallize ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œÂ </p><ul><li>ë¯¸ë˜ì— ìƒì„±ë¼ì•¼ í•  ë‹¨ì–´ì˜ ì •ë³´ê°€</li><li><strong>ì• ë‹¨ì–´ ì˜ˆì¸¡ ê³¼ì •ì— í˜ëŸ¬ ë“¤ì–´ê°€ë©´ ì•ˆ ë¨</strong> âŒ</li><li>Maskingì€ ì´ëŸ° **ì •ë³´ ëˆ„ì¶œ(leakage)**ì„ ë§‰ì•„ì¤Œ</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/nlp/>NLP</a>
<a href=/tags/deep-learning/>Deep Learning</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ê´€ë ¨ ê¸€</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/nlp/pretraining/><div class=article-details><h2 class=article-title>Pretraining</h2></div></a></article><article><a href=/p/nlp/transformer-encoder/><div class=article-details><h2 class=article-title>Transformer - Encoder</h2></div></a></article><article><a href=/p/nlp/transformer-decoder/><div class=article-details><h2 class=article-title>Transformer - Decoder</h2></div></a></article><article><a href=/p/nlp/attention/><div class=article-details><h2 class=article-title>Attention</h2></div></a></article><article><a href=/p/nlp/machine-translation-mt%EC%9D%98-%EB%B0%9C%EC%A0%84/><div class=article-details><h2 class=article-title>Machine Translation (MT)ì˜ ë°œì „</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 DDubi's World</section><section class=powerby><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>ë¡œ ë§Œë“¦<br><a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>ì˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> í…Œë§ˆ ì‚¬ìš© ì¤‘</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>