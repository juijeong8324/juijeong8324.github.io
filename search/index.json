[{"content":"1. Subword modeling ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ê¸°Â [##Image|kage@bO6314/btsO5L1bTW2/AAAAAAAAAAAAAAAAAAAAAGRPfPUE5tQq1W_Qa92a8ZA-rJdGPLmE4vFSLj_KMfxw/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=xr0cD%2FJl2O0ronELf5POn%2FTFJqs%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:1046,\u0026ldquo;originHeight\u0026rdquo;:319,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\në¨¼ì €, ìš°ë¦¬ì˜ languageì˜ vocabularyë¥¼ ë§Œë“¤ ë•Œ ë‹¤ìŒê³¼ ê°€ì •ì„ í•œë‹¤ê³  í•˜ì.Â training setìœ¼ë¡œ ë¶€í„° ë§Œë“¤ì–´ì§„, ìˆ˜ ì²œê°œì˜ wordsë¡œ ì´ë£¨ì–´ì§„ fixed vocabê°€ ìˆê³ ,\ntest timeì— ì²˜ìŒ ë³¸ ëª¨ë“  wordë“¤ì— ëŒ€í•´ì„œ single UNKë¡œ mapping í•œë‹¤ê³  ê°€ì •í•œë‹¤.Â ì´ ìƒí™©ì—ì„œ, subwordì˜ modelingì€ word levelë³´ë‹¤ ë” ì‘ì€ structure (Parts of words, characters, bytes) ë¥¼ ê³ ë ¤í•˜ëŠ” ë‹¤ì–‘í•œ method ë°©ë²•ë“¤ì„ í¬í•¨í•œë‹¤!Â í˜„ëŒ€ NLPì—ì„œëŠ” subword tokensìœ¼ë¡œ êµ¬ì„±ëœ vocabularyë¥¼ í•™ìŠµí•˜ëŠ” ë°©ì‹ì´ ì§€ë°°ì ì´ë‹¤.Â trainingê³¼ testing ì‹œ ê° wordëŠ” vocabularyì— ì•Œë ¤ì§„ subwordë“¤ì˜ sequenceë¡œ ë¶„í• ëœë‹¤.Â The byte-pair encoding(BPE) algorithmÂ ì´ë•Œ, BPEëŠ” subword vocabularyë¥¼ ì •ì˜í•˜ê¸° ìœ„í•œ effective strategy ë¼ê³  í•  ìˆ˜ ìˆë‹¤!!Â 1. init vocabulary : ëª¨ë“  ë¬¸ìë¥¼ ê° characterë“¤ê³¼ ë‹¨ì–´ ë(end-of-word) symoblë§Œ í¬í•¨\n2. textì˜ corpusë¥¼ ë³´ë©´ì„œ ê°€ì¥ ìì£¼ í•¨ê»˜ ë“±ì¥í•˜ëŠ” character ìŒ \u0026ldquo;a, b\u0026quot;ë¥¼ ì°¾ì•„ì„œ \u0026ldquo;ab\u0026quot;ë¥¼ subwordë¡œ ì¶”ê°€Â 3. í•´ë‹¹ charcter pairë¥¼ new subwordë¡œ replace, ì´ë•Œ vocab sizeë¡œ ë„ë‹¬í•  ë•Œê¹Œì§€ ë°˜ë³µ!!!Â ê·¼ë° ì´ ë°©ì‹ì€.. ì´ˆê¸° machine translationê³¼ ê°™ì€ NLPì—ë§Œ ì‚¬ìš©ë˜ì—ˆìŒ!!Â í˜„ì¬ëŠ” WordPiece(í™•ë¥  based) ì™€ ê°™ì€ methodê°€ pretrained modelì—ì„œ ì‚¬ìš©ë˜ê³  ìˆìŒ!!1Â - WordPiece?? byte coding ìì„¸í•œ ê±´\n[##Image|kage@bgcmpl/btsO6rA7437/AAAAAAAAAAAAAAAAAAAAAN1b4Om0TbnQVPR2anMt7BwNRYiZ1lLCWBr69jOQT1YB/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=zlcbvOh1sPsfw%2FXHI3cJtTFwdCU%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:738,\u0026ldquo;originHeight\u0026rdquo;:223,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nëŒ€ë¶€ë¶„ì˜ wordë“¤ì€ subword vocabularyì˜ ì¼ë¶€ì— í¬í•¨ë˜ê² ì§€ë§Œ,, ë“œë¬¸ wordë“¤ì€ componentë¡œ ë¶„ë¦¬ëœë‹¤\u0026hellip;\nì•„ì£¼ ì•ˆ ì¢‹ì€ ê²½ìš°ì—ëŠ” wordê°€ ì•„ì£¼ ë§ì€ subwordsë¡œ ë¶„ë¦¬ë  ìˆ˜ë„ ìˆë‹¤ëŠ” ì‚¬ì‹¤\u0026hellip;Â 2. Motivating model pretraining from word embeddings ê·¸ë˜ì„œ..!Â 4. Model pretraining three ways 4-1. Decoders\n4-2. Encoders\n4-3. Encoder-Decoders\n5. Interlude: what do we think pretraining is teaching? 6. Very Large models and in-context learning ","date":"2025-07-06T19:14:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/pretraining/","title":"Pretraining"},{"content":"[##Image|kage@ts3IR/btsOMTqkBt1/AAAAAAAAAAAAAAAAAAAAAO5eCa8c7NYTnezb7sEzqKBacKSPresrBDlEMbGfNoLD/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=W679xjbXXwiqbkktqAK99VZUDmE%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:602,\u0026ldquo;originHeight\u0026rdquo;:667,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:425,\u0026ldquo;height\u0026rdquo;:471}##]\nTransformer DecoderëŠ” **language modelì²˜ëŸ¼ ë‹¨ë°©í–¥(unidirectional) contextë§Œì„ ì‚¬ìš©í•˜ë„ë¡ contraint(ì œí•œ)**í•œë‹¤.Â -\u0026gt; ì¦‰ ê³¼ê±°(ì™¼ìª½) ì •ë³´ë§Œ ë³´ê³  ë¯¸ë˜(ì˜¤ë¥¸ìª½)ëŠ” ë³´ì§€ ì•ŠëŠ”ë‹¤.Â -\u0026gt; ì´ëŠ” Langue modelì²˜ëŸ¼ ë‹¤ìŒì— ì˜¬ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” task\nê·¸ëŸ¬ë©´ ìš°ë¦¬ëŠ” bidirectional contextë¥¼ ì›í•˜ë©´ ì–‘ë°©í–¥ RNNì²˜ëŸ¼ í•˜ë©´ ë ê¹Œ?Â ê·¸ëŸ´ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´!!!!! Transformer Encoderì´ë‹¤!\n-\u0026gt; ì´ëŠ” ë¬¸ì¥ ì´í•´, ë¶„ë¥˜ì— ì í•©í•œ taskÂ Decoderì™€ì˜ ìœ ì¼í•œ ì°¨ì´ì ì€ self-attentionì—ì„œ maskingì„ ì œê±°í•œë‹¤ëŠ” ê²ƒ..! (ì¦‰, ëª¨ë“  ë‹¨ì–´ë¥¼ ë™ì‹œì— ë³¸ë‹¤!)Â The transformer Encoder-Decoder [##Image|kage@EsUBF/btsOMe2P77d/AAAAAAAAAAAAAAAAAAAAAMMZMPLAgERAICX1MeRLDaUvqrufJ3FCTwJ4Acj8HCpg/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=lSVxZmTQSeho1FJ6UDsGGzTTBM0%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:648,\u0026ldquo;originHeight\u0026rdquo;:694,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:381,\u0026ldquo;height\u0026rdquo;:408}##]\nMachine translationì„ íšŒê¸°í•˜ë©´,,Â ìš°ë¦¬ëŠ” bidirectional modelì—ì„œ source sentenceë¥¼ ì²˜ë¦¬í–ˆê³ , unidirectional modelì—ì„œ targetì„ ìƒì„±í–ˆë‹¤!Â seq2seq formatì˜ ì‘ì—…ì—ì„œëŠ”\u0026hellip; ì´ë ‡ê²Œ Transformer Encoder-Decoder êµ¬ì¡°ë¥¼ ì‚¬ìš©í•œë‹¤!!!!!\nEncoder\nì¼ë°˜ì ì¸ Transformer Encoderë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš© Decoder\nEncoderì˜ ì¶œë ¥ì— ëŒ€í•´ cross-attentionì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ì •ëœë‹¤. DecoderëŠ” self-attentionìœ¼ë¡œ ìê¸° ìì‹ ë§Œ ë³´ëŠ”ê²Œ ì•„ë‹ˆë¼, Encoderê°€ ë§Œë“  input ë¬¸ì¥ì˜ contextë¥¼ ì°¸ê³ í•´ì„œ ë²ˆì—­ì„ ìƒì„±Â Cross-attention (details) [##Image|kage@c0gxt1/btsOMku0Kfk/AAAAAAAAAAAAAAAAAAAAABG7eNvJgk9_dlDwwjsrY0PNbkeQG-hXvdGsIMMsGfdq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=Wz7T1TPA5m%2BSrkRUCGrk21%2FpPg4%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:597,\u0026ldquo;originHeight\u0026rdquo;:482,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:382,\u0026ldquo;height\u0026rdquo;:308}##]\nself-attentionì€ ê°™ì€ sourceì—ì„œ keys, queries, valuesê°€ ë§Œë“¤ì–´ì§ˆ ë•Œë¥¼ ë§í•œë‹¤.\nì¦‰, Encoder ë‚´ë¶€, Decoder ë‚´ë¶€Â Decoderì—ì„œëŠ” self-attentionë„ ìˆì§€ë§Œ, ë‹¤ë¥¸ sourceë¥¼ ë°”ë¼ë³´ëŠ” attentionë„ ìˆë‹¤!(ì €ë²ˆ ì‹œê°„ì— ë°°ì›€) ê·¸ê²Œ ë°”ë¡œ cross-attention\nh1, \u0026hellip; , hn: Transformer encoder ë¡œ ë¶€í„° ì–»ì€ output vector(hidden state)Â ğ‘¥ğ‘–âˆˆâ„ğ‘‘ z1, \u0026hellip; , zn: Transformer decoderë¡œ ë¶€í„° ì–»ì€ input vector(ì¦‰, ì´ë¯¸ ìƒì„±ëœ ë‹¨ì–´ë“¤ì˜ hidden state)Â ğ‘§ğ‘–âˆˆâ„ğ‘‘ ì—¬ê¸°ì„œ keysì™€ valuesëŠ” encoderì˜ ì¶œë ¥ hiì—ì„œ ê³„ì‚°\nì¦‰ EncoderëŠ” ì¼ì¢…ì˜ memory ê°™ì€ ëŠë‚ŒÂ ğ‘˜ğ‘–=ğ¾â„ğ‘–,Â ğ‘£ğ‘–=ğ‘‰â„ğ‘–\nqueriesëŠ” decoderë¡œ í˜„ì¬ ì…ë ¥ ziì—ì„œ ê°€ì ¸ì˜¨ ê²ƒÂ ğ‘ğ‘–=ğ‘„ğ‘§ğ‘–.\nê·¸ë‹ˆê¹Œ ì •ë¦¬í•˜ìë©´\u0026hellip; queryëŠ” decoderì˜ input ìš°ë¦¬ê°€ ì§‘ì¤‘í•´ì„œ ë³´ê³  ì‹¶ì€ ê²ƒë“¤ì€ encoderì˜ inputì´ê³ , keyì™€ valueì— í•´ë‹¹Â ì¦‰ Decoderê°€ Encoderì˜ ì¶œë ¥ì— ëŒ€í•´ attention ì„ ë‚ ë¦¬ëŠ” ê²ƒ! ì°¸ì¡°í•˜ë©° ë¬¸ì¥ì„ ìƒì„±í•  ìˆ˜ ìˆê²Œ!!\nCross-attentionì´ ê³„ì‚°ë˜ëŠ” ê³¼ì •Â [##Image|kage@leV61/btsOLl2zPW4/AAAAAAAAAAAAAAAAAAAAAIA7cXyO2OQFSby4v8-pcRp2XmxzWFnaRyUMSH9ihgPv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=V2xFp9KXOuxlWZ8yLjJQZxeZ4EI%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:309,\u0026ldquo;originHeight\u0026rdquo;:88,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nHëŠ” encoder vectorì˜ concatenaton!Â ZëŠ” dcoder vectorì˜ concatenation!\nì—¬ê¸°ì„œ TëŠ” encoderì˜ ê¸¸ì´ ë˜ëŠ” decoderì˜ ê¸¸ì´ ì¤‘ í•˜ë‚˜ì¼ ìˆ˜ ìˆëŠ”ë°, ë¬¸ë§¥ìƒ ë‘˜ ë‹¤ Të¡œ í‘œê¸°í•œ ê±°ì§€ ì‹¤ì œë¡œëŠ” ë‹¤ë¥¼ ìˆ˜ ìˆì–´.\nì˜ˆë¥¼ ë“¤ì–´: ì˜ì–´ ì…ë ¥(5ë‹¨ì–´) â†’ í”„ë‘ìŠ¤ì–´ ì¶œë ¥(7ë‹¨ì–´)ì´ë¼ë©´ Encoder: Tâ‚ = 5, Decoder: Tâ‚‚ = 7 [##Image|kage@cgCHrb/btsOMFyVJLj/AAAAAAAAAAAAAAAAAAAAAAfCTekS-Os5iVz3UuE7abPQNnIuvyBsZc7hVMY0M0_8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=YXRMdc7KiYsDXz9NJeiVHIeoqbY%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:470,\u0026ldquo;originHeight\u0026rdquo;:43,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\ndecoder vectorì— Queryë¥¼ ê³±í•˜ê³ Â encoder vectorì— Keyë¥¼ ê³±í•œ í›„Â ê·¸ ë‘˜ì„ ê³„ì‚°í•˜ì—¬ Attention scoreë¥¼ ê³„ì‚° ì´ë¥¼ softmaxë¡œ í†µê³¼í•˜ì—¬ attention distribution ì¦‰, ê°€ì¤‘ì¹˜ë¥¼ ë§Œë“¤ì–´ ë‚´ê³ Â ì´ë¥¼ encoder vectorì˜ valueë“¤ì— ê³±í•œë‹¤!!Â [##Image|kage@bWv0Qu/btsOMcjF5EO/AAAAAAAAAAAAAAAAAAAAAAhMLglNh1dZVXt4HF_o3G49dac-4pEB-YMPtuY9VRzM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=zYlrTVAYTUG9f8kFM%2FnQL5qPDZw%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:717,\u0026ldquo;originHeight\u0026rdquo;:373,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:655,\u0026ldquo;height\u0026rdquo;:341}##]\nì„±ëŠ¥ì„ ë´…ì‹œë‹¤.Â Machine TranslationÂ [##Image|kage@dppGcu/btsOM4d8Xmw/AAAAAAAAAAAAAAAAAAAAACowHO3mblz7Wo1-iI1Hmsj7koe4pZuJDAQPs4JihY85/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=q2ltKQI0%2BhF8IirfD2IfJfixqIg%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:904,\u0026ldquo;originHeight\u0026rdquo;:324,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\ndocument generation\n[##Image|kage@cH560F/btsOLFmjPYx/AAAAAAAAAAAAAAAAAAAAAOP0FZ61m9K6cZ_N3KXJbor5XqMzgrXt2snrP6Ye7Nwv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=j8JxrmMrQuHJFhW3LlvSN80Bt5U%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:1068,\u0026ldquo;originHeight\u0026rdquo;:399,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nTransformerëŠ” ë³‘ë ¬ì²˜ë¦¬ê°€ ì˜ ë˜ê¸° ë•Œë¬¸ì— pre-trainingìœ¼ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê³ , ì‚¬ì‹¤ìƒ NLPì˜ í‘œì¤€ì´ ë˜ì—ˆë‹¤.Â Transformerì˜ í•œê³„Â 1. Training instabilities (Pre vs Post norm)\ntrainingì´ ë¶ˆì•ˆì •í•¨! íŠ¹íˆ LayerNormì„ ì–´ë””ì— ë„£ëŠëƒì— ë”°ë¼ í•™ìŠµ ì•ˆì •ì„±ì´ ë‹¬ë¼ì§\nPre-norm: LayerNormì„ Residual ì „ì— ì ìš© (ìš”ì¦˜ ì´ ë°©ì‹ì´ ë” ì•ˆì •ì ì„) Post-norm: Residual í›„ì— ì ìš© (ì´ˆê¸° Transformer ë…¼ë¬¸ ë°©ì‹) [##Image|kage@wZUBY/btsOMjJFANk/AAAAAAAAAAAAAAAAAAAAACaRrxSwZ-2TCwVSz2LENOjyyg5tRODrIAzZ62b7-54O/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=rZUnNPBpCdLtNZdbLYrXb%2BJjxOY%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:986,\u0026ldquo;originHeight\u0026rdquo;:543,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:566,\u0026ldquo;height\u0026rdquo;:312}##]\n2. Quadratic comput in self-attentionÂ self-attention ì€ ê³„ì‚°ëŸ‰ì´ sequence ê¸¸ì´ì˜ ì œê³±ì— ë¹„ë¡€í•¨Â ì™œëƒí•˜ë©´\nëª¨ë“  tokenìŒë§ˆë‹¤ attentionì„ ê¼ì‚°í•˜ê¸° ë•Œë¬¸ì— O(n^2) ì„\nê·¼ë° ì™œ ì¨??? Transformerê°€ ì»¤ì§ˆ ìˆ˜ë¡ ì „ì²´ ê³„ì‚°ì—ì„œ self-attentionì´ ì°¨ì§€í•˜ëŠ” ë¹„ì¤‘ì´ ì ì  ì¤„ì–´ë“ ë‹¤. ì¦‰ self-attention ê³„ì‚°ì€ ì—¬ì „íˆ ëŠë¦¬ì§€ë§Œ, ì „ì²´ ëª¨ë¸ ê³„ì‚° ì¤‘ ì¼ë¶€ì¼ ë¿Â - ê²Œì‚°ì„ ì¤„ì´ë ¤ê³  ë§Œë“  ì €ë ´í•œ(íš¨ìœ¨ì ì¸) Self-Attention ë°©ë²•ë“¤ì€\nâ†’ ëª¨ë¸ì´ ì»¤ì§ˆìˆ˜ë¡ ì„±ëŠ¥ì´ ë³„ë¡œ ì•ˆ ì¢‹ìŒ.\nâ†’ ê·¸ë˜ì„œ ì‹¤ì œ ëŒ€í˜• ëª¨ë¸ì—ëŠ” ì˜ ì•ˆ ì“°ì¸ë‹¤.\n- Systems optimizations work well (FlashAttention â€“ Jun 2022)\nâ†’ ê·¸ë˜ì„œ ì•Œê³ ë¦¬ì¦˜ì„ ë°”ê¾¸ëŠ” ëŒ€ì‹ ,\nâ†’ ê¸°ì¡´ Attentionì„ ë” ë¹ ë¥´ê²Œ êµ¬í˜„í•œ ìµœì í™” ê¸°ìˆ ì´ ë§ì´ ì“°ì„.\nì .ì‹œ.ë§Œ Encoder-Decoder êµ¬ì¡°ì—ì„œ Decoderì˜ ì…ë ¥ì´ Encoderì˜ outputì´ ì•„ë‹ˆì—ˆì–´??? âœ… Transformerì˜ DecoderëŠ” Encoderì˜ ì¶œë ¥ì„ \u0026ldquo;ì§ì ‘ ì…ë ¥ìœ¼ë¡œ ë°›ëŠ” ê²Œ ì•„ë‹ˆë¼\u0026rdquo;, Cross-Attentionì„ í†µí•´ \u0026ldquo;ì°¸ì¡°\u0026quot;ë§Œ í•´.\nì¦‰:\nDecoderì˜ ì…ë ¥ì€ \u0026ldquo;ìƒì„± ì¤‘ì¸ ë¬¸ì¥\u0026quot;ì´ê³ ,\nEncoderì˜ ì¶œë ¥ì€ \u0026ldquo;ì°¸ì¡° ëŒ€ìƒ\u0026quot;ì¼ ë¿ì´ì•¼.\nğŸ” ì •ë¦¬í•´ë³´ì: Transformer Encoder-Decoder êµ¬ì¡°ì—ì„œì˜ ì—­í•  ì»´í¬ë„ŒíŠ¸ì…ë ¥ì²˜ë¦¬ì¶œë ¥\nEncoder ì „ì²´ source ë¬¸ì¥ (ex: ì˜ì–´) Full self-attention ë¬¸ì¥ ì „ì²´ì˜ ì˜ë¯¸ ë²¡í„° Decoder ì§€ê¸ˆê¹Œì§€ ìƒì„±ëœ target ë¬¸ì¥ (ex: ë¶ˆì–´ ì¼ë¶€) Masked self-attention + Cross-attention ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡ ğŸ“Œ ì¤‘ìš”í•œ êµ¬ë¶„ âŒ Decoderì˜ ì…ë ¥ì´ \u0026ldquo;Encoder ì¶œë ¥\u0026quot;ì´ë¼ëŠ” ì˜¤í•´ âŒ DecoderëŠ” Encoderì˜ ì¶œë ¥ ë²¡í„°ë“¤ì„ inputìœ¼ë¡œ \u0026ldquo;ë„£ëŠ”\u0026rdquo; ê²Œ ì•„ë‹˜ âŒ DecoderëŠ” Encoderì˜ ì¶œë ¥ì„ ë¬¸ì¥ì²˜ëŸ¼ \u0026ldquo;feeding\u0026quot;í•˜ì§€ ì•ŠìŒ âœ… ì‹¤ì œ êµ¬ì¡°ëŠ” ì´ë ‡ê²Œ ìƒê²¼ì–´: Decoder ë‚´ë¶€ì—ëŠ” ë‘ ê°œì˜ Attention Layerê°€ ìˆìŒ: Masked Self-Attention\nâ†’ ì§€ê¸ˆê¹Œì§€ ìƒì„±í•œ ë‹¨ì–´ë“¤ë¼ë¦¬ë§Œ ì°¸ê³ \nâ†’ ë¯¸ë˜ ë‹¨ì–´ëŠ” ê°€ë ¤ì ¸ ìˆìŒ Cross-Attention\nâ†’ Encoderì˜ ì¶œë ¥ ì „ì²´ë¥¼ ì³ë‹¤ë³´ë©´ì„œ í•„ìš”í•œ ì •ë³´ ì°¸ì¡°\nâ†’ ì¦‰, Decoderì˜ Queryê°€ Encoderì˜ Key/Valueë¥¼ \u0026ldquo;attend\u0026quot;í•˜ëŠ” êµ¬ì¡° ğŸ¯ ë‹¤ì‹œ ë§í•´ ìš”ì•½í•˜ë©´ DecoderëŠ” Encoderì˜ ì¶œë ¥ì„ inputì²˜ëŸ¼ ë°›ëŠ” ê²Œ ì•„ë‹ˆë¼, cross-attentionì˜ ëŒ€ìƒ(memory bank)ìœ¼ë¡œ í™œìš©í•œë‹¤.\nDecoderì˜ ì‹¤ì œ ì…ë ¥ì€ ì§€ê¸ˆê¹Œì§€ ìƒì„±í•œ target tokenë“¤ì´ì•¼.\nğŸ’¡ ì‹œê°ì ìœ¼ë¡œ ê·¸ë ¤ë³´ë©´: css\në³µì‚¬í¸ì§‘\n\\[ì…ë ¥ ë¬¸ì¥ (source)\\] â†’ \\[Encoder\\] â†’ context representations â†‘ \\[Decoder â† ì´ì „ ë‹¨ì–´ë“¤\\] â†’ Masked self-attention â†“ Cross-attention to Encoder output â†“ ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡ (one token at a time)\n","date":"2025-06-22T15:45:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/transformer-encoder/","title":"Transformer - Encoder"},{"content":"TransformerëŠ” Decoderì™€ EncoderÂ êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤..! ì•ì—ì„œ ë°°ìš´ í•µì‹¬ ê°œë…ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ê° êµ¬ì¡°ë¥¼ ìì„¸íˆ ì•Œì•„ë³´ë„ë¡ í•˜ì.Â Transformer Decoder [##Image|kage@bU8qFf/btsOKCcUETl/AAAAAAAAAAAAAAAAAAAAANxHlKSJS4OWqoujltyGRQZCjz-0SeP4dPPdkvWSJj4Q/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=eYzKHUr9ewovgtCNHcXFdQL0lSQ%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:426,\u0026ldquo;originHeight\u0026rdquo;:594,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:255,\u0026ldquo;height\u0026rdquo;:356}##]\nì‰½ê²Œ ìƒê°í•´ì„œ Language modelsì²˜ëŸ¼ ì–´ë–»ê²Œ ìš°ë¦¬ê°€ systemsì„ buildí• ê¹Œë¥¼ ìƒê°í•˜ë©´ ëœë‹¤.Â minimal self-attention architectureë¡œ ë³´ì´ì§€ë§Œ, ì‚¬ì‹¤ ì¢€ ë” ë§ì€ componentê°€ ìˆë‹¤!Â - Embeddingsì™€ Position EmbeddingsëŠ” ë™ì¼í•˜ë‹¤.Â 1. Multi-head AttentionÂ ë¨¼ì € self-attentionì´ ì•„ë‹Œ multi-head self-attetionì´ë„¤..?\n[##Image|kage@JZfkN/btsOLeP8Om5/AAAAAAAAAAAAAAAAAAAAAG8vKO-oE3BZoqxfdNLP0Uk8-Drz3pCbja42a7Rje257/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=FxRnVrMw6ZV7WPJmfY2nPPglNQg%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:1048,\u0026ldquo;originHeight\u0026rdquo;:528,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:775,\u0026ldquo;height\u0026rdquo;:390}##]\nì—¬ê¸°ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì‚¬ì‹¤.. HeadëŠ” ë¬´ì—‡ì„ attention í•  ê²ƒì¸ì§€ë¥¼ ê²°ì •í•´ì£¼ëŠ” ê²ƒì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.Â ìš°ì„ \u0026hellip; Attentionì´ ê³„ì‚°ë˜ëŠ” ê³¼ì •ì„ ì•Œì•„ë³´ì!Â Matricesì—ì„œ key-query-value attentionì´ ì–´ë–»ê²Œ ê³„ì‚°ë˜ëŠ” ì§€ ë´…ì‹œë‹¤\u0026hellip;\nInputInput vectorsì˜ concatenationë¼ê³  í•  ìˆ˜ ìˆë‹¤.Â X = \\[x1; ... ; xn\\] âˆˆ â„ğ‘›Ã— ğ‘‘ (í–‰ì´ nê°œ, ì—´ì´ dê°œ; ì¦‰, nì€ ë‹¨ì–´ì˜ ê°œìˆ˜ dëŠ” ì°¨ì›) Output\nsoftmax(XQ(XK)T)XV âˆˆâˆˆâ„ğ‘›Ã—ğ‘‘\nì´ë•Œ, ğ‘‹ğ¾ âˆˆ â„ğ‘›Ã—ğ‘‘, ğ‘‹ğ‘„ âˆˆ â„ğ‘›Ã—ğ‘‘, ğ‘‹ğ‘‰ âˆˆ â„ğ‘›Ã—ğ‘‘ 1. Query-Key dot products : ğ‘‹ğ‘„Â ğ‘‹ğ¾Â âŠ¤\n[##Image|kage@bHygVe/btsOMHpR4u6/AAAAAAAAAAAAAAAAAAAAAJQHdXe472r-kBNk9-TJICHeLE0lO-blGYRs7X__jwwM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=27m1ZJXKwrOLB5luicgVpt2yEcU%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:668,\u0026ldquo;originHeight\u0026rdquo;:172,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì¦‰ ê²°ê³¼ëŠ” ì‰½ê²Œ ìƒê°í•´ì„œ ê° Query ë²¡í„°ì™€ ê° Key ë²¡í„° ê°„ì˜ dot productì˜ ê°’ì„ ëª¨ë‘ êµ¬í•œ matrixë¼ê³  ë³´ë©´ ëœë‹¤..!Â ê²°ê³¼ matrixì˜ (i,j)ì˜ ê°’ì€ Qì˜ ië²ˆì§¸ í–‰(ië²ˆì§¸ wordì˜ Query) Kì˜ jë²ˆì§¸ ì—´(jë²ˆì§¸ wordì˜ Key)ì˜ dot product (í˜„ì¬ Queryê°€ Keyë¥¼ ì–¼ë§ˆë‚˜ ì°¸ê³ í•˜ëŠ”ê°€?) ë¼ê³  ë³´ë©´ ëœë‹¤!! ê·¸ë¦¬ê³ í•œ í–‰ì´ Queryì— ëŒ€í•œ ë‹¤ë¥¸ keyì˜ attention scoreê°€ ëœë‹¤.Â [##Image|kage@XI3Hz/btsOKK9wXI7/AAAAAAAAAAAAAAAAAAAAAMmmaeiAuZCsfruzcRqCSsGtNYOyLw-ytHZSWZgzwZ_u/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=nFFGzsI2B7YglWAhS%2FfDo59dIzw%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:684,\u0026ldquo;originHeight\u0026rdquo;:194,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê·¸ë¦¬ê³  softmaxë¥¼ ì ìš©í•˜ë¨„,\nê° í–‰ì€ Query ìœ„ì¹˜ iê°€ ì „ì²´ Keyë“¤(j=1~n)ì— ëŒ€í•´ attentioní•˜ëŠ” ê°€ì¤‘ì¹˜\nì´ë¥¼ V(ê° wordì˜ ì‹¤ì œ ì •ë³´)ì— ê³±í•˜ì—¬ weighted averageë¥¼ ê³„ì‚°í•œë‹¤!Â softmax ê²°ê³¼ì˜Â í•œ í–‰ (ì¦‰, Queryê°€ ë³´ëŠ” attention weight)\nì™€ Vì˜ í•œ ì—´ (íŠ¹ì • ì˜ë¯¸ ì°¨ì›ë§Œ ë‹´ê³  ìˆìŒ)ì„ ê³±í•˜ë©´\nê³¼ì—° ì´ê²Œ ë¬´ìŠ¨ ì˜ë¯¸ì§€?â€\nSoftmaxí•œ í•œ í–‰ Ã— Vì˜ í•œ ì—´ =\n\u0026ldquo;ì´ Queryê°€ í•´ë‹¹ ì˜ë¯¸ ì°¨ì›ì— ëŒ€í•´ ì–¼ë§ˆë‚˜ ì •ë³´ë¥¼ ëŒì–´ì™”ëŠ”ê°€?\u0026rdquo;\nê·¸ë¦¬ê³  ê·¸ê±¸ d_v ê°œ ì°¨ì›ì— ëŒ€í•´ ëª¨ë‘ ê³„ì‚°í•˜ë‹ˆê¹Œ\nâ†’ ië²ˆì§¸ Queryì˜ context vectorê°€ ë‚˜ì˜¤ëŠ” ê±°ì˜ˆìš”!\nì¦‰ ê²°ê³¼ matrixì˜ (i, j)ì˜ ê°’ì€ í•œ wordì˜ Attention ê°€ì¤‘ì¹˜ì— ëŒ€í•˜ì—¬ ë‹¤ë¥¸ wordë“¤ì— ëŒ€í•´ ê³±í•˜ì—¬ ë”í•œ ê°’(ì´ë•Œ ë‹¤ë¥¸ wordì˜ ì¼ë¶€ ì°¨ì›ë§Œ ê³±í•œ ê²ƒ)Â ë”°ë¼ì„œ ië²ˆì§¸ í–‰ì€ ì „ì²´ contextì„!!\në§Œì•½ ìš°ë¦¬ê°€ í•œ sentenceì—ì„œ ì—¬ëŸ¬ ìœ„ì¹˜ë¥¼ í•œë²ˆì— ë³´ê³ ì‹¶ë‹¤ë©´ ì–´ë–¨ê¹Œ??\në‹¨ì–´ iëŠ” ë³´í†µ, self-attentionì´ xiTQTKxj (ì¦‰ xiì˜ Query, xjì˜ Key)ê°€ ë†’ì€ ê³³ì„ \u0026ldquo;ë³´ê³ \u0026quot;ìˆëŠ”ë°, ì¦‰ ë‹¨ì–´ jë¥¼ ë°”ë¼ë³´ëŠ”ë°, ì–´ì©Œë©´ ë‹¤ë¥¸ ì´ìœ ë¡œ ë‹¤ë¥¸ j(ë‹¤ë¥¸ ë‹¨ì–´ë“¤)ë„ ì§‘ì¤‘í•´ì„œ ë³´ê³  ì‹¶ì„ ìˆ˜ë„ ìˆì§€ ì•Šì„ê¹Œ?\nìš°ë¦¬ëŠ” ì—¬ëŸ¬ ê°œì˜ Q, K, V metricesì„ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ ê°œì˜ attention \u0026ldquo;head\u0026quot;ë¥¼ ì •ì˜í•  ê²ƒì´ë‹¤.Â [##Image|kage@Q6rwO/btsOKByllUD/AAAAAAAAAAAAAAAAAAAAAAWQ59oYeD3MYB6pbl_b33hwnPTT02HUEnPvMDQSSXSL/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=8mCDlJK7KD%2FYybjO0feQnPsIxrM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:217,\u0026ldquo;originHeight\u0026rdquo;:50,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nQl, Kl, VlëŠ” ê°ê° lë²ˆì§¸ headì—ì„œ ì‚¬ìš©ë˜ëŠ” í–‰ë ¬ì´ê³ ,\nhëŠ” headì˜ ê°œìˆ˜, lì€ head ë²ˆí˜¸ (1ë¶€í„° hê¹Œì§€)ë¼ê³  í•˜ì.Â ì—¬ê¸°ì„œ ì „ì²´ ì°¨ì› dë¥¼ head ìˆ˜ hë¡œ ë‚˜ëˆ„ì–´ì„œ ê° headëŠ” ë” ì‘ê³  ë…ë¦½ì ì¸ ê³µê°„ì—ì„œ ì‘ë™í•¨.\n[##Image|kage@dC2ypW/btsOLuSGwUr/AAAAAAAAAAAAAAAAAAAAAJHiJj9SOuemqas0W38uXz5iwcuUmErvBcFPS7gdwi_u/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=I8M1ZFDFf1HnsKa3x8l9Z7oHzSI%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:814,\u0026ldquo;originHeight\u0026rdquo;:57,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê° attention headëŠ” attentionì€ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰í•œë‹¤.Â attention score : XQl(Kl)TXT\nvalue í•©ì‚° : ê·¸ ê²°ê³¼ì— XVlë¥¼ ê³±í•©Â ê° headëŠ” ì„œë¡œ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ attentionì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ê°’ì€ ì‘ì§€ë§Œ ë…ë¦½ì ì¸ feature representationì´ ëœë‹¤.Â [##Image|kage@JEEE9/btsOMVuVg3F/AAAAAAAAAAAAAAAAAAAAANwwdgS3eIQEJWHparx\u0026ndash;n0sZBjcxZZN937ht1nKoYGE/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=k0QKofMYuIO4QAUiYNiAbzg9h%2BA%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:660,\u0026ldquo;originHeight\u0026rdquo;:42,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\noutput vectorë¥¼ í–‰ë ¬ë¡œ ë§Œë“  í›„ combineÂ ì¦‰, ê° headëŠ” ì„œë¡œ different thingsë¥¼ \u0026ldquo;ë³´ê³ \u0026rdquo;, value vectorsë„ ë‹¤ë¥´ê²Œ constrcutí•œë‹¤!!\níš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ë°©ë²•Â ìš°ë¦¬ê°€ hê°œì˜ ë§ì€ attention headsë¥¼ ê³„ì‚°í• ì§€ë¼ë„ ê·¸ê²ƒì€ ë§¤ìš° ë¹„ì‹¸ì§€ ì•Šë‹¤.Â 1. ğ‘‹ğ‘„âˆˆâ„ğ‘›Ã—ğ‘‘ ë¥¼ ê³„ì‚°í•˜ê³  â„ğ‘›Ã—â„Ã—ğ‘‘/â„ ë¡œ reshape í•œë‹¤. (XK, XVë„ ë§ˆì°¬ê°€ì§€ë¡œ!!)Â ì´ë ‡ê²Œ ë˜ë©´ dì°¨ì›ì˜ nê°œì˜ wordì—ì„œ attention head hê°œë¥¼ ë§Œë“¤ê³  ì‹¶ê¸° ë•Œë¬¸ì—\ndimenstion dë¥¼ hê°œì˜ headë¡œ ë‚˜ëˆ„ê³  ê° headì— d/hë§Œí¼ í• ë‹¹í•´ì¤€ë‹¤.Â ë”°ë¼ì„œ resahpe ì‹œ ê° ë‹¨ì–´(n)ê°œê°€ hê°œì˜ headë¥¼ ê°€ì§€ë©° ê° headëŠ” d/h ì°¨ì›ì˜ query vectorë¥¼ ê°€ì§„ë‹¤. (2ì°¨ì› í–‰ë ¬ì´ì—ˆëŠ”ë° ì´ì œ 3ì°¨ì› tensorê°€ ëœë‹¤)Â 2. â„â„Ã—ğ‘›Ã—ğ‘‘/â„ ë¡œ transposeí•œë‹¤. ê·¸ëŸ¬ë©´ head axisì´ batch axisì²˜ëŸ¼ ì‘ë™í•œë‹¤. (ë˜í•œ ë§¨ ì•ì´ ë³´í†µ depthì˜ ì˜ë¯¸..!)\nTransformer êµ¬í˜„ì—ì„œëŠ” ê° headì— ëŒ€í•´ ë…ë¦½ì ìœ¼ë¡œ attentionì„ ê³„ì‚°í•´ì•¼ í•˜ëŠ”ë°, ë³´í†µ batch aixsë¥¼ ì œì¼ ì•ì— ë‘ê³  batch ì°¨ì› ë‹¨ìœ„ë¡œ ë³‘ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤.Â ì¦‰, ê° headë¥¼ ë…ë¦½ì ì¸ sampleì²˜ëŸ¼ ë³‘ë ¬ ì²˜ë¦¬ í•˜ê¸° ìœ„í•´ì„œë‹¤!Â ê·¸ëƒ¥ ì‰½ê²Œ ìƒê°í•´ì„œ hê°œì˜ headê°€ nxd/hì˜ í¬ê¸°ì˜ matrixë¥¼ ê°–ê³  ìˆë‹¤ ìƒê°í•˜ì!\n1 2 3 4 5 6 7 8 ì›ë˜: [ ë‹¨ì–´1: head1, head2, ..., headh ] [ ë‹¨ì–´2: head1, head2, ..., headh ] â†“ transpose [ head1: ë‹¨ì–´1, ë‹¨ì–´2, ... ] [ head2: ë‹¨ì–´1, ë‹¨ì–´2, ... ] ... ê±°ì˜ ë‹¤ë¥¸ ëª¨ë“  ê²ƒì€ ë™ì¼í•˜ê³  í–‰ë ¬ë“¤ì˜ í¬ê¸°ë“¤ë„ ë™ì¼í•˜ë‹¤!!Â [##Image|kage@bqj8M3/btsOMWHmfti/AAAAAAAAAAAAAAAAAAAAAF57waTz0TN_gIlpr1n2S9W0yFIumLkPrqiVmgsA3rWk/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=paBWHF47CiK5BkOGc1zDSSZ6G68%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:712,\u0026ldquo;originHeight\u0026rdquo;:205,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´ headê°€ 3ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. (ê°€ë¡œ ì„¸ë¡œê°€ ì°¨ì›ê³¼ ëŒ€ì‘ë˜ëŠ”ê²Œ ì•„ë‹˜ ì£¼ì˜!!!)Â XQ, XK: nxd/hê°€ 3ê°œ ìˆë‹¤! ë¼ê³  ì´í•´í•˜ë©´ ì‰¬ìš¸ë“¯!Â XQKX: 3ê°œì˜ headê°€ ê°ê° nxn í¬ê¸°ì˜ attention score matrixë¥¼ ê°–ê³  ìˆë‹¤.Â dot productí•´ì„œ ê° headì˜ attention scoreë¥¼ ê³„ì‚°í•˜ê²Œ ëœë‹¤.Â [##Image|kage@Rthvu/btsONayBQbW/AAAAAAAAAAAAAAAAAAAAAAnSO07E_Wm7qCPAZthbcpzc44sdrbX8s1TVz2gLUm1n/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=Ndh%2FrOW7XNRiZ3xjeSy3rRphUp4%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:808,\u0026ldquo;originHeight\u0026rdquo;:193,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nsoftmaxë¥¼ ìˆ˜í–‰í•œ í›„ ê° headë³„ë¡œ weighted average ìˆ˜í–‰í•œë‹¤.Â ê° headì˜ attention scores matrixì™€ ê° headì˜ XVë¥¼ ê°ê° ê³±í•œ ê²°ê³¼ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤!\nScaled dot ProductÂ Qì™€ Kì˜ ì°¨ì›ì´ ì»¤ì§€ë©´ ë‚´ì  ê°’ì´ ë„ˆë¬´ ì»¤ì ¸ì„œ softmaxê°€ í„°ì§€ë‹ˆê¹Œ, ê·¸ê±¸ ë°©ì§€í•˜ë ¤ê³  âˆš(d/h)ë¡œ ë‚˜ëˆ ì£¼ëŠ” ê²Œ â€œScaled Dot Product Attentionâ€ì´ë‹¤.\në§Œì•½ dimensionality d (embedding ì°¨ì›ì˜ ìˆ˜)ê°€ ë„ˆë¬´ ì»¤ì§€ë©´, vector ê°„ì˜ dot products ê°’ë„ ë” ì»¤ì§€ëŠ” ê²½í–¥ì´ ìˆë‹¤. ì´ëŸ¬ë©´ softmax í•¨ìˆ˜ì˜ inputì´ ë” ì»¤ì§ˆ ìˆ˜ ìˆëŠ”ë°,,, ê·¸ëŸ¬ë©´ softmaxì˜ ì¶œë ¥ì´ ë„ˆë¬´ ë¾°ì£¡í•´ì ¸ì„œ, backpropagation ë•Œ gradientsê°€ ë§¤ìš° ì‘ì•„ì§€ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.\nìš°ë¦¬ê°€ ë³¸ ì´ self-attention function ëŒ€ì‹ ì—\n[##Image|kage@dFKBY5/btsONaSUJ9p/AAAAAAAAAAAAAAAAAAAAAInbOgy7vn8xxuJxnVytPDmpeOGYo4fkla18Rq2j3CDd/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=gkmQXl51aS%2BHeswq2915ngwBC5Q%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:483,\u0026ldquo;originHeight\u0026rdquo;:58,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nattention scoreë“¤ì„ ë£¨íŠ¸ d/hë¡œ ë‚˜ëˆ„ì–´ì„œ scoresë“¤ì´ ë” ì»¤ì§€ì§€ ì•Šê²Œ ë§‰ì•„ì¤€ë‹¤!Â [##Image|kage@3OYaJ/btsOMPnVrZE/AAAAAAAAAAAAAAAAAAAAAB1UXP4AA7e0w5fsq_VPe6CoDIZ5mmgqYX1BeOgiruWF/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=el2wnpDwXb2wRhpEpczmk68PBXY%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:471,\u0026ldquo;originHeight\u0026rdquo;:69,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##][##Image|kage@o4J0S/btsONd3buUS/AAAAAAAAAAAAAAAAAAAAADofAExHVj7_N97OY9Zs-8Lij24z1s5Pck0KkqGBpciL/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=eiqFHJqOS1ZNOlMLDswQfIlnhQM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:371,\u0026ldquo;originHeight\u0026rdquo;:567,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n2. Residual Connections ì´ì œ optimization trick ëª‡ ê°€ì§€ë¥¼ ì•Œì•„ë³´ì\u0026hellip;!!! ì´ì „ ê²°ê³¼ì™€ Layerë¥¼ í†µê³¼í•œ ê²°ê³¼ë¥¼ ë”í•¨ìœ¼ë¡œì¨ ê·¸ ë³€í™”ëŸ‰ë§Œ í•™ìŠµí•œë‹¤!!Â ë³´í†µ diagramì—ì„œëŠ” ì¢…ì¢… Add \u0026amp; Normì´ë¼ê³  í‘œí˜„ë˜ë¯€ë¡œ ì°¸ê³ í•˜ì‹œê¸¸..!Â Residual Connectionsì€ model ë” ì˜ traingë˜ë„ë¡ ë„ì™€ì£¼ëŠ” trickì´ë‹¤.Â [##Image|kage@bHgXRo/btsONbK3W44/AAAAAAAAAAAAAAAAAAAAAKOrF8OaH0_iKARp0hS_5yMMgOV7Pd2q4rsEMUzg0uMI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=QS9Id%2FLagGTDlT%2BMxSioY2%2FW4Xc%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:437,\u0026ldquo;originHeight\u0026rdquo;:88,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nìš°ë¦¬ëŠ” ë³´í†µ ië²ˆì§¸ layerì˜ representaionì€ ì´ì „ layerì˜ representationì„ layerë¥¼ ë„£ì€ ê²°ê³¼ë¼ê³  ìƒê°í•œë‹¤.\n[##Image|kage@x53sD/btsOLdKt4Gt/AAAAAAAAAAAAAAAAAAAAAFF5A4DLuQQoRHBwsKR6Sfztkwdhx6gK70aJevsNkdmC/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=9R764qZ%2FKZsn6qp0WZAq%2Fg5jZjw%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:430,\u0026ldquo;originHeight\u0026rdquo;:96,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê·¸ëŸ°ë°, Residual Connectionì—ì„œëŠ” ìœ„ì™€ ê°™ì´ ë°”ê¿”ì§„ë‹¤. ì´ì „ layerì˜ representationì— Layerì˜ representationì„ ë”í•œë‹¤!\nì¦‰, ìš°ë¦¬ëŠ” ì „ì²´ functionë¥¼ ìƒˆë¡œ ë°°ìš°ëŠ” ê²Œ ì•„ë‹ˆë¼ residual(ë³€í™”ëŸ‰)ë§Œ í•™ìŠµí•˜ë©´ ëœë‹¤!!Â ì¦‰ ê¸°ì¡´ ì…ë ¥ + ë³€í™”ëœ ë¶€ë¶„ì„ ë„£ìœ¼ë‹ˆ ê¸°ì¡´ ì…ë ¥ì„ ì–¼ë§ˆë‚˜ ë°”ê¿€ì§€ë¥¼ í•™ìŠµí•œë‹¤.Â - ì¥ì \nì´ êµ¬ì¡° ë•ë¶„ì— Gradientê°€ ë” ì¢‹ì•„ì§„ë‹¤. -\u0026gt; ì—­ì „íŒŒê°€ ì˜ ì „ë‹¬ëœë‹¤!Â Biasë„ ë” ì¢‹ì•„ì§„ë‹¤!! -\u0026gt; í•™ìŠµ ì´ˆê¸°ì— ì…ë ¥ ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜(identity)ì— ê°€ê¹Œìš´ í¸í–¥ì„ ê°€ì§€ê²Œ ëœë‹¤. ëª¨ë¸ì´ ì²˜ìŒì—” ë­”ê°€ë¥¼ ë°”ê¾¸ì§€ ì•Šê³  ê·¸ëƒ¥ í˜ë ¤ë³´ë‚´ëŠ” ê²ƒì— ìµìˆ™í•´ì§!Â [##Image|kage@ct3AVM/btsOMqhCltF/AAAAAAAAAAAAAAAAAAAAABDqhFU8a9GPRKkFriDpNB_hUlxvl6uchzwO2y-SB-ul/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=7B7VhBO4ErmPDWcu%2BWVCASiN2FA%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:413,\u0026ldquo;originHeight\u0026rdquo;:275,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n3. LayerÂ normalization Layer normalizaitonì´ modelì´ ë” ë¹ ë¥´ê²Œ trainë˜ë„ë¡ ë„ì™€ì£¼ëŠ” trickì´ë‹¤.Â LayerNormì€ ë‹¨ì–´ ë²¡í„° ë‚´ë¶€ì˜ ê°’ ë¶„í¬ë¥¼ ì •ê·œí™”í•´ì„œ, í•™ìŠµì„ ì•ˆì •í™”í•˜ê³  ë¹ ë¥´ê²Œ ë§Œë“œëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.\nIdea ê° layerì—ì„œ hidden vectorì˜ ë¶ˆí•„ìš”í•œ, ì˜ë¯¸ì—†ëŠ” variation(ì¡ìŒ)ì„ cut downí•˜ê¸° ìœ„í•´, standard deviation(í‘œì¤€ í¸ì°¨)ê³¼ unit meanì„ normalizingí•˜ëŠ” ê²ƒ! (í‰ê· ì´ 0ì´ê³  í‘œì¤€í¸ì°¨ê°€ 1ì´ ë˜ë„ë¡ ì •ê·œí™”í•˜ëŠ” ê²ƒ!)\nì´ê²Œ ì˜ ì‘ë™í•˜ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜ëŠ”, gradient(ê¸°ìš¸ê¸°)ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ì •ê·œí™”í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.\nğ‘¥ âˆˆâ„ğ‘‘ : modelì—ì„œì˜ í•œ individual(word) vector , dì°¨ì›(embedding ëœ ì°¨ì›)ì„\nğœ‡ =Ïƒğ‘—=1 ğ‘‘ ğ‘¥ğ‘— : ì´ê±´ meanì´ì—ì—¬ ğœ‡ âˆˆ â„, xì˜ ê° ì„±ë¶„ì„ í‰ê·  ë‚´ë©´ scala ê°’ì´ ëœë‹¤.Â ğœ 2 = 1 ğ‘‘ ğ‘‘ Ïƒ ğ‘— = 1 ğ‘¥ ğ‘— âˆ’ ğœ‡ ; ì´ê±´ standard deviationì´ì—ì—¬ , ğœ âˆˆ â„. í‰ê· ì—ì„œ ì–¼ë§ˆë‚˜ í¼ì ¸ ìˆëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ë©´ ë¶„ì‚° í˜¹ì€ í‘œì¤€í¸ì°¨ê°€ ëœë‹¤.Â ğ›¾ âˆˆâ„ğ‘‘ : gain parameters í•™ìŠµ ê°€ëŠ¥í•œ parameter\nğ›½ âˆˆâ„ğ‘‘Â :bias parameters í•™ìŠµ ê°€ëŠ¥í•œ parameter\nìœ„ì˜ ë‘ parameterëŠ” ìµœì¢… ì¶œë ¥ scaleì„ ì¡°ì •í•˜ëŠ”ë° ì‚¬ìš©, í•„ìš”ì—†ìœ¼ë©´ ìƒëµ ê°€ëŠ¥í•¨.\në˜í•œ ì •ê·œí™” í•´ì£¼ë‹¤ê°€ ì •ë³´ ì†ì‹¤ì˜ ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ë³µì› ê°€ëŠ¥ì„±ì„ ì£¼ê¸° ìœ„í•´ í•™ìŠµ ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°ë¥¼ ë¶™ì¸ë‹¤.Â ê·¸ëŸ¼ë…€ layer normalizationì€ ë‹¤ìŒê³¼ ê°™ì´ compute ëœë‹¤.Â [##Image|kage@bzundi/btsOLdwZG81/AAAAAAAAAAAAAAAAAAAAAPIoF1Mu9BEVX6I6BDGP-DfyqObOIQZkGKQMH-QLG_B/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=hDiFjO8Rby2Z758WU2LPXSb7Fo4%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:860,\u0026ldquo;originHeight\u0026rdquo;:128,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}_##]\nì…ë ¥ vecotrì—ì„œ í‰ê· ì„ ë¹¼ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ì›Œì„œ ì •ê·œí™” í•œ í›„ ê°ë§ˆì™€ ë² íƒ€ë¡œ scale ì¡°ì •Â ì§œì”! Transforemer DecoderëŠ” ë‹¤ìŒê³¼ ê°™ì€ Blockìœ¼ë¡œ ì´ë£¨ì–´ì¡Œë‹µë‹ˆë‹¤.Â [##Image|kage@7J3Ex/btsOK9nKDyq/AAAAAAAAAAAAAAAAAAAAAGIfAhhGOKFkXFLsXkKguFv5zwYiFQ-E7AOOotqaA9aT/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=jKPRgP%2FzTDkKagUu3Iu2FyXG0CE%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:386,\u0026ldquo;originHeight\u0026rdquo;:662,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nSelf-attentionÂ Add \u0026amp; Norm (ì´ê±´ ê° ë‹¨ê³„ë§ˆë‹¤ ë¶™ì—¬ì£¼ëŠ” ê²ƒì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤)Â Feed-Forward Add \u0026amp; Norm ê¶ê¸ˆí•œ ê²ƒ!! \u0026ldquo;n Ã— dì—ì„œ nì€ heightê³  dëŠ” widthì²˜ëŸ¼ ë´¤ëŠ”ë°,\nreshapeí•´ì„œ n Ã— h Ã— d/hê°€ ë˜ë©´ nì´ channelì´ ë˜ëŠ” ê±°ì•¼? ì•„ë‹ˆë©´ ì—¬ì „íˆ heightì•¼?\u0026rdquo;\nâ—ï¸nì€ ì—¬ì „íˆ height (sequence axis), ì¦‰ \u0026lsquo;ë‹¨ì–´ ìˆ˜\u0026rsquo;ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¶•ì´ì•¼.\nâ†’ channel ì¶•ì€ h Ã— d/h ìª½ì„ (ì¦‰, ë‚˜ì¤‘ ì°¨ì›ë“¤)\nğŸ”¸ ì™œ ê·¸ë ‡ê²Œ í•´ì„í•´ì•¼ í•˜ëŠ”ê°€? 1. ì›ë˜ í…ì„œ êµ¬ì¡°: XQâˆˆRnÃ—dXQ âˆˆ â„^{n Ã— d}XQâˆˆRnÃ—d\nn: ë‹¨ì–´ ê°œìˆ˜ â†’ ë¬¸ì¥ ê¸¸ì´ â†’ height (ì„¸ë¡œ) d: ê° ë‹¨ì–´ì˜ ì„ë² ë”© â†’ width (ê°€ë¡œ) ì´ êµ¬ì¡°ëŠ” ë§ˆì¹˜ ì´ë¯¸ì§€ì—ì„œ:\narduino\në³µì‚¬í¸ì§‘\nheight x width\nì²˜ëŸ¼ ë³´ì„. (2D)\n2. reshape: RnÃ—hÃ—d/hâ„^{n Ã— h Ã— d/h}RnÃ—hÃ—d/h\nnì€ ê·¸ëŒ€ë¡œ: ë‹¨ì–´ ìˆ˜ â†’ ê·¸ëŒ€ë¡œ height (ì„¸ë¡œ) h Ã— d/hëŠ”: ë²¡í„°ë¥¼ head ìˆ˜ë¡œ ë¶„ë¦¬í•œ ê²ƒ â†’ ì´ê²Œ channel ë°©í–¥ í™•ì¥ì²˜ëŸ¼ ì‘ë™ ğŸ”¸ ì´ë¯¸ì§€ì™€ ë¹„êµí•´ì„œ ëŒ€ì‘ì‹œì¼œë³´ë©´: ìì—°ì–´ ì²˜ë¦¬ í…ì„œì´ë¯¸ì§€ ì²˜ë¦¬ í…ì„œì˜ë¯¸\nn height ë‹¨ì–´ ìœ„ì¹˜ d (or h Ã— d/h) channel ì„ë² ë”© ì°¨ì› / attention head (ì—†ìŒ) width (ë‹¨ì–´ëŠ” 1Dì´ë¯€ë¡œ ê°€ë¡œì¶• ì—†ìŒ) âœ… ìš”ì  ë‹¤ì‹œ ë§í•˜ë©´: n Ã— d: nì€ heightì²˜ëŸ¼ \u0026ldquo;ë‹¨ì–´ ìœ„ì¹˜\u0026rdquo;, dëŠ” ì„ë² ë”© (channelì²˜ëŸ¼ í•´ì„ ê°€ëŠ¥) n Ã— h Ã— d/h: nì€ ì—¬ì „íˆ height (ë‹¨ì–´ ìœ„ì¹˜),\nâ†’ h Ã— d/hëŠ” channel dimensionì²˜ëŸ¼ ì‘ë™ (ê° ë‹¨ì–´ë‹¹ ì—¬ëŸ¬ head í‘œí˜„) â—ï¸channelì€ ë§¨ ë’¤ìª½ ì°¨ì›ì´ê³ , heightëŠ” í•­ìƒ ë‹¨ì–´ ìˆœì„œ(n)\nreshapeë¥¼ í•´ë„ nì´ channelì´ ë˜ëŠ” ê±´ ì ˆëŒ€ ì•„ë‹˜\nğŸ”¸ ê°ê° ë¹„ìœ  ì´ë¯¸ì§€ì—ì„œëŠ”:\nless\në³µì‚¬í¸ì§‘\nì´ë¯¸ì§€: \\[Height Ã— Width Ã— Channel\\] ë¬¸ì¥ ì…ë ¥: \\[Token ìœ„ì¹˜ Ã— Feature\\] â†’ reshape â†’ \\[Token ìœ„ì¹˜ Ã— Head Ã— Dim\\_per\\_Head\\]ê·¸ë˜ì„œ ë¬¸ì¥ì—ì„œ Token ìœ„ì¹˜(n) ëŠ” í•­ìƒ height ì—­í• ì´ì§€ channelì´ ì•„ë‹ˆì•¼.\nâœ… ìš”ì•½ ì •ë¦¬ reshape ì „reshape í›„nì˜ ì˜ë¯¸channelì€ ì–´ë””?\nn Ã— d n Ã— h Ã— d/h âœ… ì—¬ì „íˆ ë‹¨ì–´ ìœ„ì¹˜ (height) âœ… h Ã— d/h (ë’¤ìª½ì´ channel ì—­í• ) channelì¸ê°€? âŒ ì•„ë‹˜ âŒ ê¶ê¸ˆí•œ ê²ƒ!!222 matrixì˜ ì˜ë¯¸ê°€ ê³ ì •ë˜ì–´ ìˆëŠ” ê²Œ ì•„ë‹ˆë¼\u0026hellip; visionì¸ì§€, LLMì¸ì§€ ë‹¤ ë‹¤ë¥¸ ê±°ì•¼?\u0026rdquo;\nâœ… ë§ì•„. í…ì„œ(í–‰ë ¬)ì˜ ê° ì°¨ì›ì´ ë­˜ ì˜ë¯¸í•˜ëŠ”ì§€ëŠ” \u0026lsquo;ë„ë©”ì¸\u0026rsquo;ì— ë”°ë¼ ë‹¬ë¼.\nì˜ˆì‹œ: ë„ë©”ì¸ë³„ ê°™ì€ ì°¨ì›ì´ ì˜ë¯¸ê°€ ë‹¤ë¦„ ë„ë©”ì¸í…ì„œ ì°¨ì›ì°¨ì› ì˜ë¯¸\nVision (CNN) \\[B, C, H, W\\] B: ë°°ì¹˜, C: ì±„ë„, H: ë†’ì´, W: ë„ˆë¹„ LLM (Transformer NLP) \\[B, N, D\\] B: ë°°ì¹˜, N: í† í° ìˆ˜, D: ì„ë² ë”© ì°¨ì› Multi-Head Attention \\[B, H, N, D/H\\] B: ë°°ì¹˜, H: head ìˆ˜, N: ë‹¨ì–´ ìˆ˜, D/H: headë‹¹ ì„ë² ë”© Audio \\[B, T, F\\] B: ë°°ì¹˜, T: ì‹œê°„ì¶•, F: ì£¼íŒŒìˆ˜ bin Time series \\[B, T, C\\] B: ë°°ì¹˜, T: íƒ€ì„ìŠ¤í…, C: ë³€ìˆ˜ (ì±„ë„) ","date":"2025-06-22T00:34:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/transformer-decoder/","title":"Transformer - Decoder"},{"content":"ìš°ë¦¬ê°€ ì•ì—ì„œ Attentionì´ input sequenceë¡œë¶€í„° ì…ë ¥ htì— ì¤‘ìš”í•œ informationì„ ë„˜ê²¨ì£¼ëŠ” ê²ƒì´ë¼ê³  ë°°ì› ë‹¤!Â ê·¼ë° RNNë„ ê³¼ê±° ì‹œì ì˜ informationì„ inputë¡œ ì „ë‹¬í•˜ëŠ” ê°™ì€ ëª©ì ì´ ë‹¤!Â ê·¸ë ‡ë‹¤ë©´\u0026hellip; RNNì„ êµ³ì´ ì“¸ í•„ìš”ê°€ ìˆì„ê¹Œ?? Attentionì´ ì •ë³´ë¥¼ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ì´ë¼ë©´!Â ê·¸ë˜ì„œ Transformerê°€ ë“±ì¥!\nSelf-attention Transformerë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” self-attentionì„ ì´í•´í•´ì•¼ í•œë‹¤.Â Cross Attentionì€\ngenerate ytë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ input xì— attentioní•˜ ê²ƒ! (ì§€ë‚œ ì‹œê°„ ë°°ìš´ attention)\nì—¬ê¸°ì„œÂ Self-Attentionì€\nytë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ y\u0026lt;tì— attentioní•˜ëŠ” ê²ƒ!\nì¦‰, output seqë¥¼ ìƒì„±í•˜ëŠ”ë° í˜„ì¬ ì‹œì  tì˜ ì¶œë ¥ì„ ìƒì„±í•  ë•Œ ì´ì „ ì¶œë ¥ë“¤ì„ ë³´ê³  ìƒì„±í•œë‹¤!Â ì´ì „ í† í°ë“¤ì„ ì°¸ê³ í•´ì„œ ì¤‘ìš”ë„ë¥¼ ë”°ì§€ê³  ì´ìš©í•´ì„œ ìƒì„±í•œë‹¤!Â [##Image|kage@be8zpa/btsOLD9Pu2C/AAAAAAAAAAAAAAAAAAAAABekskayoAGc-4KwI0taA2S2n5x75RR84yoJp3LmHM5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=oPXBMgLREoUk%2Bs1lXcOvkMDidx0%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:694,\u0026ldquo;originHeight\u0026rdquo;:431,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}_##]\nKeys, Queries, Values ì vocabulary Vì˜ ë‹¨ì–´ sequence w1:nì´ ìˆë‹¤ê³  í•˜ì (e.g Zuko made his uncle tea)\n1. Embedding matrix Eì— ëŒ€í•˜ì—¬ word embeddingìœ¼ë¡œ ë°”ê¾¼ë‹¤.Â ê° wi -\u0026gt; xi ë¡œ ë°”ê¿”ì¤€ë‹¤. (Xi = Ewi)\n2. weight Matrix Q, K, Vë¥¼ ê° word embeddingìœ¼ë¡œ ë°”ê¾¼ë‹¤.Â [##Image|kage@3bxeM/btsOLCJObQm/AAAAAAAAAAAAAAAAAAAAAPPwJYTdEqOoY-1m_a_89pdr78vQeiFFObvbF_PwsQSB/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=knLrb8DGb9z5D0QLpUUaxb5jFoM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:704,\u0026ldquo;originHeight\u0026rdquo;:50,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n3. Keyì™€ Queryì˜ similiaitesë¥¼ ê³„ì‚°í•˜ê³  softmaxë¡œ normalizeí•œë‹¤!Â [##Image|kage@pu8xq/btsOLhTA3Ic/AAAAAAAAAAAAAAAAAAAAAEdv3PkowQlo4wCjxNURej_xaWUEUbOeP8IDwZKwTaeX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=EzMQQfvZ6qdz2wZnvtl1PM23nNk%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:440,\u0026ldquo;originHeight\u0026rdquo;:95,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n4. ê·¸ê²ƒì„ ê°€ì¤‘í•©í•˜ì—¬ ê³„ì‚°!~~~\n[##Image|kage@brX2hH/btsOMOCt1Ss/AAAAAAAAAAAAAAAAAAAAAFHwzM5XzmrME2N66kQYaip9Xke9JpxQYgjLwixyGUxc/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=kFWt2skh%2Bd33OGIOUrXlvJKV6B4%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:170,\u0026ldquo;originHeight\u0026rdquo;:89,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nSelf Attentionì˜ ì¥ë²½.. ê·¸ë¦¬ê³  Solutions! 1. ë‹¨ì–´ì˜ ìˆœì„œì— ëŒ€í•œ ì •ë³´ê°€ ì•„ì˜ˆ ì—†ì–ì•„! : Sequence order [##Image|kage@ZtbFh/btsOLwJAES9/AAAAAAAAAAAAAAAAAAAAADKFLj7QwjL3cOCIukImqTwR25LakhzG6y-TD18VxGnq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=eJLlud8Oj3YYy2srFT%2F%2F%2BpJp37M%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:473,\u0026ldquo;originHeight\u0026rdquo;:65,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nSollutions: Position representationsì„ inputì— ì¶”ê°€í•´ì¤€ë‹¤!\nì¦‰, key, query, valueë¥¼ ë§Œë“¤ê¸° ì´ì „ì— input embeddingì— order informationì„ ë¯¸ë¦¬ ë„£ì–´ì¤˜ì•¼ í•œë‹¤!\npoisional encodingì¸ vector Pi ëŠ” piê°€ ë¬¸ì¥ì˜ íŠ¹ì • ìœ„ì¹˜(index)ì— ìˆìŒì„ ê°€ë¦¬í‚¨ë‹¤. (ì‹¤ì œë¡œ sin,cos ë¡œ êµ¬ì„±ëœ ê³ ì •ëœ vector ê°’ì„)\n[##Image|kage@VkgXq/btsOMP2sD9u/AAAAAAAAAAAAAAAAAAAAAAasu_r12kGGo8RBan-Ib1umxwTvS6JhqtmjjiuDG94M/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=BeQP0E3V%2B7bN4r5dIH3Y33d8z6U%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:529,\u0026ldquo;originHeight\u0026rdquo;:158,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì´ë¥¼ input embeddingì— ê·¸ëƒ¥ ë”í•´ì£¼ë©´ ëœë‹¤~~Â ê·¸ë˜ì„œ xi~ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ë°˜ì˜í•œ ìµœì¢… embeddingì´ë¯€ë¡œÂ positioned embedding, positional inputì´ë¼ê³  ë¶€ë¥¸ë‹¤.Â ì–´ë–»ê²Œ Position representationì„ ë§Œë“¤ê¹Œ?Â 1. SinusoidalÂ positionÂ representations\n[##Image|kage@c9Vr33/btsOLhzgeUc/AAAAAAAAAAAAAAAAAAAAAJavoxqGN70ZHvmnz\u0026ndash;tohf_l3ngojWt1gVCfmWjyhdx/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=bKmPA5WExLRHkchrf7xjRJVyxkI%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:864,\u0026ldquo;originHeight\u0026rdquo;:209,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nsin, cos í•¨ìˆ˜ë¡œ ë³€í™˜í•´ì„œ ë²¡í„°ë¡œ í‘œí˜„!Â ì¥ì \n- vector ì°¨ì›ë§ˆë‹¤ ì£¼ê¸°ì™€ dimensionì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì‹œì ì˜ íŒ¨í„´ì„ í‘œí˜„ ê°„ìœ¼!Â - ì™„ì „í•œ ì ˆëŒ€ì  ìœ„ì¹˜ê°€ ì•„ë‹Œ ìƒëŒ€ì  ìœ„ì¹˜ ì°¨ì´(ê°„ê²©)ì´ ë” ì¤‘ìš”í•˜ê²Œ ì‘ë™í•¨!Â - ì…ë ¥ sequenceê°€ ê¸¸ì–´ì ¸ë„ íŒ¨í„´ì´ ë°˜ë³µë  ìˆ˜ ìˆë‹¤! ê·¸ë˜ì„œ ì•ˆ ë³¸ ê¸¸ì´ê¹Œì§€ ì¼ë°˜í™”(extrapolation)í•  ìˆ˜ ìˆìŒ!Â ë‹¨ì \n- Not learnable: ì™„ì „íˆ ê³ ì •ëœ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì ¸ì„œ, í•™ìŠµ ì¤‘ì— ëª¨ë¸ì´ ììœ ë¡­ê²Œ ì¡°ì •í•˜ê±°ë‚˜ ìµœì í™” X\n- extrapolation ì‚¬ì‹¤ ì•ˆë¨ : ê¸´ ì…ë ¥ì— ëŒ€í•´ì„œ ì„±ëŠ¥ì´ ë˜‘ê°™ì´ ì˜ ì•ˆ ë‚˜ì˜´\u0026hellip;Â 2. scratch(ì²˜ìŒë¶€í„°, ì œë¡œë¡œ)ë¡œ ë¶€í„° Position representation vectorsë¥¼ í•™ìŠµì‹œí‚¤ì!\nAbsolute poistion representationì„ ë°°ìš°ì!\npië¥¼ í•™ìŠµê°€ëŠ¥í•œ parameterë„ ë‘ì~~ piëŠ” P matrixì˜ matrix columnìœ¼ë¡œ ë‘ì!Â ì¥ì \n- ìœ ì—°í•˜ë‹¤.Â ë‹¨ì \n- ì¼ë°˜í™” X : ë§Œì•½ í›ˆë ¨ ì‹œ ìµœëŒ€ nì˜ ê¸¸ì´ì¸ ë¬¸ì¥ ë³´ì•˜ëŠ”ë°\u0026hellip; ê·¸ ì´ìƒì˜ ë¬¸ì¥ì´ ë“¤ì–´ì˜¤ë©´?? ì•ˆ ë¨\n3. RoPE : Common, modern position embeddings\në‹¤ì‹œ ìƒê°í•´ë³´ì.Â positioned embeddingì„ f(x, i) í˜•íƒœë¡œ relative position embeddingìœ¼ë¡œì„œ ìƒê°í•´ë³´ì.Â f(x, i) : ë‹¨ì–´ xì˜ ìœ„ì¹˜ iì—ì„œì˜ embeddingì´ë¼ê³  í•´ë³´ì (xëŠ” ë‹¨ì–´, iëŠ” ìœ„ì¹˜)\n[##Image|kage@bmsHwM/btsOMo48Apu/AAAAAAAAAAAAAAAAAAAAABCTMEWbF7JEplWdLSExxE0LJ4etKHholRd305xf5yI2/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=2tUd%2F%2FGuyVAjpc2GWv3hhXMOQY0%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:346,\u0026ldquo;originHeight\u0026rdquo;:79,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì—¬ê¸°ì„œ Attention function gëŠ”Â x, yì˜ ì˜ë¯¸ì™€ (i-j)ë¼ëŠ” ìƒëŒ€ì  ìœ„ì¹˜ ì°¨ì´ì—ë§Œ ì˜ì¡´í•´ì•¼ í•œë‹¤!!\nê¸°ì¡´ì˜ positional embeddingì€ ì´ ëª©í‘œë¥¼ ì¶©ì¡±ì‹œí‚¤ì§€ ëª» í•˜ëŠ”ê°€?Â - 1ì˜ ê²½ìš° : ìƒëŒ€ì ì´ì§€ ì•Šì€ ë‹¤ì–‘í•œ cross-termì„ ê°€ì§„ë‹¤. (ì ˆëŒ€ ìœ„ì¹˜ ì •ë³´ê°€ ë”°ë¡œë”°ë¡œ ë°˜ì˜ëœ ê²ƒ)Â - 2ì˜ ê²½ìš° : (i-j)ì— ëŒ€í•˜ì—¬ inner productë¡œ í‘œí˜„ë˜ì§€ ì•ŠëŠ”ë‹¤.\nEmbedding via rotation ìš°ë¦¬ëŠ” position embeddingì´ absolute positionì— ì˜í–¥ì„ ë°›ì§€ ì•Šê²Œ í•˜ê³  ì‹¶ìŒ! -\u0026gt; relative positionìœ¼ë¡œ!Â ìš°ë¦¬ëŠ” inner productsê°€ arbitrary rotationì— ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆì–´! -\u0026gt; ë‚´ì  ê°’ì€ ë™ì¼í•´!Â [##Image|kage@DtFFE/btsOLSr9vWn/AAAAAAAAAAAAAAAAAAAAADePNAOx6AlQof92jWFhowuivem3neJo5rh3uBiwXpN8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=Q0rZ6D1%2F5q6iS2VU%2Fu6AMsCUFts%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:829,\u0026ldquo;originHeight\u0026rdquo;:306,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:677,\u0026ldquo;height\u0026rdquo;:250}##]\në‚´ì  ê¸°ë°˜ìœ¼ë¡œ attention scoreë¥¼ ê³„ì‚°í•˜ë©´..! ìƒëŒ€ ìœ„ì¹˜ ê¸°ë°˜ attentionì´ ê°€ëŠ¥í•˜ë‹¤!Â [##Image|kage@1fMUn/btsOKA7fddu/AAAAAAAAAAAAAAAAAAAAAFiY4bPdxRyyNhxboOvoLfxVa_NpvRX9zY2gSX9qV884/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=0Ypa%2B5YtdisnSDC%2BdvW7G6TNGCQ%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:766,\u0026ldquo;originHeight\u0026rdquo;:439,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\në”°ë¼ì„œ coordinateë¥¼ ì§ì§€ì–´ì„œ 2D í‰ë©´ì—ì„œ íšŒì „ì‹œì¼œë¼!!! (ì•„ì´ë””ì–´ëŠ” ë³µì†Œìˆ˜ì—ì„œ ë”°ì˜¨ ê²ƒ!!)Â ì¦‰ ìœ„ì¹˜ iì— ëŒ€í•˜ì—¬ ë‹¨ì–´ vector xì— ëŒ€í•´ì„œ sin/così„ ê³±í•˜ì—¬ ë²¡í„° ê³µê°„ì—ì„œ íšŒì „ì‹œí‚¤ì!Â ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´Â ê° ë‹¨ì–´ëŠ” d ì°¨ì›ì˜ Query/Key ë²¡í„°ë¥¼ ê°€ì§„ë‹¤! ê·¸ë¦¬ê³  poisionì´ ì ìš© ëœ í›„ Position embdding(ìœ„ì¹˜ ì •ë³´ê°€ ë‚´ì œëœ) Query/Keyê°€ ìƒì„±ëœë‹¤.Â ë‹¨ì–´ Enhancedì— ëŒ€í•œ Queryì™€ Key vector (x1, x2)ê°€ ì¡´ì¬í•˜ê³  position m(indexì„)ì´ ìˆë‹¤.\nì´ë•Œ Q, K vector(x1, x2)ë¥¼ sin/cos ê¸°ë°˜ìœ¼ë¡œ më§Œí¼ íšŒì „ì‹œí‚¨ë‹¤. ê·¸ëŸ¬ë©´ ë°˜ì˜ì´ ë˜ê³ !!Â ê·¸ëŸ¬ë©´!! íšŒì „ì´ ë°˜ì˜ëœ vectorëœ í›„ Enhancedë¼ëŠ” Q ë²¡í„°(ìœ„ì¹˜ 1)ì™€ Rotaryë¼ëŠ” ë‹¨ì–´ì˜ K ë²¡í„°(ìœ„ì¹˜ 4)ê°€ dot productí•˜ì—¬ attention score ê³„ì‚° ì‹œ ìœ„ì¹˜ ì •ë³´ê°€ ë°˜ì˜ì´ ëœë‹¤~~~Â 2. Deep Larningì„ ìœ„í•œ nonlinearitiesê°€ ì—†ì›Œ!! ê·¸ëƒ¥ ë‹¨ìˆœíˆ weighted í‰ê· ì´ìëƒ : non-linearities [##Image|kage@cnQ8RS/btsOLBKXrNm/AAAAAAAAAAAAAAAAAAAAAFKU9q_Lzhwt1sEmCWN69mWDpMJBFc3f2Bne5KxbOL6F/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=PH05iw82z83oI%2Bz%2FWBPsUqLeBgQ%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:684,\u0026ldquo;originHeight\u0026rdquo;:530,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:506,\u0026ldquo;height\u0026rdquo;:392}##]\nSelf-attention ë©”ì»¤ë‹ˆì¦˜ ìì²´ì—ëŠ” ë¹„ì„ í˜•ì„± ì´ ì—†ë‹¤\u0026hellip; ì „ë¶€ ì„ í˜• ì—°ì‚°ì„!!\në”°ë¼ì„œ Self-attentionë§Œ ê³„ì† ìŒ“ë‹¤ë³´ë©´\nì´ì „ layerì—ì„œ ì–»ì€ Value vectorë“¤ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì¬í‰ê· (re-averaging) í•˜ëŠ” ê²ƒì— ë¶ˆê³¼í•˜ê²Œ ë¨ Solutions: Self-attention ì´í›„ Feed-Forward networkë¡œ ë¹„ì„ í˜•ì„±ì„ ì¶”ê°€í•˜ì—¬ ê° output vectorë¥¼ ì²˜ë¦¬í•¨!Â [##Image|kage@bC9JFW/btsOMaTAZXU/AAAAAAAAAAAAAAAAAAAAAIMhHk4CCtIMmh3ZLczQgxLDfGQkZneu9oxm_6RbHjjj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=ZwTxvW9sZnvB1u21ip%2FiGgjZ8wk%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:492,\u0026ldquo;originHeight\u0026rdquo;:141,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n3. sequenceë¥¼ ì˜ˆì¸¡í•  ë•Œ \u0026ldquo;ë¯¸ë˜ë¥¼ ë³´ì§€ ì•ŠëŠ”ë‹¤\u0026quot;ëŠ” ë³´ì¥ì´ ìˆë‚˜? : Masking the future in self-attnetion ì´ ë§ì€ ì¦‰ìŠ¨, Machine translationì´ë‚˜ Language modelingê³¼ ê°™ì´ ìˆœì°¨ì ì¸ taskì—ì„œ ì•„ì§ ë‚˜ì˜¤ì§€ ì•Šì€ ë‹¨ì–´ë¥¼ ë¯¸ë¦¬ ì°¸ê³ í•˜ë©´ ì•ˆ ëœë‹¤ëŠ” ëœ»!!! (self-attentionì€ input ì „ì²´ë¥¼ í™•ì¸í•˜ë‹ˆê¹Œ!) -\u0026gt; ì¦‰, training í•  ë•Œ! (inferenceëŠ” ì•„ë‹˜!!)Â [##Image|kage@ddgVDd/btsOKS0PxOh/AAAAAAAAAAAAAAAAAAAAAOi-yB3vie78rxzMKs93S6BqZjHFUgrvqUUa1bHpPxsR/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=cyvxv8gcPjAo1aOSFR5x51ViWMo%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:704,\u0026ldquo;originHeight\u0026rdquo;:298,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:324,\u0026ldquo;height\u0026rdquo;:137}##]\nDecoderëŠ” ê¸°ë³¸ì ìœ¼ë¡œ self-attentionê³¼ cross-attentionì„ ì‚¬ìš©í•œëŠ”ë°,\ntrain ë„ì¤‘ì— inputê³¼ targetì„ ëª¨ë‘ ë°›ëŠ”ë‹¤. ì´ë•Œ ë‹¨ì–´ ì˜ˆì¸¡í•˜ëŠ”ë° self-attention ì‹œ target seq ì „ì²´ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ì´ë¥¼ ê°€ë ¤ì•¼ í•¨.\nê·¸ëŸ¬ë©´ ë§¤ timestepë§ˆë‹¤ keysë“¤ê³¼ querysë¥¼ ë°”ê¿”ì„œ ì´ì „ ë‹¨ì–´ë§Œ ë³´ê²Œ ë§Œë“¤ë©´ ë ê¹Œ? -\u0026gt; Inefficient!\në§¤ timestepë§ˆë‹¤ attention ë²”ìœ„ë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì•¼ í•˜ë¯€ë¡œ ë³‘ë ¬ ê³„ì‚°ì´ ë¶ˆê°€ëŠ¥\u0026hellip;Â ì¦‰, paralleizationì´ ê°€ëŠ¥í•˜ë ¤ë©´\n- ì „ì²´ seqë¥¼ ë‹¤ ë„£ì€ í›„\n- future ë‹¨ì–´ë“¤ì˜ attention scoresë¥¼ -ë¬´í•œëŒ€ë¡œ ì„¤ì •í•˜ì—¬ attentionì„ mask out ì²˜ë¦¬í•´ì•¼ í•¨!Â - softmaxì—ì„œ exp (âˆ’âˆ ) = 0ì´ë¯€ë¡œ ì™„ì „íˆ ë¬´ì‹œëœë‹¤~~\n[##Image|kage@TRTZW/btsOLhF2Z4s/AAAAAAAAAAAAAAAAAAAAADuKmel_ldl2RlpnDJcyRSNAbSZzMBz7mppbBHytCNAl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=9kk6y0Xu1gbYNWN3q28meDty3dY%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:240,\u0026ldquo;originHeight\u0026rdquo;:93,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##][##Image|kage@baAlZ0/btsONayxgTE/AAAAAAAAAAAAAAAAAAAAANjvvtTqGeILUDd_ZK6OgOMF1lUF9iu1TwhfAOM-A1J5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=bow2jZu5lSfPkPtaH5X1Y6%2F0soM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:729,\u0026ldquo;originHeight\u0026rdquo;:587,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:507,\u0026ldquo;height\u0026rdquo;:408}##]\nSolutions: attention weightë¥¼ 0ìœ¼ë¡œ ì¼ë¶€ëŸ¬ ë§Œë“¤ì–´ì„œ ë¯¸ë˜ë¥¼ mask outí•œë‹¤.Â ì •ë¦¬ : Self-attentionì„ ìœ„í•œ building block! [##Image|kage@brSmTy/btsOKUdjH2z/AAAAAAAAAAAAAAAAAAAAAMg4S7fYAb3shTEAmgIlyP-GYvVUNOoPsSiBoIg6-Gct/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=oG%2FancrmYQbbA1RrMiYyw7MZXLc%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:405,\u0026ldquo;originHeight\u0026rdquo;:605,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n1. self-attentionÂ 2. Position representations\nseq orederë¥¼ êµ¬ì²´í™”í•˜ê¸° ìœ„í•´ì„œ! self-attentionì€ inputì˜ ìˆœì„œë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—!Â 3. nonlineariies\nself-attention blockì˜ outputì— Feed Forwar newrokë¥¼ êµ¬í˜„!\n4. Masking\në¯¸ë˜ë¥¼ ë³´ì§€ ì•Šê³  parallize ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œÂ ë¯¸ë˜ì— ìƒì„±ë¼ì•¼ í•  ë‹¨ì–´ì˜ ì •ë³´ê°€ ì• ë‹¨ì–´ ì˜ˆì¸¡ ê³¼ì •ì— í˜ëŸ¬ ë“¤ì–´ê°€ë©´ ì•ˆ ë¨ âŒ Maskingì€ ì´ëŸ° **ì •ë³´ ëˆ„ì¶œ(leakage)**ì„ ë§‰ì•„ì¤Œ ","date":"2025-06-21T22:36:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/transformer1-self-attention/","title":"Transformer(1) - Self-attention"},{"content":"ì´ì „ì— RNNì˜ ë¬¸ì œì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ë‹¤..Â - ë³‘ë ¬ ì²˜ë¦¬ ì•ˆ ë¨Â - ì„ í˜• êµ¬ì¡°ì— ì˜ì¡´ë˜ì–´ ë¬¸ì¥ì„ ì´í•´í•˜ê¸° ë•Œë¬¸ì— ì˜ ì²˜ë¦¬í•˜ì§€ ëª»í•¨!Â ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‚˜ì˜¨ solutionì´ Attentionì´ë‹¤.Â Core Idea decoderì˜ ê° stepì—ì„œ encoderì™€ì˜ ì§ì ‘ ì—°ê²°ì„ ì´ìš©í•´ì„œ, source sequenceì˜ íŠ¹ì • partì— ì§‘ì¤‘í•œë‹¤.\nì „í†µì ì¸ RNNì€ ì¸ì½”ë”ì˜ ë§ˆì§€ë§‰ hidden state í•˜ë‚˜ë§Œ ë³´ê³  ë‹¤ìŒ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í–ˆë‹¤! (ì •ë³´ ì†ì‹¤ì´ í¬ë‹¤!! )\nBasic Idea attentionì´ ì—†ì„ ë•Œ ë‹¤ìŒì˜ ì•„ì´ë””ì–´ë¥¼ ë– ì˜¬ë ¸ë‹¤\u0026hellip;\nê·¸ëŸ¬ë©´\u0026hellip; hidden state ì •ë³´ í•˜ë‚˜ì— ì´ì „ì˜ ì •ë³´ê°€ ëª¨ë‘ ì˜ ìš”ì•½í–ˆë‹¤ê³  ë³´ì¥í•  ìˆ˜ ì—†ìœ¼ë‹ˆê¹Œ\u0026hellip;? ê·¸ê±¸ ë‹¤ ìš”ì•½í•˜ëŠ” ê±° ì–´ë•Œ??\nì¦‰,\nEncoderë¡œë¶€í„° ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì€\u0026hellip; encoderì˜ hidden stateë“¤ì„ í‰ê· (average) ë‚´ëŠ” ê²ƒì´ë‹¤!!Â ì¦‰, decoderì— Encoderì˜ context vectorë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒ!Â [##Image|kage@DzINe/btsOL8VNoTS/AAAAAAAAAAAAAAAAAAAAADSpoVkTOAsA7wF9MjZMkmiyPmzuPpUAJixANG3RSohv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=NXR3m48WTG8XNRTJBf0gAnQSJ3Y%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:513,\u0026ldquo;originHeight\u0026rdquo;:331,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\në¬¸ì¥ì˜ encodingì„ ê³„ì‚°í•  ë–„ ëª¨ë“  hidden stateë“¤ì˜ element-wise max ë˜ëŠ” meanì„ ì·¨í•˜ëŠ” ê²ƒ!Â Attention ì¦‰ weighted averageë¥¼ í†µí•´ì„œ\u0026hellip; weightê°€ ë†’ì€ ê²ƒì„ ë¹„ì¤‘ìœ¼ë¡œ í•™ìŠµí•˜ëŠ”ê±°ì§€!!!Â [##Image|kage@bIAhbq/btsOL3ty6o4/AAAAAAAAAAAAAAAAAAAAACs-ThR3rgXTYPTssuVKhnURBuKVs2n-EG99t9BcnWl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=Nw566sYGRUABPHE7sXEyNVrjP2U%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:446,\u0026ldquo;originHeight\u0026rdquo;:299,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}_##]\nAttentionì—ëŠ” Query, Keys, Valuesë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.Â QueryëŠ” ëª¨ë“  Keysë“¤ê³¼ ë¶€ë“œëŸ½ê²Œ ë§¤ì¹­ë˜ì–´ 0ê³¼ 1 ì‚¬ì´ì˜ weightë¥¼ ë§Œë“ ë‹¤.Â ê·¸ weightë¥¼ Keyì— í•´ë‹¹í•˜ëŠ” Valueë¥¼ ê³±í•˜ê³  ëª¨ë‘ ë”í•œë‹¤.Â [##Image|kage@r2Fiy/btsOLFT6U3Y/AAAAAAAAAAAAAAAAAAAAADVSA91a0Adca3w9eUKGdt8oU8SvCWTfee6_W5xrSTp0/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=M1U58ZHRsAVKoxonVNAMmI9N%2ByI%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:344,\u0026ldquo;originHeight\u0026rdquo;:288,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nLookup tableì€ keyë“¤ì„ valueì— Mappingí•œ tableì´ë‹¤.Â Queryê°€ íŠ¹ì • Keyì™€ ì¼ì¹˜í•˜ë©´, ê·¸ Keyì— í•´ë‹¹í•˜ëŠ” Valueë¥¼ ë°˜í™˜í•œë‹¤.Â seq2seq with attentionì˜ ì‘ë™ ë°©ì‹ [##Image|kage@l4yAK/btsOLEgvH74/AAAAAAAAAAAAAAAAAAAAAPdoukWGC6LQxaiMEPsCv4MI-r_AcVKtzSjoi0XZLDGq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=HKYtM0yCNoBE4S66vj2GEuJPpEE%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:746,\u0026ldquo;originHeight\u0026rdquo;:407,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\në¹¨ê°„ìƒ‰ì€ Encoder, ì´ˆë¡ìƒ‰ì€ Decoder ë¶€ë¶„ì´ë¼ê³  í•˜ì!Â 1. ê° inputì˜ hidden stateì— ëŒ€í•´ì„œ í˜„ì¬ st(decoderì˜ ì´ˆê¸°í™” vector)ë¥¼ ê³±í•´ì„œ Attention scoresë¥¼ ê³„ì‚°í•œë‹¤.Â [##Image|kage@mOuKB/btsOKqQYw8p/AAAAAAAAAAAAAAAAAAAAAGPQ6q_U9671wVdFeZTwEgEA17_CnmsLWW11L6pPpGxS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=p0B%2BCxP3mBSdvZy36bJcegFs%2FhA%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:593,\u0026ldquo;originHeight\u0026rdquo;:459,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n2. SoftMaxë¥¼ ì´ìš©í•´ì„œ ê³„ì‚°í•œ scoresë¥¼ probability distribution(ì´ê²ƒì´ ì§„ì§œ ê°€ì¤‘ì¹˜!)ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤.Â Decoder timestepì—ì„œëŠ” ìš°ë¦¬ëŠ” ì œì¼ ë¨¼ì € encdoer hidden state ë¥¼ ë¨¼ì € focusing í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.Â [##Image|kage@bITsJ5/btsOMGRY8EJ/AAAAAAAAAAAAAAAAAAAAAL7KQOnnV7YuFMhrG-J9nAEXHgTGVkMlCT4YyZ4wKEsI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=mB%2BI%2Fdz6tTmEBS3MlJA%2BryCYPrU%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:742,\u0026ldquo;originHeight\u0026rdquo;:479,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:496,\u0026ldquo;height\u0026rdquo;:320}##]\n3. ì´ attention distribution(ê°€ì¤‘ì¹˜)ì„ ì´ìš©í•´ì„œ encoder hidden stateì˜ ê°€ì¤‘í•©ì„ ê³„ì‚°í•œë‹¤.Â ê³„ì‚°ëœ attention outputì€ ëŒ€ë¶€ë¶„ high attentionì„ ê°€ì§„ hidden stateì˜ ì •ë³´ë¥¼ í¬í•¨í•˜ê²Œ ëœë‹¤.Â [##Image|kage@8IDHU/btsOKQomlFc/AAAAAAAAAAAAAAAAAAAAAFTLQ5a8Hx_aJPumAAmX_MDdOpwmrwrXYQDGH8c5z0FW/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=JUbcSl3rBUdudzevAyWIS3496fU%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:736,\u0026ldquo;originHeight\u0026rdquo;:457,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:581,\u0026ldquo;height\u0026rdquo;:361}##]\n6. attention output (context output)ê³¼ decoder hidden stateë¥¼ ì—°ê²°í•´ì„œ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ y1ì„ ê³„ì‚°í•œë‹¤.Â [##Image|kage@beZtrw/btsOMPg4qZg/AAAAAAAAAAAAAAAAAAAAAOh0qj7u_Q6kTeCNhG8flJLw-JIeY8Duad0puVbSMqg7/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=k8xTX3QjOZJWZkTfDEckIaq8uXQ%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:748,\u0026ldquo;originHeight\u0026rdquo;:467,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:529,\u0026ldquo;height\u0026rdquo;:330}##]\nì–´ë–¤ ê²½ìš°ì—ëŠ” ì´ì „ stepì˜ attention outputë„ decoder inputì— ê°™ì´ ë„£ëŠ”ë‹¤.Â In equations : ìˆ˜ì‹ìœ¼ë¡œ!Â 1. Encoderì˜ hidden statesê°€ ì£¼ì–´ì§€ê³ , timestep tì— ëŒ€í•´ì„œ decoder hidden state stê°€ ìˆë‹¤ê³  í•˜ì.Â [##Image|kage@qmnw5/btsOLheU80P/AAAAAAAAAAAAAAAAAAAAABqmL3BeKs1-WwcucDIqZNZNwWTw4RZlWTUCuCAe2i6x/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=YCjEosVPZzeYKkXIP0SesBtVBLk%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:149,\u0026ldquo;originHeight\u0026rdquo;:26,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##][##Image|kage@vdWwJ/btsOMasxrYh/AAAAAAAAAAAAAAAAAAAAAD5-9-XL4cOrEGwkLVzDy1XnV4vVSkZ917stNgHgXpTl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=sTgDFYKKxqQtemRVdUG5sJJx4CA%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:72,\u0026ldquo;originHeight\u0026rdquo;:27,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n2. ì´ stepì— ëŒ€í•´ì„œ attention scores(ë‹¨ì‹œ ìœ ì‚¬ë„ ì ìˆ˜!) ë¥¼ ê³„ì‚°í•˜ì!Â [##Image|kage@bqTZ13/btsOKIcOqUM/AAAAAAAAAAAAAAAAAAAAAOzDKAMvg_w2UBQGSoDcRJ4CtMkT_RwxyMy-PXABjB1t/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=YjzML%2FZ8lXjTYNfgV49kEqPRS5w%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:319,\u0026ldquo;originHeight\u0026rdquo;:54,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì¦‰ í˜„ì¬ st(Query)ì™€ ì…ë ¥ì˜ hidden state(\nValues\n)ë¥¼ ê³±í•˜ë©´ ëœë‹¤.Â 3. ì´ stepì˜ attention distribution(attention Weight)ì„ ê³„ì‚°í•œë‹¤. softmax í•¨ìˆ˜ë¡œ! (í™•ë¥  ë¶„í¬ë¥¼ ê³„ì‚°í•´ì£¼ê³ , í•©ì€ 1)\nì¦‰, ê° stê°€ encoder hidden stateì— ëŒ€í•´ì„œ ì–¼ë§ˆë‚˜ ì§‘ì¤‘í• ì§€ í™•ë¥ ì²˜ëŸ¼ í•´ì„ ê°€ëŠ¥!!Â [##Image|kage@bEvDUD/btsOKAsxBCz/AAAAAAAAAAAAAAAAAAAAAN3SAvBNcgPrYThoCliDXHKIj6l-4fUpJYJYpwck8bDS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=I3MdRz9DP3w8zkXggsLSnnuWm2c%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:264,\u0026ldquo;originHeight\u0026rdquo;:52,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n4. ì´ attention distribution(attention Weight)ì„ encoder hidden state(Values)ì™€ weighted sumí•˜ì—¬ attention outputë¥¼ ì–»ëŠ”ë‹¤.Â [##Image|kage@biOpXj/btsOMPaiSA6/AAAAAAAAAAAAAAAAAAAAAFZ8T5xInYjJeBn7dAg5MluLo2fCkUByTSaICLoT7Jri/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=o15kVaoMIH3jFZ72I8ynHHSJREE%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:192,\u0026ldquo;originHeight\u0026rdquo;:73,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\n5. ì´ attention output atì™€ decoder hidden state stë¥¼ ì´ì–´ ë¶™ì´ê³  decoderë¡œ ë„˜ê²¨ì¤€ë‹¤!!Â ì •ë¦¬..!Â Query qtq_t ë””ì½”ë”ì˜ í˜„ì¬ hidden state (t ì‹œì ) â€œì§€ê¸ˆ ì–´ë–¤ ì •ë³´ê°€ í•„ìš”í•˜ì§€?â€ Keys kik_i ì¸ì½”ë”ì˜ ê° hidden state ì…ë ¥ ë‹¨ì–´ë“¤ì˜ \u0026ldquo;ì •ì²´ì„±\u0026rdquo; Values viv_i ë³´í†µ Keysì™€ ê°™ê³ , ì¸ì½”ë”ì˜ hidden state ìì²´ ì…ë ¥ ë‹¨ì–´ë“¤ì˜ ì‹¤ì œ ì •ë³´ Attention distribution Queryì™€ ê° Key ê°„ì˜ ìœ ì‚¬ë„ â†’ softmaxë¡œ ë§Œë“  ê°€ì¤‘ì¹˜ë“¤ Î±1,Î±2,â€¦,Î±T\\alpha_1, \\alpha_2, \\dots, \\alpha_T, ì´í•© = 1 Attention output (context vector) âˆ‘iÎ±iâ‹…vi\\sum_i \\alpha_i \\cdot v_i ì§‘ì¤‘í•œ ê°’ë“¤ì˜ ê°€ì¤‘ í‰ê·  Attention is awesome! Attentionì€ parallelizableí•˜ê³ Â bottlenck issuesë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.Â ì¦‰, ê° ë‹¨ì–´ì˜ representation(==vector)ì„ Queryë¡œ ì‚¬ìš©í•´ì„œ Valuesì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  ê²°í•©í•œë‹¤.Â == ê° ë‹¨ì–´(Query)ëŠ” ëª¨ë“  ë‹¨ì–´ë¥¼ íƒìƒ‰í•˜ì—¬(key) ìê¸°ì—ê²Œ í•„ìš”í•œ ì •ë³´ë§Œ ê³¨ë¼ë‚¸ë‹¤!Â ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ ë³¸ ê²ƒì€ Cross-Attention(Decoderê°€ Encoderë¥¼ ì³ë‹¤ë³´ëŠ” ê²ƒ)Â ì´ì œëŠ” í•œ ë¬¸ì¥ ì•ˆì—ì„œ ë‹¨ì–´ë“¤ë¼ë¦¬ ì„œë¡œ ì£¼ëª©í•˜ëŠ” Self-Attention (ë‹¨ì–´ë“¤ë¼ë¦¬ ì„œë¡œë¥¼ ë™ì‹œì— ì³ë‹¤ë´„)ì„ ë³´ì!!Â Self-attentionì€ íŠ¹íˆ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì—°ì‚°ì˜ ê°œìˆ˜ê°€ sequence ê¸¸ì´ì— ë”°ë¼ ëŠ˜ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤! ì¦‰ GPUì— ì¹œí™”ì ì´ë‹¤!!\nëª¨ë“  wordê°€ í•œ layerì—ì„œ ì„œë¡œ ìƒí˜¸ì‘ìš© í•˜ê¸° ë•Œë¬¸ì— ìµœëŒ€ interaction distanceëŠ” O(1)ì´ë‹¤.Â [##Image|kage@bJvhuO/btsOLqQdNqO/AAAAAAAAAAAAAAAAAAAAAPw0Kk8Tq9MJ_Y4-LHuDkA61C7WrHa04922uXhjVYdto/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=dryUYJGjATLAKGTSRH4XsjvRICw%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:460,\u0026ldquo;originHeight\u0026rdquo;:209,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nAttention is awesome Deep Learning technique ìš°ë¦¬ëŠ”\u0026hellip; seq2seq ëª¨ë¸ì„ Machine Translation í•˜ê¸° ìœ„í•´ ê°œì„ í•œ ë°©ë²•ì¸ attentionì„ ë³´ì•˜ìŠµë‹ˆë‹¤..\ní•˜ì§€ë§Œ!! ë‹¤ë¥¸ ë§ì€ architextures, ê·¸ë¦¬ê³  ë§ì€ taskì—ì„œ ì‚¬ìš©ëœë‹¤ë‹¤!!Â More general definition of attention : â€¢ Given a set of vector values, and a vector query, attention a weighted sum of the values, dependent on the query.\nì–´ë–¤ ê²½ìš°ì—ëŠ” query ê°€ valueì— attendí•œë‹¤. ë¼ê³  ë§í•œë‹¤.Â ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ ë³¸ seq2seq + attention êµ¬ì¡°ì—ì„œëŠ” Decoderì˜ ê° hidden state (query)ê°€ Encoderì˜ ëª¨ë“  hidden state (value)ì— attentioní•œë‹¤. (ì¦‰, ì–´ë–¤ ì •ë³´ê°€ í•„ìš”í•œì§€ attentionì„ í†µí•´ ê²°ì •!)\nì •ë¦¬: ì§ê´€ ê°€ì¤‘í•© : queryê°€ ì§‘ì¤‘í•´ì•¼ í•  ê°’ì„ ê²°ì •í•œ valuesë“¤ì´ í¬í•¨ëœ ì •ë³´ì˜ ì„ íƒì  ìš”ì•½,Â Attentionì€ ì•„ë¬´ë¦¬ ë§ì€ representationì´ ìˆì–´ë„ í•˜ë‚˜ì˜ ê³ ì •ëœ fixed-size representation(vector)ì„ ë½‘ì•„ë‚¸ë‹¤.Â ê·¸ vectorëŠ” queryê°€ ì–´ë””ì— ì§‘ì¤‘í–ˆëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.Â Attentionì€ ê±°ì˜ ëª¨ë“  Deep Learning modelì—ì„œ ê°€ì¥ ê°•ë ¥í•˜ê³  ìœ ì—°í•˜ê³  ì¼ë°˜ì ì¸ pointerì´ì memory manipulationì´ë‹¤.Â ê·¸ë˜ì„œ ì´ ì•„ì´ë””ì–´ê°€ ì ìš©ëœê²Œ NMTì—¬!Â ì¶”ê°€ ê¶ê¸ˆì¦\u0026hellip; ì™œ Query(st)ë‘ Keys(input hidden state)ë¥¼ dot productí•˜ëŠ”ê²Œ ì •ë³´ë¥¼ ê²°í•©í•˜ëŠ”ê²Œ ë˜ëŠ”ê±°ì•¼?Â dot productëŠ” ê²°êµ­ ë‘ ì…ë ¥ì´ ì–¼ë§ˆë‚˜ ê´€ë ¨ ìˆëŠ”ì§€ (ìœ ì‚¬ë„)ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒ! ê·¸ë˜ì„œ Query(st)ë‘ Key(ì…ë ¥)ì–¼ë§ˆë‚˜ ê´€ë ¨ì´ ìˆëŠ”ì§€ ì¸¡ì •í•˜ê³  value(=ì •ë³´)ë¥¼ ì–¼ë§ˆë‚˜ ê°€ì ¸ì˜¬ì§€ ê²°ì •í•˜ëŠ”ê²Œ ì •ë³´ ê²°í•©!!!!\nê·¼ë° ìœ„ì˜ ëª¨ë¸ì—ì„œëŠ”\nKey = Value = Encoder Hidden Stateë¡œ ê·¸ëƒ¥ ì¨ë²„ë¦° ê²ƒ!!Â Transformerì—ì„œëŠ” Key, ValueëŠ” hidden stateì— ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ marixë¥¼ ê³±í•œë‹¤.\n","date":"2025-06-21T20:02:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/attention/","title":"Attention"},{"content":"sentence xë¥¼ source languageì—ì„œ target lanugeì¸ sentence yë¡œ ë²ˆì—­í•˜ëŠ” task\n[##Image|kage@pGqje/btsOLcLteEK/AAAAAAAAAAAAAAAAAAAAAJ8N5fEEcNKATTcOrT6v8Z2T9AlfGSSn9AL_69fY9USs/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=eajn9PkUyAUTu8iHDsP0Rqep3SQ%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:575,\u0026ldquo;originHeight\u0026rdquo;:248,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nStatistical Machine TranslationÂ Core Idea\ndataë¡œë¶€í„° probabilistic modelì„ í•™ìŠµí•˜ì!!\n[##Image|kage@bshULM/btsOL9UEEqN/AAAAAAAAAAAAAAAAAAAAAIp1l1JOWvn-gSVfpn_N1HdbHlVlG2rHxsPH8wbZkC2g/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=rmHlRNvtGTV4s%2B%2BZPCEf9yo8ZuM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:710,\u0026ldquo;originHeight\u0026rdquo;:380,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\ní”„ë‘ìŠ¤ì–´ sentence xê°€ ì£¼ì–´ì¡Œì„ ë•Œ, sentence yë¥¼ ì°¾ì•„ë³´ì!!!\nì¦‰ 2ê°œì˜ componentë¡œ ê°ê° ë¶„ë¦¬í•´ì„œ í•™ìŠµì‹œí‚¨ë‹¤!Â Translation Modelwordë‚˜ phrasesë¥¼ ì–´ë–»ê²Œ ë²ˆì—­í•´ì•¼ í•˜ëŠ”ì§€ ëª¨ë¸ë§, parallel dataë¡œë¶€í„° í•™ìŠµë¨ Language Model\nì¢‹ì€ Englishë¥¼ ì–´ë–»ê²Œ ì¨ì•¼ í•˜ëŠ”ì§€ ëª¨ë¸ë§, monologual dataë¡œë¶€í„° í•™ìŠµë¨ ê·¸ëŸ¬ë‚˜\u0026hellip; ê·¹ë„ë¡œ ë³µì¡í•˜ê³  ì¤‘ìš”í•œ detailë“¤ì´ ë„ˆë¬´ ë§ë‹¤\u0026hellip;Â ê°‘ìê¸°\u0026hellip;ë“±ì¥í•œ ê²ƒì´ ìˆìœ¼ë‹ˆ..\nNeural Machine Translation (NMT) êµ¬ê¸€ ë²ˆì—­ë„ ì›ë˜ SMT systemì´ì—ˆëŠ”ë°..! NMT systemìœ¼ë¡œ ë°”ë€Œë©´ì„œ ë¹ ë¥´ê²Œ ë°œì „ë¨!!\n[##Image|kage@KztoA/btsOLjKAPJO/AAAAAAAAAAAAAAAAAAAAAKSVFfP_V1F1CGPM8qs4CtkTkr9qolVRwRl448JVY1b2/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=LYQiQbO%2BxDXQc%2BSMzU2ImHKugGo%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:748,\u0026ldquo;originHeight\u0026rdquo;:436,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:640,\u0026ldquo;height\u0026rdquo;:373}##]\nsequence-to-sequence model ì´ë‹¤!!\n**Encoder RNN\n**Encoder RNNì€ source sentenceì˜ encodingì„ ìƒì„±\nEncoding ê²°ê³¼ëŠ” Decoderì˜ ì´ˆê¸° hidden stateë¡œ ì œê³µÂ **Decoder RNN\n**encodingì„ ì¡°ê±´ìœ¼ë¡œ í•˜ì—¬ target sentenceë¥¼ ìƒì„±í•˜ëŠ” Language ModelÂ ì¦‰ EncoderëŠ” inputì„ ì·¨í•˜ê³  neural representaionì„ ìƒì„±, DecoderëŠ” neural representationì„ ê¸°ë°˜ìœ¼ë¡œ outputì„ ìƒì„±\nì´ëŠ” seq2seq model ì´ë¼ê³  ë¶€ë¥¸ë‹¤.Â ë§ì€ NLP taskì—ì„œëŠ” seq-to-seqë¡œ í‘œí˜„ë  ìˆ˜ ìˆìŒ!\nSummarizationÂ (longÂ textÂ â†’Â shortÂ text) Dialogue (previous utterances â†’ next utterance) Parsing (input text â†’ output parse as sequence) Code generation (natural language â†’ Python code) NMT [##Image|kage@el1MRG/btsOLt0scSI/AAAAAAAAAAAAAAAAAAAAAPIidx9a-aWVJQotstRic7e-OxaafFnqpJygAm0-iGFH/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=aj7Nv2EZj29i%2B5XsCKiWclilJMs%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:654,\u0026ldquo;originHeight\u0026rdquo;:165,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nseq2seq ëª¨ë¸ì€ Conditional Laguage Modelì˜ í•œ ì˜ˆì‹œì„!\nLanguage modelì¸ ì´ìœ ëŠ” decoderê°€ target sentece yì˜ ë‹¤ìŒ wordë¥¼ ì˜ˆì¸¡í•˜ê¸° ë•Œë¬¸ì´ê³ Â Conditionalì¸ ì´ìœ ëŠ” predctionì´ ì´ì „ ë‹¨ì–´ë“¤ì— ë”í•´ source senteceì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸!Â ì–´ë–»ê²Œ train? [##Image|kage@4Twsx/btsOMmM2cZG/AAAAAAAAAAAAAAAAAAAAAKAe9xc8Q4WOYWbkWdvIrtxE287Km-HlwKyzNev4TxfS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=oNJVT4MAY3sM9mEKBHnEseFO0mY%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:774,\u0026ldquo;originHeight\u0026rdquo;:453,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì¦‰ lossëŠ” decoderì—ì„œ ê³„ì‚°ë˜ê³ \u0026hellip; í•˜ë‚˜ì˜ systemdã…¡ë¡œì„œ end-to-endë¡œ Backpropagationí•¨!Â ë¬¸ì œì : issues with recurrent models Linear interaction distanceÂ O(sequence length) ë‹¨ê³„ì˜ ê±°ë¦¬ì˜ word pairsê°„ ìƒí˜¸ì‘ìš©í•œë‹¤ëŠ” ëœ»ì€\u0026hellip;\nê¸´ ê±°ë¦¬ì˜ dependenciesì€ í•™ìŠµí•˜ê¸° ì–´ë µë‹¤..(grdient ì†Œì‹¤ ë¬¸ì œ ì—¬ì „íˆ\u0026hellip;)\nâ†’ ì˜ˆ: \u0026ldquo;The dog that chased the cat ran\u0026rdquo; â†’ \u0026ldquo;dog\u0026quot;ê³¼ \u0026ldquo;ran\u0026quot;ì€ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìŒ\nRNNì€ ê·¸ëƒ¥ ì™¼ìª½ë¶€í„° ì˜¤ë¥¸ìª½ìœ¼ë¡œ í•˜ë‚˜ì”© ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë¬¸ì¥ êµ¬ì¡°ì— Linear orderê°€ ì¥ì œë¡œ ë°•í˜€ìˆë‹¤.\në¬¸ì¥ì„ ë‹¨ìˆœí•œ ìˆœì„œë¡œë§Œ ìƒê°í•´ì„œëŠ” ì•ˆ ëœë‹¤..!Â \u0026ldquo;The dog that chased the cat ran away.\u0026rdquo;\nâ†’ ì£¼ì–´ëŠ” \u0026ldquo;The dog\u0026rdquo;, ë™ì‚¬ëŠ” \u0026ldquo;ran\u0026rdquo;, ê·¼ë° ë‘˜ ì‚¬ì´ì— ê´€ê³„ ìˆëŠ” ë‹¨ì–´ë“¤ì´ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìŒ\nì¦‰ ì´ë¥¼ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ëŠ” ëª¨ë¸ì€ êµ¬ë¬¸ êµ¬ì¡°ë‚˜ ì˜ë¯¸ ê´€ê³„ë¥¼ ì˜ íŒŒì•…í•˜ì§€ ëª»í•œë‹¤.Â Lack of parallelizability Unparallelizableí•˜ê²Œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— forwardì™€ backward ì—°ì‚°ì€Â O(seq length)ë¥¼ ê°€ì§„ë‹¤.Â GPU ë³‘ë ¬ ì²˜ë¦¬ì— ì˜ ì•ˆ ë§ê³ ..(ì´ì „ hidden stateë¥¼ ê³„ì‚°í•´ì•¼ ë‹¤ìŒ hidden stateë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸!!)Â í° ë°ì´í„° í•™ìŠµì´ í˜ë“¤ë‹¤!!\n","date":"2025-06-21T18:13:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/machine-translation-mt%EC%9D%98-%EB%B0%9C%EC%A0%84/","title":"Machine Translation (MT)ì˜ ë°œì „"},{"content":"vanishing gradientsì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ì œì•ˆëœ RNNì˜ í•œ ì¢…ë¥˜ì„!\nìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬!\nget, cell ë“± ë‚´ë¶€ êµ¬ì¡°\n","date":"2025-06-21T17:32:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/long-short-term-memory-lstm/","title":"Long Short-Term Memory (LSTM)"},{"content":"Core Idea [##Image|kage@cd3kQx/btsOL55YG2J/AAAAAAAAAAAAAAAAAAAAANYIGed86TNJRULXuEeGhsPDL1fSZKTEgFCyVcJT_nnM/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=xtXMYU30gOU9Dw%2FwaYztfGNHw2E%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:620,\u0026ldquo;originHeight\u0026rdquo;:302,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê°™ì€ ê°€ì¤‘ì¹˜ Wë¥¼ ë°˜ë³µí•´ì„œ ì ìš©í•œë‹¤!!!!\nê° ì…ë ¥ì— ëŒ€í•´ì„œ hidden stateì— ê°™ì€ Wë¥¼ ê³±í•œê²ƒì„ ê°™ì´ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. (ì´ì „ì—ëŠ” x1ì€ w1, x2ëŠ” w2ë‘ ê³±í•´ì ¸ì™”ìŒ)Â RNNì˜ ì „ì²´ êµ¬ì¡°Â [##Image|kage@nAlnd/btsOKCKGYh2/AAAAAAAAAAAAAAAAAAAAAI_fpqbVrSvAnP94hHCY_7jcCxy1K1hw80WqHlf7PRzI/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=agopE1K1jweMPlppzIrc%2BVSfsUY%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:761,\u0026ldquo;originHeight\u0026rdquo;:525,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì¥ì  ì–´ë–¤ ê¸¸ì´ì˜ inputì´ë“  ì²˜ë¦¬ ê°€ëŠ¥ step tì— ëŒ€í•œ ê³„ì‚°ì€ ë§ì€ ë’¤ì˜ stepì˜ ì •ë³´ë¥¼ í™œìš©í•œë‹¤.(ì´ì „ ì •ë³´ë¥¼ í™œìš©í•œë‹¤!)Â input í¬ê¸°ì— ë”°ë¼ Model size(Wh, We)ê°€ ì¦ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤.Â ëª¨ë“  ì‹œê°„ step tì— ê°™ì€ Wë¥¼ ì ìš©í•˜ê¸° ë•Œë¬¸ì— ìœ„ì¹˜ì— ìƒê´€ì—†ì´ ê³µì •í•˜ê²Œ ì²˜ë¦¬ëœë‹¤.Â ë‹¨ì Â Recurrent computationì´ ë„ˆë¬´ ëŠë ¤ -\u0026gt; ë³‘ë ¬ ì²˜ë¦¬ê°€ ì•ˆ ëœë‹¤!!Â ì™„ì „ ì´ì „ stepì˜ ì •ë³´ë¥¼ ì–»ëŠ”ê²Œ ì¢€ ì–´ë ¤ì›€\u0026hellip; -\u0026gt; ì •ë³´ ì†Œì‹¤ ë¬¸ì œ! (gradient vanishing) TrainingÂ Input : ë‹¨ì–´ë“¤ì˜ sequence Ouput : ëª¨ë“  ê° step tì˜ distribution yt Loss : step tì— ëŒ€í•´ì„œ, ì˜ˆì¸¡ í™•ë¥  ë¶„í¬ ytì™€ ì§„ì§œ ë‹¤ìŒ ë‹¨ì–´ yt ê°„ì˜ cross-entoropy(ë¶ˆì¼ì¹˜ë¥¼ ì¸¡ì •í•˜ëŠ” í•¨ìˆ˜)ë¥¼ ê³„ì‚°Â ê·¸ Lossë¥¼ ëª¨ë‘ ë”í•´ì„œ í‰ê· ì„ ë‚¸ë‹¤.Â * cross-entropy?\nì˜ˆì¸¡í•œ í™•ë¥  ë¶„í¬ytì™€ ì‹¤ì œ ì •ë‹µ(label)ì˜ ë¶„í¬ yt ì‚¬ì´ì˜ ë¶ˆì¼ì¹˜ë¥¼ ì¸¡ì •, ëª¨ë¸ì— í™•ì‹ ì„ ê°€ì§€ê³  ë§ì·„ëŠ”ì§€ë¥¼ í‰ê°€í•˜ëŠ” Loss í•¨ìˆ˜!Â ë”°ë¼ì„œ ì •ë‹µì„ ë§ì¶°ë„ í™•ì‹ ì´ ì—†ìœ¼ë©´ Lossê°€ ì»¤ì§„ë‹¤\u0026hellip;Â [##Image|kage@bu6ZvL/btsOL8OXDOx/AAAAAAAAAAAAAAAAAAAAANYGFDr1VnpHth2STLiZISwfe_wqt8My-valyxnwKa7Y/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=OBFojuUdiS4Ro%2FJuzjm6fOXkAGA%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:616,\u0026ldquo;originHeight\u0026rdquo;:255,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##][##Image|kage@qz5G4/btsOK40UBYS/AAAAAAAAAAAAAAAAAAAAAPgHM10-ONI6fduzzG8qC55ZS0yeKIB5r3a_e-eiFBq3/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=Ln447zxoSPmQ9%2B6wXoRP9D%2Fvt%2BM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:839,\u0026ldquo;originHeight\u0026rdquo;:522,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:681,\u0026ldquo;height\u0026rdquo;:424}##]\n1. x1ì´ ë“¤ì–´ì™€ì„œ y1ì„ ì˜ˆì¸¡\n2. ì´ë•Œ LossëŠ” ì‹¤ì œ trueê°’(y2) ì™€ì˜ nevative log probì„ ê³„ì‚°í•œë‹¤.Â 3. time step të§ˆë‹¤ ê³„ì‚° í›„ì—Â 4. Lossë¥¼ ê³„ì‚° í›„ í‰ê· Â ë¬¸ì œì  ì „ì²´ corpus(ë¬¸ì¥, document)ì— ëŒ€í•´ì„œ lossì™€ grandientë¥¼ í•œë²ˆì— ê³„ì‚°í•˜ëŠ” ê²ƒì€ ë„ˆë¬´ ë¹„ìŒˆ.. ë©”ëª¨ë¦¬ ë¬¸ì œ..Â ê·¸ë˜ì„œÂ Stochastic Gradient Descent ê¸°ì–µí•˜ë‹ˆ??? ì´ëŸ¬í•œ ì‘ì€ data chunkì— ëŒ€í•´ì„œ lossì™€ gradientë¥¼ ê³„ì‚°í•˜ê³  update..\nì´ê±¸ ì ìš©í•´ë³´ê² ë‹¤\u0026hellip;Â ê·¸ë˜ì„œ í•œ ë¬¸ì¥ì— ëŒ€í•´ì„œ lossë¥¼ ê³„ì‚°í•˜ê³ (ì›ë˜ëŠ” ì—¬ëŸ¬ ë¬¸ì¥ batchì— ëŒ€í•´ì„œ ê³„ì‚°í–ˆì—ˆìŒ) graeidntë‘ weightë¥¼ ì—…ë°ì´íŠ¸ í•´ì„œ.. ì´ì œ ë‹¤ë¥¸ ìƒˆë¡œìš´ í•œ ë¬¸ì¥ì— ëŒ€í•´ì„œ ë°˜ë³µí•œë‹¤~Â Backpropagation for RNNs (W parameterë¥¼ í›ˆë ¨ ì‹œí‚¤ê¸° ìœ„í•¨!)Â [##Image|kage@mg3iq/btsOK3gBiFm/AAAAAAAAAAAAAAAAAAAAAOoIiVeMS4EAFLxLbEQdFCnjBPX6LasLXf1C3cmF95GE/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=pAazc3X5vbWcsh65DO1koqUo68s%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:756,\u0026ldquo;originHeight\u0026rdquo;:419,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:612,\u0026ldquo;height\u0026rdquo;:339}##]\nê°€ì¤‘ì¹˜ matrix Whì— ëŒ€í•´ì„œ Jtì˜ ë¯¸ë¶„ì€ ë¬´ì—‡ì¸ê°€?Â ì—¬ëŸ¬ ìœ„ì¹˜ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ëœ ê°™ì€ ê°€ì¤‘ì¹˜ì— ëŒ€í•œ gradientëŠ” ê°ê°ì˜ ì‚¬ìš© ìœ„ì¹˜ì—ì„œ ë‚˜ì˜¨ gradientë“¤ì„ ëª¨ë‘ ë”í•œê²ƒ!Â ì¦‰, ê° timestepì—ì„œ lossì— ê¸°ì—¬í•œ Wì— gradientê°€ ë”°ë¡œ ìƒê¹€! ì´ Wì— ëŒ€í•´ ì—…ë°ì´íŠ¸ í•˜ë ¤ë©´ ëª¨ë“  timestepì—ì„œ ë‚˜ì˜¨ gradientë¥¼ í•œë²ˆì— ë”í•´ì•¼í•´!Â [##Image|kage@3lKBN/btsOLfnQEAb/AAAAAAAAAAAAAAAAAAAAAPjbKuP46Dg-E-VCUPX_CFF7mHCsyRNM6Q1Is8H4ZAvF/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=u%2BO2hvqDSwJXiSFX%2Bq0GuR%2FeUeU%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:872,\u0026ldquo;originHeight\u0026rdquo;:459,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\ntimestepë¥¼ ë”°ë¼ ê±°ê¾¸ë¡œ ì—­ì „íŒŒí•˜ë©´ì„œ(t, t-1, .. 0) ê° ì‹œì ë§ˆë‹¤ì˜ gradientë¥¼ ê³„ì‚°í•´ì„œ ì „ë¶€ ë”í•œë‹¤.Â ë”°ë¼ì„œ backpropatgation through time (BPTT)Â ê·¸ë‹ˆê¹Œ ì‹œê°„ì„ ê±°ê¾¸ë¡œ ëŒë©´ì„œ\u0026hellip;! ê³„ì‚°í•œë‹¤!Â ë§ˆì¹˜ n-gram LMê°™ìŒ! ë°˜ë³µë˜ëŠ” samplingì„ í†µí•´ì„œ textë¥¼ ìƒì„±í•˜ëŠ”~~\nProblems with RNNs: Vanishing and Exploding Gradients ê·¸ëŸ¬ë©´ ì´ì œ ê° timestep tì— ëŒ€í•´ì„œ Whì— ëŒ€í•œ J4ì˜ gradientë¥¼ ê³„ì‚°í•´ì•¼ í•¨!Â ì´ë•Œ ì‹œì ì´ 1ì¼ ë•Œ J4/Wh\n[##Image|kage@c6Mtp5/btsOMqIBmyj/AAAAAAAAAAAAAAAAAAAAAKBM8pAVxyGZw73TMjsAJ0pmdqhp4Zt-xEYITKJG6djN/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=3BiU%2FM%2BvC7sZD6aur%2BHCTsfdFps%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:595,\u0026ldquo;originHeight\u0026rdquo;:350,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nìš°ë¦¬ê°€ 4ë²ˆì§¸ Lossë¥¼ ê³„ì‚°í•˜ê³  ì´ê²ƒì„ ì²« ë²ˆì§¸ W(hidden state)ì— ëŒ€í•œ ê°€ì¤‘ì¹˜ë¥¼ ê³„ì‚°í•´ì•¼ í•¨!Â [##Image|kage@c41Eec/btsOKq4vd6Y/AAAAAAAAAAAAAAAAAAAAAJdDrLhfcBcbPxKpllFz0izw43toU0HB8hVXWQxP56yA/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=e7hJ%2BvM10%2FBDDhCsVZL1ldD2sT0%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:799,\u0026ldquo;originHeight\u0026rdquo;:511,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:458,\u0026ldquo;height\u0026rdquo;:293}##]\nì´ë¥¼ ìœ„í•´ì„œëŠ” chain ruleì— ë”°ë¼ ìœ„ì™€ ê°™ì´ ê³„ì‚°ëœë‹¤..Â ê·¸ëŸ°ë°\u0026hellip; ê³±í•´ì§€ëŠ” ì € ê°’ë“¤ì´ ì‘ìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‹ˆ?Â Vanishing gradient problem\nbackpropagationì´ ë” ë©€ë¦¬ ì§„í–‰ë  ìˆ˜ë¡ gradient signalì´ ë” ì‘ì´ì§€ê³  ì‘ì•„ì§€ëŠ” í˜„ìƒ\n[##Image|kage@cSSAqq/btsOLwJyfLB/AAAAAAAAAAAAAAAAAAAAANx0D3CcClzEqW80cTkfeIK2NffZKwAtp-HYRQzx45o5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=MM5pOJ%2Fsdg7lqRrGlRThWq9NhhQ%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:770,\u0026ldquo;originHeight\u0026rdquo;:409,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê·¸ëŸ¬ë‹ˆê¹Œ\u0026hellip; ht í•¨ìˆ˜ì—ëŠ” wh ë¼ëŠ” ìš°ë¦¬ê°€ ê³„ì‚°í•´ì•¼ í•  ê°€ì¤‘ì¹˜ê°€ ìˆê³  ë˜ ê·¸ ì•ˆì˜ ht-1 í•¨ìˆ˜ì—ëŠ” ìš°ë¦¬ê°€ ê³„ì‚°í•´ì•¼ í•  ê°€ì¤‘ì¹˜ê°€ ìˆë‹¤. chainìœ¼ë¡œ ê³±ì±„ì§€ëŠ”ë°\u0026hellip; ê³±í•´ì§€ëŠ” ê°’ì´ ì‘ì€ ìˆ˜ë©´.. ì‘ì€ ìˆ˜ ë¼ë¦¬ ê³„ì† ê³±í•´ì§„ë‹¤\u0026hellip; ë”°ë¼ì„œ ì§€ìˆ˜ì ìœ¼ë¡œ ì‘ì•„ì§„ë‹¤ëŠ” ë¬¸ì œê°€ ë°œìƒ\n[##Image|kage@UOpMn/btsOLdDCn8y/AAAAAAAAAAAAAAAAAAAAAJ1SE3Q95f-Db_u_s_neu4yQdaqc7_iRYuoKmdU0ES1p/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=pPPO1mCmNROOkzinLjcn9Q5Z7Bs%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:916,\u0026ldquo;originHeight\u0026rdquo;:455,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê·¸ë˜ì„œ ë¬¸ì œëŠ”\u0026hellip; backpropagationì„ í•  ë•Œ timestepì´ ì˜¬ë¼ê°ˆ ìˆ˜ë¡ ì ì  ê·¸ ê°’ì´ ì‘ì•„ì ¸ì„œ .. ë‚˜ë‘ ê°€ê¹Œìš´ ì‹œì ì˜ gradientëŠ” í¬ê³  ë‚˜ë‘ ë¨¼ ì‹œì ì˜ gradientëŠ” ê¸°ì–µí•˜ì§€ ëª»í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ì¦‰, ì§§ì€ ê¸°ì–µë§Œ ê°€ëŠ¥í•˜ë‹¤!!! ê¸´ ë¬¸ì¥ ì²˜ë¦¬ ëª» í•¨!!Â ì¦‰ ì–´ë–¤ t ì‹œì ì˜ Lossì™€ Wë¥¼ ê³„ì‚°í•˜ë ¤ë©´ i ì‹œì ì˜ gradient ì¦‰, Loss t / hië¥¼ ê³„ì‚°í•´ì•¼ í•˜ê³  ì´ë•Œ iê°€ të³´ë‹¤ ë„ˆë¬´ ë©€ë©´ ì•„ì˜ˆ ê°’ì´ ì‘ì•„ì ¸ì„œ ì˜í–¥ì„ ëª» ì¤€ë‹¤ëŠ” ê±°êµ¬ë‚˜!!!\nê·¸ë˜ì„œ\u0026hellip;Â ê¸´ ë¬¸ì¥ì´ ì£¼ì–´ì§€ê³  ë¹ˆì¹¸ì„ ì£¼ì–´ì§€ëŠ” ë¬¸ì œë¥¼ ë§ì¶œ ë•Œ\u0026hellip;!Â WhenÂ sheÂ triedÂ toÂ printÂ herÂ tickets,Â sheÂ foundÂ thatÂ theÂ printerÂ wasÂ outÂ ofÂ toner.Â SheÂ wentÂ toÂ theÂ stationeryÂ storeÂ toÂ buyÂ moreÂ toner.Â ItÂ wasÂ veryÂ overpriced.Â AfterÂ installingÂ theÂ tonerÂ intoÂ theÂ printer,Â sheÂ finallyÂ printedÂ herÂ ________\nì—¬ê¸°ì„œ ë‹µì€ ticket ì¦‰, ë§¨ ì•ì˜ 7ë²ˆì§¸ ë‹¨ì–´ë¥¼ ë³´ê³  ë§ì¶°ì•¼ í•˜ëŠ”ë°.. ë„ˆë¬´ ë©€ì–´ì„œ vanishing ë˜ê¸° ë•Œë¬¸ì—.. ëª» ë§ì¶¤..Â exploding ë¬¸ì œëŠ” ê±.. ì•„ì˜ˆ ë‹¤ë¥¸ ê°’ì´ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤ëŠ” ëœ»!!! NaN\nì´ ë¬¸ì œëŠ”Â Gradientê°€ ì¼ì • thresholdë³´ë‹¤ í¬ë©´ ì˜ë¼ì£¼ëŠ” ì‘ì—…ì„ í•˜ê²Œ ë¨! clipping!! Vanishing ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•´ì•¼ í• ê¹Œ?Â 1. ê¸°ì–µì„ ë”°ë¡œ ë³´ê´€í•˜ê³  ë”í•´ê°€ëŠ” RNNì€ ì–´ë•Œ?\u0026quot;\n-\u0026gt; LSTM\n2. ì •ë³´ê°€ ë” ì§ì ‘ì ìœ¼ë¡œ í˜ëŸ¬ê°€ê²Œ (linear pass-through) í•˜ëŠ” êµ¬ì¡°\n-\u0026gt; Attentionì´ë‚˜ Residual Connection\nì¶”ê°€ ì§ˆë¬¸ Q. ì—¬ê¸°ì„œ embeddingì€ word2vectorì™€ ê°™ì€ pretrained embedding modelì„ í†µí•´ ë¥¼ í†µí•´ì„œ embedding ë˜ëŠ”ê±´ê°€?\nNo! ê·¸ëƒ¥ ê°€ì¤‘ì¹˜ Wì— ì˜í•´ vectorí™” í•´ì£¼ëŠ”ê±°ê³  pretraining ë‹¨ê³„ì—ì„œ embeddingì€ ìë™ìœ¼ë¡œ í•¨ê»˜ í•™ìŠµëœë‹¤. (ì¦‰ end-to-endë¡œ ê°™ì´ í•™ìŠµ)Â Q. RNNì€ LMì¸ê°€?\nì•„ë‹˜!! RNNì€ ëª¨ë¸ ì•„í‚¤í…ì³ì´ê³  LMì€ í•™ìŠµ ëª©ì ì´ì Task!!!Â ì¦‰ RNNì€ ì‹œí€€ìŠ¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì‹ ê²½ë§ êµ¬ì¡°ì´ê³ Â LMì€ í…ìŠ¤íŠ¸ì—ì„œ ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡ ê°™ì€ Taskë¥¼ ìˆ˜í–‰í•˜ëŠ” ëª¨ë¸Â ë„ˆëŠ” RNNì„ ì¨ì„œ Language Modelì„ ë§Œë“¤ ìˆ˜ ìˆì–´\nâ†’ ì˜ˆ: RNN-based Language Model (2015ë…„ ì´ì „ì— ë§ì´ ì‚¬ìš©) í•˜ì§€ë§Œ RNNì´ í•­ìƒ Language Modelì„ ì˜ë¯¸í•˜ëŠ” ê±´ ì•„ë‹ˆì•¼\nâ†’ ì˜ˆ: RNNìœ¼ë¡œ ìŒì•… ìƒì„±, ì‹œê³„ì—´ ì˜ˆì¸¡, ë²ˆì—­ ë“± ë¹„-LM taskë„ ê°€ëŠ¥í•¨ ê·¸ë¦¬ê³  Language Modelì´ ê¼­ RNNì„ ì¨ì•¼ í•˜ëŠ” ê²ƒë„ ì•„ëƒ\nâ†’ GPT ê°™ì€ ëª¨ë¸ì€ Transformer ê¸°ë°˜ LM ","date":"2025-06-21T16:53:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/recurrent-neural-networksrnn/","title":"Recurrent Neural Networks(RNN)"},{"content":"Language Modelingì˜ ì •ì˜Â ë‹¤ìŒì— ì˜¬ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” taskë¥¼ ìˆ˜í–‰í•œë‹¤\nEX) the students opened their ____ -\u0026gt; (books, laptops, exams, minds)\nì£¼ì–´ì§„ ë‹¨ì–´ë“¤ì˜ sequence(== ë¬¸ì¥)\nx1, x2, ,,,, xt\në‹¤ìŒ ë‹¨ì–´ xt+1ì˜ probability distributionë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒÂ x+1ì€ vocabulary V= {w1, \u0026hellip; , wV}ì˜ ì•„ë¬´ ë‹¨ì–´ë¥¼ ì˜ë¯¸í•œë‹¤.Â ìœ„ì™€ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ Language Modelì´ë‹¤.Â ì‰½ê²Œ ìƒê°í•´ì„œ ë‹¨ë” ì¡°ê°ì˜ probabiltiyë¥¼ í• ë‹¹í•´ì£¼ëŠ” systemì´ë¼ê³  ìƒê°í•˜ì!Â [##Image|kage@bEu4UG/btsOMbx4VHd/AAAAAAAAAAAAAAAAAAAAALAuedCmtWhEmgVvyRDKLlYNoK0C_VgaLV7x_pUgvez8/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=c1L%2Ft7T%2BP3fKyowIDA7ity6N4xU%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:628,\u0026ldquo;originHeight\u0026rdquo;:179,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nê·¸ëŸ¬ë‹ˆê¹Œ ì¦‰, ì–´ë–¤ ë¬¸ì¥ì´ ìƒì„±ë˜ê¸° ìœ„í•´ì„œëŠ” ì²« ë²ˆì§¸ ë‹¨ì–´ê°€ ì˜¬ í™•ë¥  x ì²« ë²ˆì§¸ ë‹¨ì–´ê°€ ìˆì„ ë•Œ 2ë²ˆì§¸ ë‹¨ì–´ê°€ ì˜¬ í™•ë¥  x \u0026hellip;\nì‰½ê²Œ ìƒê°í•˜ë©´ inputì€ ê·¸ë™ì•ˆ ìƒì„±í•œ ê¸€ì˜ í™•ë¥ , outputì€ ê·¸ ê¸€ì˜ ë‹¤ìŒ ë‹¨ì–´ì˜ í™•ë¥ Â Language Modelingì„ ì™œ ì‹ ê²½ì¨ì•¼ í• ê¹Œ?Â Language ModelingëŠ” benchmark taskì´ë‹¤!\nì´ëŠ” ìš°ë¦¬ì˜ progressê°€ ì˜ ì˜ˆì¸¡í•˜ëŠ”ì§€ ì¸¡ì •í•˜ëŠ”ë° ë„ì›€ì´ ëœë‹¤.Â ë˜í•œ ë§ì€ NLP(Natural Language Process)ì˜ subcomponentë¼ê³  ë³´ë©´ ëœë‹¤.\nì™œëƒí•˜ë©´ text ìƒì„± ì´ë‚˜ textì˜ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” ì¼ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤ã….Â â€¢Â Predictive typing\nâ€¢ Speech recognition\nâ€¢ Handwriting recognition\nâ€¢ Spelling/grammar correction\nâ€¢ Authorship identification\nâ€¢ Machine translation\nâ€¢ Summarization\nâ€¢ Dialogue\nê²°ë¡ \nNLPì˜ ëª¨ë“  ê¸°ìˆ ì€ LMì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì‹œ ì„¤ê³„ëœ ê²ƒ.\nì˜›ë‚ ì—ëŠ” NLP ê° taskë§ˆë‹¤ modelì´ ë”°ë¡œ ì¡´ì¬(ê°ì • ë¶„ì„: SVM, ë²ˆì—­: RNN, ìš”ì•½ Seq2Seq\u0026hellip;)\nìš”ì¦˜ì€ ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸(GPT, Bert) í•˜ë‚˜ë¡œ ëª¨ë“  ê±¸ í•´ê²°!Â Next word predictionÂ [##Image|kage@B880X/btsOK56w4m9/AAAAAAAAAAAAAAAAAAAAAGi7MTKKVksaHyg8oGF0rKmbkx07-XeOS6WYhS79W1rJ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=ZvaUY0HkP726Ec1gIbbi2I5wAXM%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:876,\u0026ldquo;originHeight\u0026rdquo;:272,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:699,\u0026ldquo;height\u0026rdquo;:217}##]\nì´ëŸ°ì‹ìœ¼ë¡œ ë¬¸ì¥ ì•ˆì˜ blankë¥¼ ë‘ì–´ì„œ ì˜ˆì¸¡ì„ í•˜ë„ë¡ í•™ìŠµì‹œì¼°ë‹¤ë©´\u0026hellip;Â [##Image|kage@brGrYk/btsOMbrhW2U/AAAAAAAAAAAAAAAAAAAAAJVZ7cxHL1j8l05ObJ55ytt-g0YBZVYRgco6NaEaiMlP/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=I736lUxcPUJPfuxX3GzgIH38w3U%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:768,\u0026ldquo;originHeight\u0026rdquo;:364,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;,\u0026ldquo;width\u0026rdquo;:684,\u0026ldquo;height\u0026rdquo;:324,\u0026ldquo;caption\u0026rdquo;:\u0026ldquo;Contextì™€ example í•˜ë‚˜ë¥¼ ë³´ì—¬ì£¼ê³  ì§ˆë¬¸ì— ë‹µì„ í•˜ê²Œ í•œë‹¤.\u0026rdquo;}##]\nìš”ì¦˜ì€ ì´ë ‡ê²Œ GPT ê°™ì€ ëª¨ë¸ë“¤ì´ in-context learning ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.Â ì¦‰, ëª‡ ê°œì˜ exampleì„ ì£¼ì–´ì§€ë©´ ê·¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.Â fine-tuning(í›ˆë ¨)í•˜ì§€ ì•Šê³  propmt ìƒì—ì„œ example ëª‡ ê°œ(í•œ ê°œ í˜¹ì€ ê·¸ ì´ìƒ)ë§Œ ë³´ì—¬ì£¼ì–´ì„œ ìƒˆë¡œìš´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.Â ì˜ˆì „ì—ëŠ” ì–´ë–»ê²Œ Language Modelì„ í•™ìŠµì‹œì¼°ì„ê¹Œ? n-gram Language Model!\nMarkov assumption\ní˜„ì¬ ìƒíƒœëŠ” ì˜¤ì§ ì§ì „ ìƒíƒœì— ì˜ì¡´í•œë‹¤. ê³¼ê±°ì˜ ëª¨ë“  ì •ë³´ëŠ” ì§ì „ ìƒíƒœ(nì´ë©´ n-1ê°œê¹Œì§€ì˜ ê³¼ê±°)ì— ìš”ì•½ë˜ì–´ ìˆë‹¤!Â ìì—°ì–´ ì²˜ë¦¬ì—ì„œëŠ”\u0026hellip;Â [##Image|kage@buCTf6/btsOLCCYRPY/AAAAAAAAAAAAAAAAAAAAAEJfukJ_v1O9xuY3QzTuz7i_7f-TsttY1Bv7BWikBI8k/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=xhloXgei4u44u82gqR%2B99W%2FZtIk%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:762,\u0026ldquo;originHeight\u0026rdquo;:114,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nxt+1(í˜„ì¬ ë‹¨ì–´)ì€ ì´ì „ì˜ n-1 ê°œì˜ ë‹¨ì–´ì—(ê³¼ê±°ì˜ ì •ë³´) ì˜ì¡´í•œë‹¤.\n[##Image|kage@cpa9dj/btsOKBkD6Gh/AAAAAAAAAAAAAAAAAAAAAE1v60qR30vxs8aj35g8PCBZX72lX-Cy40UCZ6SEp8ps/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=qIY0LUvEpKo1VTag8E7SzXTM%2Feo%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:614,\u0026ldquo;originHeight\u0026rdquo;:187,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\në§Œì•½ 4-gram Language Modelì´ë¼ê³  í•˜ë©´ 3ê°œì˜ ë‹¨ì–´ë¥¼ í™•ì¸Â ì´ë¥¼ ì§ì ‘ statistical approximation í•˜ê²Œ count í•œë‹¤.Â [##Image|kage@MjTJo/btsOLvqmrvI/AAAAAAAAAAAAAAAAAAAAAPGTzzs7bDTPGiHL-aOJuJUES5godmZjlxljy8xrcZvy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=9ArLFBmwn2JsNsaf4ukucZ4IMwA%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:730,\u0026ldquo;originHeight\u0026rdquo;:202,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì¦‰ corpusì—ì„œ 3ê°œì˜ ë‹¨ì–´ê°€ 1000ê°œ ë‚˜ì™”ì„ ë•Œ ë‹¤ìŒ ë‹¨ì–´ë¥¼ countí•´ì„œ í•™ìŠµÂ í•˜ì§€ë§Œ proctor ë¼ëŠ” context(ë¬¸ë§¥)ì„ ì•„ì˜ˆ ë¬´ì‹œí•´ë„ ë ê¹Œ??\në¬¸ì œ 1 ë§Œì•½ dataì— \u0026ldquo;students opened their w\u0026rdquo; ì´ ì•„ì˜ˆ ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©´?Â -\u0026gt; ì‘ì€ ì…ì‹¤ë¡ ì„ ì¶”ê°€í•´ì¤€ë‹¤.Â ë¬¸ì œ 2 \u0026ldquo;students opened their\u0026rdquo; ê°€ ì•„ì˜ˆ ì—†ìœ¼ë©´?\n-\u0026gt; backoffë¡œ \u0026ldquo;opened their\u0026rdquo; ë¡œ ëŒ€ì‹ í•´ë¼!Â ë¬¸ì œ 3 ê·¸ë¦¬ê³  ê·¸ ëª¨ë“  í™•ë¥ ì„ ë‹¤ count í•´ì•¼ í•˜ëŠ”ë°..?Â -\u0026gt; storage ë¬¸ì œ ë°œìƒÂ ì‚¬ì‹¤ n=5ì´ìƒì´ë©´ ë¬¸ì œê°€ ë°œìƒí•´ì„œ\u0026hellip; ì˜ ì•ˆ ì“´ë‹¤.Â ê·¼ë°\u0026hellip;\nincohrentí•˜ë‹¤!! ì¦‰ ì•ë’¤ê°€ ì•ˆ ë§ëŠ” ë¬¸ì¥ì´ ìƒì„±ëœë‹¤.Â ì ì–´ë„ 3ê°œ ì´ìƒì˜ ë‹¨ì–´ë¥¼ ê³ ë ¤í•´ì•¼ í•˜ëŠ”ë°\u0026hellip; nì´ ì»¤ì§€ë©´ ìœ„ì™€ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•˜ê³ \u0026hellip; ì–´ëœ©í•˜ì§€Â Neural Language Model?Â ì¦‰ í™•ë¥ ì„ ëª¨ë¸ë§í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼\u0026hellip; Deep Learning(ì‹ ê²½ë§)ì„ ì´ìš©í•´ì„œ í™•ë¥ ì„ ëª¨ë¸ë§í•˜ì!Â [##Image|kage@UZADO/btsOKDicr3a/AAAAAAAAAAAAAAAAAAAAAKs73WHd8Jz4kU62qvLWkSTEREbXI-zd3iVBIIyhRW8t/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8\u0026amp;expires=1761922799\u0026amp;allow_ip=\u0026amp;allow_referer=\u0026amp;signature=bLSWe3euV220bNV8vjgc99woGa4%3D|CDM|1.3|{\u0026ldquo;originWidth\u0026rdquo;:721,\u0026ldquo;originHeight\u0026rdquo;:495,\u0026ldquo;style\u0026rdquo;:\u0026ldquo;alignCenter\u0026rdquo;}##]\nì¦‰ ìœ„ì™€ ê°™ì´ vectorë¥¼ ë§Œë“¤ì–´ì„œ embeddingì„ í•´ì£¼ê³  hidden layerë¥¼ í†µí•´ ê³„ì‚°.Â ë”°ë¼ì„œ n-gram LMì˜ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤!Â ê´€ì°°ë˜ì–´ì•¼ í•  n-gramì„ ëª¨ë‘ ì €ì¥í•  í•„ìš”ê°€ ì—†ê³ Â ì •ë³´ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì•„ë‹Œì§€ë„ ë¬¸ì œ (sparsity problem) ë„ ì—†ì–´ì§„ë‹¤!\nê·¸ëŸ¬ë‚˜\u0026hellip; ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ê°€ ì¡´ì¬í•˜ëŠ”ë°\u0026hellip;.\nFixed windowë„ ë„ˆë¬´ ì‘ë‹¤.Â window sizeë¥¼ í‚¤ìš°ë©´ W(ê°€ì¤‘ì¹˜)ë„ ë” ì»¤ì§„ë‹¤!!! ì¦‰, ë§¤ìš° ê¸´ sequnceë¥¼ ì´í•´í•  ìˆ˜ ì—†ë‹¤!! (ë¬¸ì¥ ì•ë¶€ë¶„ì˜ ê°œë…ì´ ë’·ë¶€ë¶„ í•´ì„ì— ì¤‘ìš”í•  ìˆ˜ë„ ìˆìœ¼ë‹ˆ!) x1ê³¼ x2ëŠ” ê³±í•´ì§€ëŠ” ê°€ì¤‘ì¹˜ê°€ ë‹¤ë¥´ë‹¤! (ì¦‰, ì…ë ¥ ìœ„ì¹˜ì— ë”°ë¼ ì²˜ë¦¬ ë°©ì‹ì´ ë‹¬ë¼ì§„ë‹¤) ì´ëŸ° ê²½ìš° ì…ë ¥ ìœ„ì¹˜ê°€ ë‹¤ë¥´ë©´ ê°™ì€ ë‹¨ì–´ë¼ë„ ë‹¤ë¥´ê²Œ ì²˜ë¦¬ë  ìˆ˜ë„..(ì¦‰ dogë¼ëŠ” ì˜ë¯¸ëŠ” ì•ì´ë“  ë’¤ì´ë“  ê°™ì•„ì•¼ í•¨!!)Â ì–´ë–¤ ê¸¸ì´ì˜ inputì´ë“  ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” neural architectureê°€ í•„ìš”í•˜ë‹¤!!!Â ì´ì œ\u0026hellip; RNN ì„ ë°°ìš¸ ë•Œë‹¤!!\n","date":"2025-06-21T14:10:00+09:00","permalink":"https://juijeong8324.github.io/p/nlp/language-modeling/","title":"Language Modeling"}]